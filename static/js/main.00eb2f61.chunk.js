(this["webpackJsonpzsku-mgmt"]=this["webpackJsonpzsku-mgmt"]||[]).push([[0],{185:function(e,t,a){},210:function(e,t,a){e.exports=a(250)},215:function(e,t,a){},221:function(e,t,a){},250:function(e,t,a){"use strict";a.r(t);var n,l=a(1),r=a.n(l),i=a(13),o=a.n(i),c=(a(215),a(7)),u=a(11),s=a(19),d=(a(221),["svgRef","title"]);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var f=function(e){var t=e.svgRef,a=e.title,l=p(e,d);return r.a.createElement("svg",m({width:250,height:250,viewBox:"0 0 66.146 66.146",ref:t},l),void 0===a?n||(n=r.a.createElement("title",null,"ZSKU Logo")):a?r.a.createElement("title",null,a):null,r.a.createElement("g",{transform:"translate(0 -230.85)"},r.a.createElement("g",{transform:"matrix(2.5493 0 0 2.5493 -32.372 -379.35)",style:{strokeWidth:.79375}},r.a.createElement("path",{d:"m17.907 240.94h15.502v15.502h-15.502z",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m17.907 256.44 15.502-15.502",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m33.409 256.44-7.7508-7.7508v-7.7508",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m25.658 248.69v7.7508",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m25.658 248.69c-2.1403 0-3.8754-1.7351-3.8754-3.8754 3e-6 -2.1403 1.7351-3.8754 3.8754-3.8754s3.8754 1.7351 3.8754 3.8754",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m25.632 248.68c2.1403 0 3.8754 1.7351 3.8754 3.8754 2e-6 2.1403-1.7351 3.8754-3.8754 3.8754s-3.8754-1.7351-3.8754-3.8754",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}),r.a.createElement("path",{d:"m33.409 256.46c3e-6 4.2807-3.4702 7.7508-7.7508 7.7508s-7.7508-3.4702-7.7508-7.7508",style:{fill:"none",strokeWidth:.79375,stroke:"#000"}}))))},v=r.a.forwardRef((function(e,t){return r.a.createElement(f,m({svgRef:t},e))})),g=(a.p,function(e){var t;return r.a.createElement("div",{className:"landingMain"},r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement("h1",null,"ZSKU Wegholzen"),r.a.createElement("p",null,"Willkommen im ZSKU Management Portal, ",r.a.createElement("br",null),null===(t=e.user)||void 0===t?void 0:t.fullName)))}),b=a(255),h=a(291),E=a(310),y=a(304),O=a(34),k=a(16),S=a(20),j=a.n(S),N=a(35),z=a(50),w=a(47),T=new(function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(){var e;return Object(N.a)(this,a),(e=t.call(this,"zsku-db")).feeTypes=void 0,e.penalties=void 0,e.roles=void 0,e.users=void 0,e.transactions=void 0,e.games=void 0,e.version(4).stores({feeTypes:"id,createdOn,label,value,applicationStrategy,deleted",penalties:"id,createdOn,gameId,userId,feeTypeId,value",roles:"id,createdOn,name",users:"id,createdOn,abbreviation,fullName,color,deleted",transactions:"id,createdOn,name,description,userId,value,affectsGlobalLedger,affectsGlobalUser",games:"id,createdOn,name,status,users"}),e.feeTypes=e.table("feeTypes"),e.penalties=e.table("penalties"),e.roles=e.table("roles"),e.users=e.table("users"),e.transactions=e.table("transactions"),e.games=e.table("games"),e}return a}(a(188).a)),C=Object(k.b)(),I=Object(k.c)({initialState:C.getInitialState(),name:"transactions",reducers:{create:function(e,t){return e.ids.push(t.payload.id),e.entities[t.payload.id]=t.payload,T.transactions.put(t.payload),e},delete:function(e,t){return e.ids=e.ids.filter((function(e){return e!==t.payload})),delete e.entities[t.payload],T.transactions.delete(t.payload),e},set:function(e,t){e.ids=t.payload.map((function(e){return e.id})),e.entities={};var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;e.entities[l.id]=l}}catch(r){n.e(r)}finally{n.f()}return T.transactions.clear().then((function(){T.transactions.bulkPut(t.payload)})),e},update:function(e,t){return e.entities[t.payload.id]=j.a.merge(e.entities[t.payload.id],t.payload.changes),T.transactions.update(t.payload.id,t.payload.changes),e}}}),A="#2978bf",x=[A,"#FF751F","#F9C846","#5b4e77","#7DCE82"],D=Object(k.b)(),P=Object(k.c)({initialState:D.getInitialState(),name:"users",reducers:{create:function(e,t){var a;null==t.payload.color&&(t.payload.color=null!==(a=j.a.sample(x))&&void 0!==a?a:"#aaa");return e.ids.push(t.payload.id),e.entities[t.payload.id]=t.payload,T.users.put(t.payload),e},delete:function(e,t){var a=e.entities[t.payload];if(null!=a)return a.deleted=!0,T.users.update(t.payload,{deleted:!0}),e},set:function(e,t){e.ids=t.payload.map((function(e){return e.id})),e.entities={};var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;e.entities[l.id]=l}}catch(r){n.e(r)}finally{n.f()}T.users.clear().then((function(){T.users.bulkPut(t.payload)}))},update:function(e,t){return e.entities[t.payload.id]=j.a.merge(e.entities[t.payload.id],t.payload.changes),T.users.update(t.payload.id,t.payload.changes),e}}}),G=a(22);function B(e){return"".concat((null!==e&&void 0!==e?e:0).toFixed(2)," \u20ac")}var F,_=function(e){return r.a.createElement("p",{style:e.style},B(e.val))},W=function(e){var t=(e.inverted?-1:1)*e.val;return r.a.createElement("div",{className:"balance",style:{display:"flex",alignItems:"center",gap:".25em",float:"right"}},t>0?r.a.createElement(G.i,{size:"0.5em",color:"green"}):t<0?r.a.createElement(G.i,{size:"0.5em",color:"red",style:{transform:"rotate(0.5turn)"}}):void 0,r.a.createElement(_,{val:t}))},L=a(39),M=a(23),R=a(42),V=a(123),H=a(306),U=a(309),K=a(254),q=a(288),Z=a(285),J=a(287),$=a(282),Q=a(284),X=a(286),Y=a(303),ee=a(283),te=a(40),ae=a.n(te),ne=a(72),le=function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(N.a)(this,a),(n=t.call(this,e)).state={currentPage:0,order:{}},n.pageBounds=n.pageBounds.bind(Object(V.a)(n)),n}return Object(R.a)(a,[{key:"pageBounds",value:function(e,t){var a=e*this.props.entriesPerPage,n=(e+1)*this.props.entriesPerPage;return[a,Math.min(n,t)]}},{key:"sortByOrderObject",value:function(e,t,a){var n=e;return Object.entries(a).sort((function(e,t){return t[1].priority-e[1].priority})).forEach((function(e){var a=Object(M.a)(e,2),l=a[0],r=a[1];n.sort((function(e,a){var n=t.find((function(e){return e.id===l}));if(!n)throw Error("col not found");if("function"===typeof n.sort)return"asc"===r.direction?n.sort(e,a):n.sort(a,e);var i="function"===typeof n.data?n.data(e):e[n.data],o="function"===typeof n.data?n.data(a):a[n.data],c=0;if(i>o)c=1;else{if(!(o>i))return 0;c=-1}return"asc"===r.direction?c:-1*c}))})),n}},{key:"render",value:function(){var e=this,t=this.pageBounds(this.state.currentPage,this.props.rows.length),a=Object(M.a)(t,2),n=a[0],l=a[1],i=[];!0===this.props.selectable&&"function"===typeof this.props.addSelected&&"function"===typeof this.props.removeSelected&&i.push({data:function(t){return r.a.createElement(H.a,{onChange:function(a){null!=e.props.addSelected&&null!=e.props.removeSelected&&(a.target.checked?e.props.addSelected(t):e.props.removeSelected(t))}})},id:"col_check",name:"",orderable:!1,align:"left",sort:function(){return 0}}),i.push.apply(i,Object(L.a)(this.props.columns));var o=i.map((function(t,a,n){var l,i;return t.orderable?r.a.createElement($.a,{align:null!==(i=t.align)&&void 0!==i?i:"left",key:Object(y.a)(),sortDirection:t.orderable&&null!=e.state.order[t.id]?e.state.order[t.id].direction:void 0},r.a.createElement(U.a,{key:Object(y.a)(),active:t.orderable&&t.id in e.state.order,direction:t.orderable&&null!=e.state.order[t.id]?e.state.order[t.id].direction:void 0,onClick:function(a){if(t.orderable){var l=e.state.order;if(a.shiftKey||n.forEach((function(e){e.id!==t.id&&delete l[e.id]})),t.id in l)switch(l[t.id].direction){case"asc":l[t.id].direction="desc",l[t.id].priority=Date.now();break;case"desc":delete l[t.id]}else l[t.id]={direction:"asc",priority:Date.now()};e.setState({order:e.state.order})}}},t.name)):r.a.createElement($.a,{align:null!==(l=t.align)&&void 0!==l?l:"left",key:Object(y.a)()},t.name)})),c=this.sortByOrderObject(this.props.rows,i,this.state.order).slice(n,l).map((function(t){return r.a.createElement(ee.a,{key:Object(y.a)()},function(){var a=i.map((function(e){var a;return r.a.createElement($.a,{key:Object(y.a)(),align:null!==(a=e.align)&&void 0!==a?a:"left"},"function"===typeof e.data?e.data(t):t[e.data])}));return null!=e.props.actions&&a.push(r.a.createElement($.a,{key:Object(y.a)(),align:"right",style:{padding:"4px"}},e.props.actions.map((function(e){return r.a.createElement(K.a,{key:Object(y.a)(),color:"primary",onClick:function(){e.handle(t)}},r.a.createElement(e.icon,{size:".75em"}))})))),a}())}));return null!=this.props.actions&&o.push(r.a.createElement($.a,{key:"col_actions",align:"right"},"Aktionen")),r.a.createElement(Q.a,{component:b.a,elevation:0,style:{display:this.props.rows.length>0?"block":"none"}},r.a.createElement(Z.a,null,r.a.createElement(X.a,null,r.a.createElement(ee.a,null,o)),r.a.createElement(J.a,null,c),this.props.rows.length>this.props.entriesPerPage?r.a.createElement(q.a,null,r.a.createElement(ee.a,null,r.a.createElement(Y.a,{count:this.props.rows.length,rowsPerPage:this.props.entriesPerPage,rowsPerPageOptions:[],page:this.state.currentPage,onPageChange:function(t,a){e.setState({currentPage:a})}}))):null))}}]),a}(l.Component),re=function(e){var t=Object(c.d)((function(e){return D.getSelectors((function(e){return e.users})).selectEntities(e)})),a=Object(c.c)();return r.a.createElement("div",null,r.a.createElement(le,{columns:[{data:function(e){return r.a.createElement(u.b,{to:"/zsku-mgmt/transactions/"+e.id},e.name)},id:"col_name",name:"Name",align:"left",orderable:!0,sort:function(e,t){return e.name.localeCompare(t.name)}},{data:function(e){return r.a.createElement("div",{title:e.description},e.description.substr(0,50))},id:"col_description",name:"Beschreibung",align:"left",orderable:!1},{data:function(e){var a=t[e.userId];return null==a?r.a.createElement("p",null,"N/A"):r.a.createElement(u.b,{to:"/zsku-mgmt/users/"+a.id},a.fullName)},id:"col_user",name:"Mitglied",align:"left",orderable:!0,sort:function(e,a){var n=t[e.userId],l=t[a.userId];return null==n||null==l?0:n.fullName.localeCompare(l.fullName)}},{data:function(e){return r.a.createElement(W,{val:e.value})},id:"col_value",name:"Betrag",align:"right",orderable:!0,sort:function(e,t){return e.value-t.value}},{data:function(e){return new Date(e.createdOn).toLocaleDateString("de-DE")},id:"col_timestamp",name:"Erstellt am",align:"left",orderable:!0,sort:function(e,t){return e.createdOn-t.createdOn}}],entriesPerPage:8,rows:e.transactions,actions:[{icon:G.h,handle:function(e){a(I.actions.delete(e.id))}}]}))},ie=Object(s.g)((function(e){var t=Object(c.d)((function(e){return C.getSelectors().selectAll(e.transactions)})),a=Object(c.d)((function(e){return D.getSelectors().selectAll(e.users).filter((function(e){return!0!==e.deleted}))})),n=Object(c.c)();return r.a.createElement("div",{className:"ledgerContainer"},r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Kassenstand"),r.a.createElement(W,{val:t.filter((function(e){return e.affectsGlobalLedger})).reduce((function(e,t){return e+t.value}),0)}),r.a.createElement(u.b,{to:"/zsku-mgmt/transactions/new"},r.a.createElement(h.a,null,"Au\xdferplanm\xe4\xdfige Transaktion hinzuf\xfcgen"))),r.a.createElement(re,{transactions:t.filter((function(e){return e.affectsGlobalLedger}))}))),r.a.createElement("div",{className:"cardGrid"},a.map((function(a){var l=t.reduce((function(e,t){return e+(t.userId===a.id?t.value:0)}),0);return r.a.createElement("div",{style:{cursor:"pointer"},key:"userLedger_"+a.id,className:"card zsku-panel",onClick:function(){e.history.push("/zsku-mgmt/users/"+a.id)}},r.a.createElement(b.a,{elevation:3,style:{padding:"2em",position:"relative"}},r.a.createElement(E.a,{style:{backgroundColor:a.color,position:"absolute",top:"1em",right:"1em"}},a.abbreviation),r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",{style:{marginLeft:"0"}},a.fullName)),r.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%"}},r.a.createElement("p",{style:{marginRight:"1em"}},"Kontostand"),r.a.createElement(W,{val:l})),l<0&&r.a.createElement(h.a,{style:{float:"right",bottom:"1em"},onClick:function(r){r.stopPropagation();var i=Object(y.a)();n(I.actions.create({id:i,createdOn:Date.now(),affectsGlobalLedger:!0,affectsUserLedger:!0,name:"TRANS-"+t.length.toString().padStart(4,"0"),penalties:[],userId:a.id,value:-1*l,description:""})),e.history.push("/zsku-mgmt/transactions/"+i)}},"Begleichen")))}))))})),oe=a(166),ce=a(293),ue=a(168),se=a(289),de=a(294),me=a(100),pe=a(38),fe=a(46),ve=a(53),ge=Object(k.b)(),be=Object(k.c)({initialState:ge.getInitialState(),name:"feeTypes",reducers:{create:function(e,t){return e.ids.push(t.payload.id),e.entities[t.payload.id]=t.payload,T.feeTypes.put(t.payload),e},delete:function(e,t){var a=e.entities[t.payload];if(null!=a)return a.deleted=!0,T.feeTypes.update(t.payload,{deleted:!0}),e},set:function(e,t){e.ids=t.payload.map((function(e){return e.id})),e.entities={};var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;e.entities[l.id]=l}}catch(r){n.e(r)}finally{n.f()}T.feeTypes.clear().then((function(){T.feeTypes.bulkPut(t.payload)}))},update:function(e,t){return e.entities[t.payload.id]=j.a.merge(e.entities[t.payload.id],t.payload.changes),T.feeTypes.update(t.payload.id,t.payload.changes),e}}}),he=a(115),Ee=a(197),ye=a.n(Ee),Oe=a(196),ke=["inputRef","onChange"],Se=["value","onChange"],je=function(e){var t=e.inputRef,a=e.onChange,n=Object(he.a)(e,ke);return r.a.createElement(Oe.a,Object.assign({},n,{getInputRef:t,onValueChange:function(t){a({target:{name:e.name,value:t.value}})},thousandSeparator:".",decimalSeparator:",",isNumericString:!0,fixedDecimalScale:!0,decimalScale:2,allowedDecimalSeparators:[",","."],allowNegative:!0,allowLeadingZeros:!0,prefix:""}))},Ne=function(e){var t=e.value,a=e.onChange,n=Object(he.a)(e,Se);return r.a.createElement(ye.a,Object.assign({variant:"outlined",InputProps:{startAdornment:"\u20ac",inputComponent:je},value:t,onChange:a},n))},ze=Object(s.g)((function(e){var t,a,n,l,i=Object(c.c)(),o=Object(s.f)(),d=ve.b({value:ve.a().required().notOneOf([0])}),m=Object(c.d)((function(e){return e.users})),p=Object(c.d)((function(e){return ge.getSelectors((function(e){return e.feeTypes})).selectEntities(e)})),f=Object(c.d)((function(t){return C.getSelectors((function(e){return e.transactions})).selectById(t,e.match.params.transactionId)})),v=Object(c.d)((function(e){return C.getSelectors().selectTotal(e.transactions)})),g=Object(c.d)((function(e){var t;return(null!==(t=null===f||void 0===f?void 0:f.penalties)&&void 0!==t?t:[]).map((function(t){return e.penalties.entities[t]}))})),E=Object.values(g.reduce((function(e,t){var a,n,l,r=t&&p[t.feeTypeId];null==e[t.id]&&(e[t.id]={count:0,feeType:null!==(n=null===r||void 0===r?void 0:r.label)&&void 0!==n?n:"Custom",id:null!==(l=null===r||void 0===r?void 0:r.id)&&void 0!==l?l:t.id,value:0});return e[t.id].count++,e[t.id].value+=null!==(a=null===t||void 0===t?void 0:t.value)&&void 0!==a?a:0,e}),{})),O=Object(me.a)({initialValues:{description:null!==(t=null===f||void 0===f?void 0:f.description)&&void 0!==t?t:"",user:null!==(a=null===f||void 0===f?void 0:f.userId)&&void 0!==a?a:e.match.params.userId,value:null!==(n=null===f||void 0===f?void 0:f.value)&&void 0!==n?n:0,affectsGlobalLedger:!0},validationSchema:d,onSubmit:function(t,a){var n=a.setSubmitting,l=a.resetForm;if("new"===e.match.params.transactionId){var r=Object(y.a)();i(I.actions.create({affectsGlobalLedger:t.affectsGlobalLedger,affectsUserLedger:!!e.match.params.userId,createdOn:Date.now(),description:t.description,id:r,name:"TRANS-"+(v+1).toString().padStart(4,"0"),userId:t.user,value:parseFloat(t.value.toString()),penalties:[]})),n(!1),o.push("/zsku-mgmt/transactions/"+r)}else i(I.actions.update({id:f.id,changes:{description:t.description,value:parseFloat(t.value.toString()),userId:t.user}})),n(!1),l({values:t})}});return r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,null!==(l=null===f||void 0===f?void 0:f.name)&&void 0!==l?l:"Neue Transaktion"),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.b,{size:"4em",style:{backgroundColor:"#F9C846"}}))),r.a.createElement("form",{onSubmit:O.handleSubmit},r.a.createElement("div",{className:"zsku-keyValueGrid"},(null!=e.match.params.userId||null!=(null===f||void 0===f?void 0:f.userId)&&0===g.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Betrifft Kasse"),r.a.createElement(oe.a,null,r.a.createElement(ce.a,{color:"primary",checked:O.values.affectsGlobalLedger,onChange:function(e){return O.setFieldValue("affectsGlobalLedger",e.target.checked)}}))),r.a.createElement("h4",null,"Betrag"),r.a.createElement(Ne,{disabled:(null===f||void 0===f?void 0:f.penalties.length)>0,error:O.touched.value&&Boolean(O.errors.value),helperText:O.touched.value&&O.errors.value,size:"small",value:O.values.value,name:"Value",id:"value",variant:"outlined",onChange:function(e){return O.setFieldValue("value",e.target.value)}}),(null!=e.match.params.userId||!0===(null===f||void 0===f?void 0:f.affectsUserLedger))&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Mitglied"),r.a.createElement(oe.a,null,r.a.createElement(ue.a,{error:O.touched.user&&Boolean(O.errors.user),disabled:!1===(null===f||void 0===f?void 0:f.affectsGlobalLedger)||"new"!==e.match.params.transactionId||null!=e.match.params.userId,variant:"outlined",value:O.values.user,itemType:"string",onChange:function(e){O.setFieldValue("user",e.target.value.toString())},renderValue:function(e){var t;return null==e?null:r.a.createElement(u.b,{to:"/zsku-mgmt/users/"+e,onMouseDown:function(e){e.stopPropagation()}},null===(t=m.entities[e])||void 0===t?void 0:t.fullName)}},m.ids.map((function(e){var t;return r.a.createElement(se.a,{key:"user_"+e,value:e},null===(t=m.entities[e])||void 0===t?void 0:t.fullName)}))))),r.a.createElement("h4",null,"Beschreibung"),r.a.createElement(oe.a,null,r.a.createElement(de.a,{error:O.touched.description&&Boolean(O.errors.description),helperText:O.touched.description&&O.errors.description,variant:"outlined",size:"small",name:"description",id:"description",multiline:!0,value:O.values.description,onChange:O.handleChange})),null!=f&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Erstellt am"),r.a.createElement(de.a,{disabled:!0,variant:"outlined",size:"small",name:"createdOn",id:"createdOn",fullWidth:!0,value:new Date(f.createdOn).toLocaleDateString("de-DE")})),r.a.createElement("div",{className:"gridSpacer"}),r.a.createElement("div",null,r.a.createElement(oe.a,{style:{float:"right"}},r.a.createElement(h.a,{variant:"contained",type:"submit",id:"formSubmit",color:"primary",startIcon:r.a.createElement(fe.a,{size:".75em"})},"Speichern"))))),E.length>0?r.a.createElement("div",null,r.a.createElement(le,{columns:[{id:"col_feeType",name:"Strafe",data:function(e){return e.feeType}},{id:"col_value",name:"Gesamtbetrag",data:function(e){return r.a.createElement(_,{val:e.value})}},{id:"col_count",name:"Anzahl",data:"count"}],entriesPerPage:10,rows:E})):null))})),we=a(198),Te=Object(k.b)(),Ce=Object(k.c)({initialState:Te.getInitialState(),name:"penalties",reducers:{create:function(e,t){return e.ids.push(t.payload.id),e.entities[t.payload.id]=t.payload,T.penalties.put(t.payload),e},createMultiple:function(e,t){var a;(a=e.ids).push.apply(a,Object(L.a)(t.payload.map((function(e){return e.id}))));var n,l=Object(O.a)(t.payload);try{for(l.s();!(n=l.n()).done;){var r=n.value;e.entities[r.id]=r}}catch(i){l.e(i)}finally{l.f()}return T.penalties.bulkPut(t.payload),e},delete:function(e,t){return e.ids=e.ids.filter((function(e){return e!==t.payload})),delete e.entities[t.payload],T.penalties.delete(t.payload),e},deleteMultiple:function(e,t){e.ids=e.ids.filter((function(e){return t.payload.findIndex((function(t){return e!==t}))}));var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;delete e.entities[l]}}catch(r){n.e(r)}finally{n.f()}return T.penalties.bulkDelete(t.payload),e},set:function(e,t){e.ids=t.payload.map((function(e){return e.id})),e.entities={};var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;e.entities[l.id]=l}}catch(r){n.e(r)}finally{n.f()}T.penalties.clear().then((function(){T.penalties.bulkPut(t.payload)}))},update:function(e,t){return e.entities[t.payload.id]=j.a.merge(e.entities[t.payload.id],t.payload.changes),T.penalties.update(t.payload.id,t.payload.changes),e}}}),Ie=Object(k.b)(),Ae=Object(k.c)({initialState:Ie.getInitialState(),name:"roles",reducers:{create:function(e,t){return e.ids.push(t.payload.id),e.entities[t.payload.id]=t.payload,T.roles.put(t.payload),e},delete:function(e,t){return e.ids=e.ids.filter((function(e){return e!==t.payload})),delete e.entities[t.payload],T.roles.delete(t.payload),e},set:function(e,t){e.ids=t.payload.map((function(e){return e.id})),e.entities={};var a,n=Object(O.a)(t.payload);try{for(n.s();!(a=n.n()).done;){var l=a.value;e.entities[l.id]=l}}catch(r){n.e(r)}finally{n.f()}T.roles.clear().then((function(){return T.roles.bulkPut(t.payload)}))},update:function(e,t){return e.entities[t.payload.id]=j.a.merge(e.entities[t.payload.id],t.payload.changes),T.roles.update(t.payload.id,t.payload.changes),e}}}),xe=function(e){return e.games.entities[e.games.openGame]},De=function(e,t){return e.games.entities[t]},Pe=function(e){return e.games.ids.filter((function(t){return t!==e.games.openGame})).map((function(t){return e.games.entities[t]}))},Ge=function(e){return function(t){var a;return null===(a=t.games.entities[e])||void 0===a?void 0:a.users.map((function(e){return t.users.entities[e]})).sort((function(e,t){return e.fullName.localeCompare(t.fullName)}))}},Be=function(e,t){return function(a){return Te.getSelectors().selectAll(a.penalties).filter((function(a){return a.userId===t&&a.gameId===e}))}},Fe=function(e){return function(t){return Te.getSelectors().selectAll(t.penalties).filter((function(t){return t.gameId===e}))}},_e=Object(k.c)({initialState:{ids:[],entities:{},openGame:""},name:"games",reducers:{createGame:function(e){var t={id:Object(y.a)(),createdOn:Date.now(),status:"open",name:"SPIEL-".concat((e.ids.length+1).toString().padStart(4,"0")),users:[]};return e.ids.push(t.id),e.entities[t.id]=t,e.openGame=t.id,T.games.put(t),e},finishGame:function(e){var t=e.openGame;if(!t)return e;var a=e.entities[e.openGame];return 0===a.users.length||(a.status="closed",e.openGame="",T.games.update(t,{status:"closed"})),e},abortGame:function(e){var t=e.openGame;return t?(e.ids=e.ids.filter((function(e){return e!==t})),delete e.entities[t],T.games.delete(t),e):e},setGames:function(e,t){return e.ids=t.payload.map((function(e){return e.id})),e.entities=t.payload.reduce((function(t,a){return t[a.id]=a,"open"===a.status&&(e.openGame=a.id),t}),{}),T.games.clear().then((function(){T.games.bulkPut(t.payload)})),e},addPlayerToOpenGame:function(e,t){var a=e.entities[e.openGame];if(null!=a)return a.users.push(t.payload.userId),T.games.update(e.openGame,{users:Object(L.a)(a.users)}),e},removePlayerFromGame:function(e,t){var a=e.entities[e.openGame];if(null!=a)return a.users=a.users.filter((function(e){return e!==t.payload.userId})),T.games.update(e.openGame,{users:Object(L.a)(a.users)}),e}}}),We=function(){return r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"usersMain settingszsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Datenmanagement"),r.a.createElement("div",{className:"logo"},r.a.createElement(we.a,{size:"4em",style:{backgroundColor:"#7DCE82"}}))),r.a.createElement("div",null,r.a.createElement(Le,null),r.a.createElement(Me,null))))},Le=function(){var e=function(){var e=Object(ne.a)(ae.a.mark((function e(){var t,a,n,l,r,i,o,c,u,s;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.users.toArray();case 2:return t=e.sent,e.next=5,T.roles.toArray();case 5:return a=e.sent,e.next=8,T.penalties.toArray();case 8:return n=e.sent,e.next=11,T.transactions.toArray();case 11:return l=e.sent,e.next=14,T.feeTypes.toArray();case 14:return r=e.sent,e.next=17,T.games.toArray();case 17:i=e.sent,o={users:t,roles:a,penalties:n,transactions:l,feeTypes:r,games:i},c=JSON.stringify(o),u=document.createElement("a"),s=new Blob([c],{type:"application/json;charset=utf-8"}),u.href=URL.createObjectURL(s),u.download="export_zsku_"+(new Date).toISOString().substring(0,10)+".json",document.body.appendChild(u),u.click(),u.remove();case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"1em"}},r.a.createElement(h.a,{variant:"contained",onClick:e},"Exportieren"),r.a.createElement("p",{style:{width:"80%"}},"Hier klicken um alle Daten zu exportieren. Die erzeugte Datei kann wieder reimportiert werden um den jetztigen Zustand der Datenbank wiederherzustellen."))},Me=function(){var e=Object(c.c)(),t=function(){var t=Object(ne.a)(ae.a.mark((function t(){var a;return ae.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=document.createElement("input")).type="file",a.accept="application/json",a.multiple=!1,a.click(),a.addEventListener("change",Object(ne.a)(ae.a.mark((function t(){var n,l,r,i,o,c,u,s;return ae.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1===(null===(n=a.files)||void 0===n?void 0:n.length)){t.next=2;break}return t.abrupt("return");case 2:return t.t0=JSON,t.next=5,a.files[0].text();case 5:return t.t1=t.sent,l=t.t0.parse.call(t.t0,t.t1),r=l.users,i=l.roles,o=l.penalties,c=l.transactions,u=l.feeTypes,s=l.games,t.next=15,T.users.clear();case 15:return t.next=17,T.users.bulkAdd(r);case 17:return t.next=19,T.roles.clear();case 19:return t.next=21,T.roles.bulkAdd(i);case 21:return t.next=23,T.penalties.clear();case 23:return t.next=25,T.penalties.bulkAdd(o);case 25:return t.next=27,T.transactions.clear();case 27:return t.next=29,T.transactions.bulkAdd(c);case 29:return t.next=31,T.feeTypes.clear();case 31:return t.next=33,T.feeTypes.bulkAdd(u);case 33:return t.next=35,T.games.clear();case 35:return t.next=37,T.games.bulkAdd(s);case 37:e(P.actions.set(r)),e(Ae.actions.set(i)),e(Ce.actions.set(o)),e(I.actions.set(c)),e(be.actions.set(u)),e(_e.actions.setGames(s));case 43:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"1em"}},r.a.createElement(h.a,{type:"button",variant:"contained",onClick:t},"Importieren"),r.a.createElement("p",{style:{width:"80%"}},"Hier klicken um einen alten Stand wiederherzustellen. ",r.a.createElement("b",null,"Alle neuen Eintr\xe4ge werden dabei gel\xf6scht!")))},Re=(a(185),a(60));!function(e){e[e.Target=0]="Target",e[e.AllButTarget=1]="AllButTarget",e[e.AutoAll=2]="AutoAll"}(F||(F={}));be.actions.update;var Ve,He=function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(e){var n,l,r,i,o,c,u,s,d,m;return Object(N.a)(this,a),(m=t.call(this,e)).state={value:null!==(n=null===(l=m.props.feeType)||void 0===l||null===(r=l.value)||void 0===r?void 0:r.toString())&&void 0!==n?n:"",name:null!==(i=null===(o=m.props.feeType)||void 0===o?void 0:o.label)&&void 0!==i?i:"",id:null!==(c=null===(u=m.props.feeType)||void 0===u?void 0:u.id)&&void 0!==c?c:"ERR",applicationStrategy:null!==(s=null===(d=m.props.feeType)||void 0===d?void 0:d.applicationStrategy)&&void 0!==s?s:F.Target},m}return Object(R.a)(a,[{key:"componentDidUpdate",value:function(){var e,t,a,n,l,r,i,o,c;this.state.id!==this.props.match.params.id&&this.setState({id:null!==(e=null===(t=this.props.feeType)||void 0===t?void 0:t.id)&&void 0!==e?e:"ERR",name:null!==(a=null===(n=this.props.feeType)||void 0===n?void 0:n.label)&&void 0!==a?a:"ERR",value:null!==(l=null===(r=this.props.feeType)||void 0===r||null===(i=r.value)||void 0===i?void 0:i.toString())&&void 0!==l?l:"",applicationStrategy:null!==(o=null===(c=this.props.feeType)||void 0===c?void 0:c.applicationStrategy)&&void 0!==o?o:F.Target})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},r.a.createElement(de.a,{value:this.state.name,label:"Name",name:"Name",variant:"outlined",onChange:function(t){e.setState({name:t.target.value})}}),r.a.createElement(Ne,{value:this.state.value,label:"Value",name:"Wert",variant:"outlined",onChange:function(t){e.setState({value:t.target.value})}}),r.a.createElement(ue.a,{label:"Betrifft",name:"ApplicationStrategy",variant:"outlined",value:this.state.applicationStrategy,onChange:function(t){e.setState({applicationStrategy:parseInt(t.target.value)})}},r.a.createElement(se.a,{value:F.Target},"Ziel"),r.a.createElement(se.a,{value:F.AllButTarget},"Alle au\xdfer Ziel"),r.a.createElement(se.a,{value:F.AutoAll},"Alle")),r.a.createElement(h.a,{color:"primary",variant:"contained",startIcon:r.a.createElement(fe.a,{size:".75em"}),onClick:function(){e.props.editFeeType({changes:{label:e.state.name,value:parseFloat(e.state.value),applicationStrategy:e.state.applicationStrategy},id:e.state.id}),e.props.history.push("/zsku-mgmt/settings")}},"Speichern"))}}]),a}(l.Component),Ue=Object(c.b)((function(e,t){return{feeType:ge.getSelectors().selectById(e.feeTypes,t.match.params.id)}}),(function(e){return{editFeeType:Object(Re.b)(be.actions.update,e)}}))(Object(s.g)(He)),Ke=[{label:"Diskutieren",value:.01,applicationStrategy:F.Target,createdOn:Date.now(),id:"2"},{label:"Fluchen",value:.01,applicationStrategy:F.Target,createdOn:Date.now(),id:"3"},{label:"Alle Neune",value:.2,applicationStrategy:F.AllButTarget,createdOn:Date.now(),id:"4"},{label:"Gosse",value:.3,applicationStrategy:F.Target,createdOn:Date.now(),id:"5"},{label:"Kugel abfangen misslingt",value:.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"6"},{label:"Kugel abgefangen",value:.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"7"},{label:"Wurf verpennt",value:.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"8"},{label:"Nicht aufgeschrieben",value:.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"9"},{label:"2. Verlierer",value:.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"10"},{label:"Kugel fallen lassen",value:1,applicationStrategy:F.Target,createdOn:Date.now(),id:"11"},{label:"Nicht aufgegessen",value:1,applicationStrategy:F.Target,createdOn:Date.now(),id:"12"},{label:"Nichts gegessen",value:1,applicationStrategy:F.Target,createdOn:Date.now(),id:"13"},{label:"Versp\xe4tung (5m)",value:1,applicationStrategy:F.Target,createdOn:Date.now(),id:"14"},{label:"Klingel",value:2,applicationStrategy:F.Target,createdOn:Date.now(),id:"15"},{label:"Kugel au\xdferhalb",value:2,applicationStrategy:F.Target,createdOn:Date.now(),id:"16"},{label:"Verlierer",value:1.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"17"},{label:"Versp\xe4tung (15m)",value:2.5,applicationStrategy:F.Target,createdOn:Date.now(),id:"18"},{label:"Interieur besch\xe4digt",value:3,applicationStrategy:F.Target,createdOn:Date.now(),id:"19"},{label:"Beitrag",value:5,applicationStrategy:F.AutoAll,createdOn:Date.now(),id:"20"},{label:"Kegelshirt nicht an",value:5,applicationStrategy:F.Target,createdOn:Date.now(),id:"21"},{label:"Versp\xe4tung (30m)",value:5,applicationStrategy:F.Target,createdOn:Date.now(),id:"22"},{label:"Eingeschlafen",value:10,applicationStrategy:F.Target,createdOn:Date.now(),id:"23"},{label:"Brechen auf der Bahn",value:25,applicationStrategy:F.Target,createdOn:Date.now(),id:"24"}],qe=[{name:"Kassenwart",createdOn:Date.now(),id:"1"}],Ze=[{abbreviation:"DW",color:null!==(Ve=j.a.sample(x))&&void 0!==Ve?Ve:"#0088cc",createdOn:Date.now(),fullName:"David Weischer",id:"2",roles:["1"]}],Je=Object(k.c)({initialState:!0,name:"loading",reducers:{set:function(e,t){return t.payload,!1}}}),$e=Object(k.a)({reducer:{feeTypes:be.reducer,roles:Ae.reducer,users:P.reducer,transactions:I.reducer,penalties:Ce.reducer,games:_e.reducer,loading:Je.reducer}});Object(ne.a)(ae.a.mark((function e(){var t,a,n,l,r,i;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.feeTypes.toArray();case 2:return l=e.sent,0===(null===(t=l)||void 0===t?void 0:t.length)&&(l=Ke),e.next=6,T.roles.toArray();case 6:return r=e.sent,0===(null===(a=r)||void 0===a?void 0:a.length)&&(r=qe),e.next=10,T.users.toArray();case 10:return i=e.sent,0===(null===(n=i)||void 0===n?void 0:n.length)&&(i=Ze),$e.dispatch(be.actions.set(l)),e.t0=$e,e.t1=Ce.actions,e.next=17,T.penalties.toArray();case 17:return e.t2=e.sent,e.t3=e.t1.set.call(e.t1,e.t2),e.t0.dispatch.call(e.t0,e.t3),$e.dispatch(Ae.actions.set(r)),$e.dispatch(P.actions.set(i)),e.t4=$e,e.t5=I.actions,e.next=26,T.transactions.toArray();case 26:return e.t6=e.sent,e.t7=e.t5.set.call(e.t5,e.t6),e.t4.dispatch.call(e.t4,e.t7),$e.dispatch(Je.actions.set(!1)),e.t8=$e,e.t9=_e.actions,e.next=34,T.games.toArray();case 34:e.t10=e.sent,e.t11=e.t9.setGames.call(e.t9,e.t10),e.t8.dispatch.call(e.t8,e.t11);case 37:case"end":return e.stop()}}),e)})))();var Qe=function(){return Object(c.c)()},Xe=Object(s.g)((function(e){var t=e.history,a=Object(l.useState)(""),n=Object(M.a)(a,2),i=n[0],o=n[1],c=Object(l.useState)(""),u=Object(M.a)(c,2),s=u[0],d=u[1],m=Object(l.useState)(F.Target),p=Object(M.a)(m,2),f=p[0],v=p[1],g=Qe();return r.a.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},r.a.createElement(de.a,{value:s,label:"Name",name:"Name",variant:"outlined",onChange:function(e){d(e.target.value)}}),r.a.createElement(Ne,{value:i,label:"Wert",name:"Value",variant:"outlined",onChange:function(e){o(e.target.value)}}),r.a.createElement(ue.a,{label:"Betrifft",name:"ApplicationStrategy",variant:"outlined",value:f,onChange:function(e){v(parseInt(e.target.value))}},r.a.createElement(se.a,{value:F.Target},"Ziel"),r.a.createElement(se.a,{value:F.AllButTarget},"Alle au\xdfer Ziel"),r.a.createElement(se.a,{value:F.AutoAll},"Alle")),r.a.createElement(h.a,{color:"primary",variant:"contained",startIcon:r.a.createElement(fe.a,{size:".75em"}),onClick:function(){g(be.actions.create({value:parseFloat(i),label:s,applicationStrategy:f,id:Object(y.a)(),createdOn:Date.now()})),t.push("/zsku-mgmt/settings")}},"Speichern"))})),Ye=Object(c.b)()(Xe),et=a(308),tt=a(295),at=a(296),nt=a(297),lt=function(e){var t=e.title,a=e.message,n=e.onConfirm,i=e.onAbort,o=e.custom,c=e.component,u=Object(l.useState)(!1),s=Object(M.a)(u,2),d=s[0],m=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{onClick:function(e){e.stopPropagation(),m(!0)}},c),r.a.createElement(et.a,{open:d,onClose:function(){m(!1),"function"===typeof i&&i()}},r.a.createElement(tt.a,null,t),r.a.createElement(at.a,null,a),null!=o&&o.length>0?r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.map((function(e,t){return r.a.createElement(h.a,{key:"conf_act_".concat(t),onClick:function(){m(!1),"function"===typeof e.handle&&e.handle()}},e.label)}))):r.a.createElement(nt.a,null,r.a.createElement(h.a,{onClick:function(){m(!1),"function"===typeof i&&i()}},"Abbrechen"),r.a.createElement(h.a,{color:"primary",onClick:function(){m(!1),"function"===typeof n&&n()}},"Best\xe4tigen"))))},rt=function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(){return Object(N.a)(this,a),t.apply(this,arguments)}return Object(R.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(le,{columns:[{id:"col_name",name:"Name",data:"label",align:"left",orderable:!0},{id:"col_value",name:"Wert",data:function(e){return null!=e.value?e.value.toFixed(2)+" \u20ac":"CUSTOM"},align:"right",orderable:!0,sort:function(e,t){var a,n;return(null!==(a=e.value)&&void 0!==a?a:0)-(null!==(n=t.value)&&void 0!==n?n:0)}},{id:"col_strategy",name:"Betrifft",data:function(e){switch(e.applicationStrategy){case F.Target:return"Ziel";case F.AllButTarget:return"Alle au\xdfer Ziel";case F.AutoAll:return"Alle";default:return"Niemanden"}},align:"left",orderable:!1},{id:"col_timestamp",name:"Erstellt am",data:function(e){var t;return new Date(null!==(t=e.createdOn)&&void 0!==t?t:Date.now()).toLocaleDateString("de-DE")},align:"left",orderable:!0,sort:function(e,t){return e.createdOn-t.createdOn}},{id:"col_actions",name:"Aktionen",align:"right",data:function(t){return r.a.createElement("div",{style:{float:"right",display:"flex"}},r.a.createElement(K.a,{color:"primary",onClick:function(){e.props.history.push("/zsku-mgmt/settings/feeTypes/edit/"+t.id)}},r.a.createElement(G.f,{size:".75em"})),r.a.createElement(lt,{title:"Strafe l\xf6schen",message:"Soll die Strafe ".concat(t.label," wirklich gel\xf6scht werden?"),onConfirm:function(){null!=t.id&&e.props.deleteFeeType(t.id)},component:r.a.createElement(K.a,{color:"primary"},r.a.createElement(G.g,{size:".75em"}))}))}}],rows:this.props.feeTypes.filter((function(e){return!0!==e.deleted})),entriesPerPage:5})}}]),a}(l.Component),it=Object(c.b)((function(e){return{feeTypes:ge.getSelectors().selectAll(e.feeTypes)}}),(function(e){return{deleteFeeType:Object(Re.b)(be.actions.delete,e)}}))(Object(s.g)(rt)),ot=function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(){return Object(N.a)(this,a),t.apply(this,arguments)}return Object(R.a)(a,[{key:"render",value:function(){return r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"feeTypesMain settingszsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Strafen"),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.c,{size:"4em",style:{backgroundColor:"#F9C846"}})),r.a.createElement(u.b,{to:"/zsku-mgmt/settings/feeTypes/addNew",style:{textDecoration:"none"}},r.a.createElement(h.a,{variant:"text",color:"primary"},"Hinzuf\xfcgen"))),r.a.createElement("div",{className:"settingsContainer"},r.a.createElement(s.a,{path:"/zsku-mgmt/settings/feeTypes/addNew",component:Ye}),r.a.createElement(s.a,{path:"/zsku-mgmt/settings/feeTypes/edit/:id",component:Ue})),r.a.createElement(s.a,{path:"/zsku-mgmt/settings",component:it})))}}]),a}(l.Component),ct=a(145),ut=a.n(ct),st=a(144),dt=a.n(st),mt=Object(s.g)((function(e){var t=e.history,a=Object(l.useState)(""),n=Object(M.a)(a,2),i=n[0],o=n[1],c=Qe();return r.a.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},r.a.createElement(de.a,{value:i,label:"Name",name:"Name",variant:"outlined",onChange:function(e){o(e.target.value)}}),r.a.createElement(h.a,{color:"primary",variant:"contained",startIcon:r.a.createElement(fe.a,{size:".75em"}),onClick:function(){c(Ae.actions.create({name:i,id:Object(y.a)(),createdOn:Date.now()})),t.push("/zsku-mgmt/settings")}},"Speichern"))})),pt=Object(c.b)()(mt),ft=(Ae.actions.update,function(e){Object(z.a)(a,e);var t=Object(w.a)(a);function a(e){var n,l,r,i,o;return Object(N.a)(this,a),(o=t.call(this,e)).state={name:null!==(n=null===(l=o.props.role)||void 0===l?void 0:l.name)&&void 0!==n?n:"",id:null!==(r=null===(i=o.props.role)||void 0===i?void 0:i.id)&&void 0!==r?r:"ERR"},o}return Object(R.a)(a,[{key:"componentDidUpdate",value:function(){var e,t,a,n;this.state.id!==this.props.match.params.id&&this.setState({id:null!==(e=null===(t=this.props.role)||void 0===t?void 0:t.id)&&void 0!==e?e:"ERR",name:null!==(a=null===(n=this.props.role)||void 0===n?void 0:n.name)&&void 0!==a?a:"ERR"})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},r.a.createElement(de.a,{value:this.state.name,label:"Name",name:"Name",variant:"outlined",onChange:function(t){e.setState({name:t.target.value})}}),r.a.createElement(h.a,{color:"primary",variant:"contained",startIcon:r.a.createElement(fe.a,{size:".75em"}),onClick:function(){e.props.editRole({changes:{name:e.state.name},id:e.state.id}),e.props.history.push("/zsku-mgmt/settings")}},"Speichern"))}}]),a}(l.Component)),vt=Object(c.b)((function(e,t){return{role:Ie.getSelectors().selectById(e.roles,t.match.params.id)}}),(function(e){return{editRole:Object(Re.b)(Ae.actions.update,e)}}))(Object(s.g)(ft)),gt=Object(s.g)((function(e){var t=e.history,a=Qe(),n=Object(c.d)((function(e){return e.roles})),l=Ie.getSelectors().selectAll(n);return r.a.createElement(le,{columns:[{id:"col_name",name:"Name",data:"name",align:"left",orderable:!0},{id:"col_timestamp",name:"Erstellt am",data:function(e){var t;return new Date(null!==(t=e.createdOn)&&void 0!==t?t:Date.now()).toLocaleDateString("de-DE")},align:"left",orderable:!0,sort:function(e,t){return e.createdOn-t.createdOn}},{id:"col_actions",name:"Aktionen",align:"right",data:function(e){return r.a.createElement("div",{style:{float:"right",display:"flex"}},r.a.createElement(K.a,{color:"primary",onClick:function(){t.push("/zsku-mgmt/settings/roles/edit/"+e.id)}},r.a.createElement(G.f,{size:".75em"})),r.a.createElement(lt,{title:"Posten l\xf6schen",message:"Soll der Posten ".concat(e.name," wirklich gel\xf6scht werden?"),onConfirm:function(){null!=e.id&&a(Ae.actions.delete(e.id))},component:r.a.createElement(K.a,{color:"primary"},r.a.createElement(G.g,{size:".75em"}))}))}}],rows:l,entriesPerPage:5})})),bt=Object(c.b)()(gt),ht=function(){return r.a.createElement(dt.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"rolesMain settingszsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Posten"),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.f,{size:"4em",style:{backgroundColor:"#5b4e77"}})),r.a.createElement(u.b,{to:"/zsku-mgmt/settings/roles/addNew",style:{textDecoration:"none"}},r.a.createElement(ut.a,{variant:"text",color:"primary"},"Hinzuf\xfcgen"))),r.a.createElement("div",{className:"settingsContainer"},r.a.createElement(s.a,{path:"/zsku-mgmt/settings/roles/addNew",component:pt}),r.a.createElement(s.a,{path:"/zsku-mgmt/settings/roles/edit/:id",component:vt})),r.a.createElement(s.a,{path:"/zsku-mgmt/settings",component:bt})))},Et=Object(s.g)((function(e){var t=e.history,a=Qe(),n=Object(c.d)((function(e){return e.users})),l=Object(c.d)((function(e){return e.roles})),i=D.getSelectors().selectAll(n).filter((function(e){return!0!==e.deleted})),o=Ie.getSelectors().selectEntities(l);return r.a.createElement(le,{columns:[{id:"col_name",name:"Name",data:function(e){return r.a.createElement(u.b,{to:"/zsku-mgmt/users/"+e.id},e.fullName)},align:"left",orderable:!0,sort:function(e,t){return e.fullName.localeCompare(t.fullName)}},{id:"col_abbreviation",name:"Abk\xfcrzung",data:"abbreviation",align:"left",orderable:!0,sort:function(e,t){return e.fullName.localeCompare(t.fullName)}},{id:"col_roles",name:"Posten",data:function(e){return e.roles.slice(0,3).map((function(e){var t;return null===(t=o[e])||void 0===t?void 0:t.name})).join(", ")+(e.roles.length>3?", ...":"")},align:"left"},{id:"col_timestamp",name:"Erstellt am",data:function(e){var t;return new Date(null!==(t=e.createdOn)&&void 0!==t?t:Date.now()).toLocaleDateString("de-DE")},align:"left",orderable:!0,sort:function(e,t){return e.createdOn-t.createdOn}},{id:"col_actions",name:"Aktionen",align:"right",data:function(e){return r.a.createElement("div",{style:{float:"right",display:"flex"}},r.a.createElement(K.a,{color:"primary",onClick:function(){t.push("/zsku-mgmt/users/"+e.id)}},r.a.createElement(G.f,{size:".75em"})),r.a.createElement(lt,{title:"Mitglied l\xf6schen",message:"Soll das Mitglied ".concat(e.fullName," wirklich gel\xf6scht werden?"),onConfirm:function(){null!=e.id&&a(P.actions.delete(e.id))},component:r.a.createElement(K.a,{color:"primary"},r.a.createElement(G.g,{size:".75em"}))}))}}],rows:i,entriesPerPage:5})})),yt=Object(c.b)()(Et),Ot=function(){return r.a.createElement(dt.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"usersMain settingszsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Mitglieder"),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.e,{size:"4em",style:{backgroundColor:A}})),r.a.createElement(u.b,{to:"/zsku-mgmt/users/new",style:{textDecoration:"none"}},r.a.createElement(ut.a,{variant:"text",color:"primary"},"Hinzuf\xfcgen"))),r.a.createElement(s.a,{path:"/zsku-mgmt/settings",component:yt})))},kt=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(Ot,null)),r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(ht,null)),r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(ot,null)),r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(We,null)))},St=a(298),jt=a(299),Nt=a(300),zt=a(311),wt=a(301),Tt=a(307),Ct=a(290),It=a(256),At=a(302),xt=a(312),Dt=["penalties","editable","user"],Pt=function(){var e=Object(c.c)();return r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Kein aktuelles Spiel"),r.a.createElement(h.a,{variant:"contained",color:"primary",onClick:function(){e(_e.actions.createGame())}},"Neues Spiel"))},Gt=function(e){var t=e.penalties,a=e.editable,n=e.user,l=Object(he.a)(e,Dt),i=Object(c.c)(),o=Object(c.d)((function(e){return ge.getSelectors().selectEntities(e.feeTypes)})),u=Object(c.d)(xe),s=Object(S.entries)(t.reduce((function(e,t){return null==e[t.feeTypeId]&&(e[t.feeTypeId]={count:0,sum:0,penalties:[]}),e[t.feeTypeId].count++,e[t.feeTypeId].sum+=t.value,e[t.feeTypeId].penalties.push(t),e}),{}));return r.a.createElement("div",l,r.a.createElement(le,{columns:[{id:"col_feetypename",data:function(e){var t,a;return null!==(t=null===(a=o[e[0]])||void 0===a?void 0:a.label)&&void 0!==t?t:"N/A"},name:"Strafe",orderable:!0},{id:"col_count",data:function(e){return a&&n?r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(K.a,{onClick:function(){var a=t.find((function(t){return t.feeTypeId===e[0]}));null!=a&&i(Ce.actions.delete(a.id))}},r.a.createElement(G.c,null)),r.a.createElement("span",null,e[1].count.toString()),r.a.createElement(K.a,{onClick:function(){var t,a;i(Ce.actions.create({createdOn:Date.now(),feeTypeId:e[0],gameId:u.id,id:Object(y.a)(),userId:n,value:null!==(t=null===(a=o[e[0]])||void 0===a?void 0:a.value)&&void 0!==t?t:0}))}},r.a.createElement(G.d,null))):e[1].count.toString()},name:"Anzahl",orderable:!0,sort:function(e,t){return e[1].count-t[1].count}},{id:"col_sum",data:function(e){return r.a.createElement(_,{val:e[1].sum,style:{margin:0}})},name:"Summe",orderable:!0,sort:function(e,t){return e[1].sum-t[1].sum}}],rows:s,entriesPerPage:10}))},Bt=function(e){var t,a=e.player,n=e.game,i=e.openAddPenalty,o=Object(c.c)(),u=Object(c.d)(Be(n.id,a.id)),s=Object(l.useState)(!1),d=Object(M.a)(s,2),m=d[0],p=d[1],f=Object(c.d)((function(e){var t;return e.roles.entities[null!==(t=a.roles.find(Boolean))&&void 0!==t?t:""]}));return r.a.createElement("div",null,r.a.createElement(St.a,{onClick:function(){return i(a)},elevation:2,style:{borderRadius:"1em",maxWidth:"750px",cursor:"pointer"}},r.a.createElement(jt.a,{avatar:r.a.createElement(E.a,{style:{backgroundColor:a.color}},a.abbreviation),action:r.a.createElement("div",{onClick:function(e){return e.stopPropagation()}},u.length>0?r.a.createElement(K.a,{title:"Details anzeigen",onClick:function(){p(!m)}},r.a.createElement(pe.a,{size:".85em"})):null,r.a.createElement(lt,{title:"Spieler entfernen",message:"Soll ".concat(a.fullName," aus dem Spiel entfernt werden? Alle Strafen f\xfcr diesen Spieler werden zur\xfcckgesetzt."),onConfirm:function(){o(Ce.actions.deleteMultiple(u.map((function(e){return e.id})))),o(_e.actions.removePlayerFromGame({userId:a.id}))},component:r.a.createElement(K.a,{title:"Spieler entfernen"},r.a.createElement(G.e,{color:"red",size:".85em"}))})),subheader:null!==(t=null===f||void 0===f?void 0:f.name)&&void 0!==t?t:"Kein Posten",title:a.fullName},r.a.createElement("h4",null,a.fullName)),m&&u.length>0?r.a.createElement(Nt.a,null,r.a.createElement(Gt,{penalties:u,user:a.id,editable:!0,onClick:function(e){return e.stopPropagation()}})):null,r.a.createElement(Nt.a,null,r.a.createElement("hr",{style:{borderTop:"1px solid #ddd",borderBottom:"0"}}),r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto 1px auto",alignItems:"center",marginBottom:0,marginTop:".75em"}},r.a.createElement("div",{style:{width:"100%",textAlign:"center"}},r.a.createElement("p",{style:{margin:".5em",fontWeight:"bold",color:"#888",textTransform:"uppercase",letterSpacing:".1em",fontSize:"small"}},"Strafen"),r.a.createElement("p",{style:{margin:".25em",fontWeight:"bold",fontSize:"large"}},u.length)),r.a.createElement("div",{style:{borderRight:"1px solid #ddd",height:"3em",margin:"0"}}),r.a.createElement("div",{style:{width:"100%",textAlign:"center"}},r.a.createElement("p",{style:{margin:".25em",fontWeight:"bold",color:"#888",textTransform:"uppercase",letterSpacing:".1em",fontSize:"small"}},"Betrag"),r.a.createElement(_,{style:{margin:".25em",fontWeight:"bold",fontSize:"large"},val:u.reduce((function(e,t){return e+t.value}),0)}))))))},Ft=function(e){var t,a,n=e.penaltyModalOpen,l=e.setPenaltyModalOpen,i=e.penaltyModalPlayer,o=e.game,u=Object(c.c)(),s=ve.b({feeType:ve.c().required(),value:ve.a().positive().required(),quantity:ve.a().min(0).required()}),d=Object(me.a)({initialValues:{feeType:"",value:void 0,quantity:1},validationSchema:s,onSubmit:function(e){var t=m.find((function(t){return t.id===e.feeType}));if(null!=t){for(var a=[],n=0;n<e.quantity;n++){var r=[];t.applicationStrategy===F.AutoAll?r.push.apply(r,Object(L.a)(o.users)):t.applicationStrategy===F.AllButTarget?r.push.apply(r,Object(L.a)(o.users.filter((function(e){return e!==i.id})))):t.applicationStrategy===F.Target&&r.push(i.id),a.push.apply(a,Object(L.a)(r.map((function(a){var n,l;return{id:Object(y.a)(),createdOn:Date.now(),feeTypeId:t.id,gameId:o.id,userId:a,value:parseFloat(null!==(n=null===(l=e.value)||void 0===l?void 0:l.toString())&&void 0!==n?n:"0")}}))))}u(Ce.actions.createMultiple(a)),d.resetForm({values:{feeType:"",quantity:1,value:void 0},touched:{feeType:!1,quantity:!1,value:!1},errors:{feeType:void 0,quantity:void 0,value:void 0}}),l(!1)}}}),m=Object(c.d)((function(e){return ge.getSelectors().selectAll(e.feeTypes)}));return r.a.createElement(et.a,{open:n,onClose:function(){return l(!1)},maxWidth:"sm",fullWidth:!0},r.a.createElement(tt.a,null,"Strafe f\xfcr ",null!==(t=null===i||void 0===i?void 0:i.fullName)&&void 0!==t?t:"?"),r.a.createElement(at.a,null,r.a.createElement("form",{onSubmit:d.handleSubmit},r.a.createElement("div",{className:"zsku-keyValueGrid"},r.a.createElement("h4",null,"Strafe"),r.a.createElement(oe.a,null,r.a.createElement(ue.a,{variant:"outlined",id:"feeType",name:"feeType",error:d.touched.feeType&&Boolean(d.errors.feeType),value:d.values.feeType,onChange:function(e){var t;d.setFieldValue("feeType",e.target.value);var a=m.find((function(t){return t.id===e.target.value}));d.setFieldValue("value",null!==(t=null===a||void 0===a?void 0:a.value)&&void 0!==t?t:0)},renderValue:function(){var e;return r.a.createElement("p",null,null===(e=m.find((function(e){return e.id===d.values.feeType})))||void 0===e?void 0:e.label)}},m.filter((function(e){return e.applicationStrategy!==F.AutoAll&&!0!==e.deleted})).sort((function(e,t){return e.label.localeCompare(t.label)})).map((function(e){return r.a.createElement(se.a,{key:e.id,value:e.id},e.label)})))),r.a.createElement("h4",null,"Betrag"),r.a.createElement(oe.a,null,r.a.createElement(Ne,{disabled:function(){var e=m.find((function(e){return e.id===d.values.feeType}));return null==e||null!=e.value}(),error:d.touched.value&&Boolean(d.errors.value),helperText:d.touched.value&&d.errors.value,size:"small",value:d.values.value,name:"Value",id:"value",onChange:function(e){return d.setFieldValue("value",e.target.value)}})),r.a.createElement("h4",null,"Anzahl"),r.a.createElement(oe.a,null,r.a.createElement(de.a,{type:"number",id:"quantity",variant:"outlined",size:"small",disabled:null==(null===(a=m.find((function(e){return e.id===d.values.feeType})))||void 0===a?void 0:a.value),onChange:d.handleChange,value:d.values.quantity,InputProps:{inputProps:{min:1}}}))),r.a.createElement(nt.a,null,r.a.createElement(h.a,{onClick:function(){return l(!1)}},"Abort"),r.a.createElement(h.a,{color:"primary",type:"submit"},"Best\xe4tigen")))))},_t=function(e){var t=e.game,a=e.open,n=e.setOpen,i=Object(c.d)((function(e){return e.users.ids.filter((function(e){return t.users.findIndex((function(t){return t===e}))<0})).map((function(t){return e.users.entities[t]})).filter((function(e){return null!=e&&!0!==e.deleted}))})),o=Object(c.d)((function(e){return e.feeTypes.ids.map((function(t){return e.feeTypes.entities[t]})).filter((function(e){return(null===e||void 0===e?void 0:e.applicationStrategy)===F.AutoAll}))})),u=Object(c.c)(),s=Object(l.useState)(0),d=Object(M.a)(s,2),m=d[0],p=d[1],f=Object(l.useState)(!0),v=Object(M.a)(f,2),g=v[0],b=v[1],k=Object(c.d)((function(e){return e.penalties.ids.map((function(t){return e.penalties.entities[t]})).filter((function(e){return(null===e||void 0===e?void 0:e.gameId)===t.id})).reduce((function(e,t){var a;return e+(null!==(a=null===t||void 0===t?void 0:t.value)&&void 0!==a?a:0)}),0)/t.users.length+(g?o.reduce((function(e,t){var a;return e+(null!==(a=t.value)&&void 0!==a?a:0)}),0):0)})),S=Object(c.d)((function(e){return ge.getSelectors().selectAll(e.feeTypes).filter((function(e){return e.applicationStrategy===F.AutoAll}))})),j=Object(c.d)((function(e){return C.getSelectors().selectTotal(e.transactions)})),N=Object(c.d)(Ge(t.id)),z=Object(c.d)(Fe(t.id));return r.a.createElement(et.a,{open:a,onClose:function(){return n(!1)},maxWidth:"sm",fullWidth:!0},r.a.createElement(tt.a,null,"Spiel Abschlie\xdfen"),r.a.createElement(zt.a,{activeStep:i.length>0?m:1},r.a.createElement(wt.a,null,r.a.createElement(Tt.a,null,"Geb\xfchren")),r.a.createElement(wt.a,null,r.a.createElement(Tt.a,null,"Strafen f\xfcr Abwesende"))),r.a.createElement(at.a,null,0===m?r.a.createElement("div",null,r.a.createElement("p",null,"Bestimme ob folgende Geb\xfchren (automatische Strafen) f\xfcr dieses Spiel angerechnet werden sollen."),r.a.createElement(Ct.a,null,o.map((function(e){var t;return r.a.createElement(It.a,null,e.label," (",B(null!==(t=e.value)&&void 0!==t?t:0),")")}))),r.a.createElement(At.a,{label:g?"Geb\xfchren werden angerechnet":"Geb\xfchren werden nicht angerechnet",labelPlacement:"end",control:r.a.createElement(ce.a,{color:"primary",checked:g,onChange:function(e){return b(e.target.checked)}})}),r.a.createElement(nt.a,null,r.a.createElement(h.a,{variant:"text",onClick:function(){return n(!1)}},"Abbrechen"),r.a.createElement(h.a,{variant:"text",color:"primary",onClick:function(){p(1)}},"Weiter"))):r.a.createElement("div",null,r.a.createElement("p",null,"Verteile Strafen f\xfcr abwesende Personen. Die H\xf6he wird dabei prozentual respektive der durchschnittlichen Strafe in diesem Spiel angerechnet. Der Prozentsatz wird hierbei durch die Qualit\xe4t der Ausrede bestimmt. ",r.a.createElement("br",null),"Die durchschnittliche Strafe betr\xe4gt ",r.a.createElement("b",null,B(null!==k&&void 0!==k?k:0))),i.map((function(e){var t,a;return r.a.createElement("div",{key:e.id,style:{display:"flex",gap:"1em",alignItems:"center",width:"100%"}},r.a.createElement(E.a,{title:e.fullName,style:{backgroundColor:e.color}},e.abbreviation),r.a.createElement("p",null,e.fullName),r.a.createElement("p",{style:{marginLeft:"auto"}},null!==(t=e.absencePenaltyPercentage)&&void 0!==t?t:50,"%"),r.a.createElement(xt.a,{valueLabelDisplay:"auto",onChange:function(t,a){return u(P.actions.update({id:e.id,changes:{absencePenaltyPercentage:"number"===typeof a?a:a[0]}}))},value:null!==(a=e.absencePenaltyPercentage)&&void 0!==a?a:50,min:0,max:100,step:50,style:{width:"5em"},marks:!0}))})),0===i.length&&r.a.createElement("p",null,"Keine abwesenden Spieler"),r.a.createElement(nt.a,null,r.a.createElement(h.a,{variant:"text",onClick:function(){return p(0)}},"Zur\xfcck"),r.a.createElement(h.a,{variant:"text",color:"primary",onClick:function(){!function(e){if(0!==z.length||0!==S.length){u(_e.actions.finishGame());var a,n=Object(O.a)(N);try{var l=function(){var n=a.value,l=Object(L.a)(z.filter((function(e){return e.userId===n.id})));if(e){var r=S.map((function(e){var a;return{id:Object(y.a)(),createdOn:Date.now(),feeTypeId:e.id,gameId:t.id,userId:n.id,value:null!==(a=e.value)&&void 0!==a?a:0}}));u(Ce.actions.createMultiple(r)),l.push.apply(l,Object(L.a)(r))}var i=l.reduce((function(e,t){return e+t.value}),0);if(0===l.length||0===i)return"continue";var o=Object(y.a)();u(I.actions.create({affectsGlobalLedger:!1,affectsUserLedger:!0,createdOn:Date.now(),description:"Strafen aus "+t.name,id:o,name:"TRANS-"+(j+1).toString().padStart(4,"0"),userId:n.id,value:-i,penalties:l.map((function(e){return e.id}))}))};for(n.s();!(a=n.n()).done;)l()}catch(d){n.e(d)}finally{n.f()}if(k>0){var r,o=Object(O.a)(i);try{for(o.s();!(r=o.n()).done;){var c,s=r.value;u(I.actions.create({affectsGlobalLedger:!1,affectsUserLedger:!0,createdOn:Date.now(),description:"Strafe f\xfcr Abwesenheit bei "+t.name,id:Object(y.a)(),name:"TRANS-"+(j+1).toString().padStart(4,"0"),userId:s.id,value:-k*(null!==(c=s.absencePenaltyPercentage)&&void 0!==c?c:50)/100,penalties:[]}))}}catch(d){o.e(d)}finally{o.f()}}}else u(_e.actions.abortGame())}(g)}},"Best\xe4tigen")))))},Wt=function(e){var t=e.game,a=Object(c.d)((function(e){return e.users.ids.filter((function(e){return t.users.findIndex((function(t){return t===e}))<0})).map((function(t){return e.users.entities[t]})).filter((function(e){return null!=e&&!0!==e.deleted}))})),n=Object(l.useState)(!1),i=Object(M.a)(n,2),o=i[0],u=i[1],s=Object(c.d)(Ge(t.id)),d=Object(c.d)(Fe(t.id)),m=Object(l.useState)(!1),p=Object(M.a)(m,2),f=p[0],v=p[1],g=Object(l.useState)(null),b=Object(M.a)(g,2),y=b[0],O=b[1],k=function(e){O(e),v(!0)},S=Object(c.c)();return r.a.createElement("div",null,r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,t.name),r.a.createElement(lt,{title:"Spiel abbrechen",message:"Spiel wirklich abbrechen? Alle bisher verteilten Strafen werden gel\xf6scht.",onConfirm:function(){S(_e.actions.abortGame()),S(Ce.actions.deleteMultiple(d.map((function(e){return e.id}))))},component:r.a.createElement(h.a,{variant:"text"},"Abbrechen")}),s.length>0&&r.a.createElement(h.a,{variant:"outlined",style:{color:"red",borderColor:"red"},onClick:function(){return u(!0)}},"Spiel Abschlie\xdfen"),r.a.createElement(_t,{open:o,setOpen:u,game:t})),r.a.createElement("div",{style:{margin:"0em 1em 1em",alignItems:"center"}},a.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{style:{marginBottom:".5em"}},"Spieler hinzuf\xfcgen"),r.a.createElement("div",{style:{display:"flex",columnGap:"1em"}},a.map((function(e){return r.a.createElement(E.a,{key:e.id,title:e.fullName,style:{backgroundColor:e.color},onClick:function(){S(_e.actions.addPlayerToOpenGame({userId:e.id}))}},e.abbreviation)})))):null),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"2em"}},s.map((function(e){return r.a.createElement(Bt,{game:t,player:e,key:e.id,openAddPenalty:k})})))),r.a.createElement(Ft,{penaltyModalOpen:f,penaltyModalPlayer:y,setPenaltyModalOpen:v,game:t}))},Lt=function(){var e=Object(c.d)(xe);return r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},null==e?r.a.createElement(Pt,null):r.a.createElement(Wt,{game:e})))},Mt=Object(s.g)((function(e){var t,a,n,l=Object(c.d)((function(t){return De(t,e.match.params.gameId)})),i=Object(c.d)(Fe(null===l||void 0===l?void 0:l.id)),o=Object(c.d)((function(e){return ge.getSelectors().selectEntities(e.feeTypes)})),s=Object(c.d)((function(e){return null===l||void 0===l?void 0:l.users.map((function(t){return e.users.entities[t]}))}));return r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,null!==(t=null===l||void 0===l?void 0:l.name)&&void 0!==t?t:"Spiel nicht gefunden")),r.a.createElement("div",{className:"zsku-keyValueGrid"},r.a.createElement("h4",null,"Gespielt am"),r.a.createElement("p",null,new Date(null===l||void 0===l?void 0:l.createdOn).toLocaleDateString("de-DE")),r.a.createElement("h4",null,"Strafen"),r.a.createElement("p",null,i.length),r.a.createElement("h4",null,"Gesamtbetrag"),r.a.createElement(_,{val:i.reduce((function(e,t){return e+t.value}),0),style:{margin:0}}),r.a.createElement("h4",null,"Durchschnitt"),r.a.createElement(_,{val:i.reduce((function(e,t){return e+t.value}),0)/(null!==(a=null===s||void 0===s?void 0:s.length)&&void 0!==a?a:1),style:{margin:0}})),(null===s||void 0===s?void 0:s.length)>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Mitspieler"),r.a.createElement(le,{columns:[{id:"col_name",name:"Name",data:function(e){return r.a.createElement(u.b,{to:"/zsku-mgmt/users/"+e.id},e.fullName)},align:"left",orderable:!0,sort:function(e,t){return e.fullName.localeCompare(t.fullName)}},{id:"col_penaltycount",name:"Strafen",data:function(e){return r.a.createElement("p",{style:{margin:0}},i.filter((function(t){return t.userId===e.id})).length)},align:"left",orderable:!0,sort:function(e,t){return i.filter((function(t){return t.userId===e.id})).length-i.filter((function(e){return e.userId===t.id})).length}},{id:"col_penaltysum",name:"Gesamtbetrag",data:function(e){return r.a.createElement(_,{style:{margin:0},val:i.filter((function(t){return t.userId===e.id})).reduce((function(e,t){return e+t.value}),0)})},align:"left",orderable:!0,sort:function(e,t){return i.filter((function(t){return t.userId===e.id})).reduce((function(e,t){return e+t.value}),0)-i.filter((function(e){return e.userId===t.id})).reduce((function(e,t){return e+t.value}),0)}},{id:"col_penaltyfav",name:"Am h\xe4ufigsten",data:function(e){return r.a.createElement("p",{style:{margin:0}},function(){var t,a=i.filter((function(t){return t.userId===e.id}));if(0===a.length)return"Keine Strafe";var n=null!==(t=Object(S.maxBy)(Object(S.entries)(Object(S.countBy)(i.filter((function(t){return t.userId===e.id})),(function(e){return e.feeTypeId}))),(function(e){return Object(S.last)(e)})))&&void 0!==t?t:[],l=Object(M.a)(n,1)[0];if(null==l)return"N/A";var r=o[l];return null==r?"N/A":r.label+" (".concat(B(a.filter((function(e){return e.feeTypeId===r.id})).reduce((function(e,t){return e+t.value}),0)),")")}())},align:"left",orderable:!1}],rows:null!==s&&void 0!==s?s:[],entriesPerPage:null!==(n=null===s||void 0===s?void 0:s.length)&&void 0!==n?n:0})):null))})),Rt=function(){var e=Object(c.d)(Pe).sort((function(e,t){return t.createdOn-e.createdOn})),t=Object(c.d)((function(e){return Te.getSelectors().selectAll(e.penalties)})),a=Object(c.d)((function(e){return D.getSelectors().selectEntities(e.users)}));return r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Beendete Spiele")),r.a.createElement("div",null,r.a.createElement(le,{columns:[{id:"col_name",name:"Name",data:function(e){return r.a.createElement(u.b,{to:"/zsku-mgmt/games/"+e.id},e.name)},orderable:!0,sort:function(e,t){return e.name.localeCompare(t.name)}},{id:"col_users",name:"Mitspieler",data:function(e){return r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"}},e.users.map((function(e){return a[e]})).filter(Boolean).sort((function(e,t){return e.abbreviation.localeCompare(t.abbreviation,"de-DE")})).map((function(e){var t;return r.a.createElement(u.b,{to:"users/"+(null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:"0"),key:Object(y.a)()},r.a.createElement(E.a,{key:Object(y.a)(),style:{fontWeight:"normal",backgroundColor:e.color}},e.abbreviation))})))}},{id:"col_totalpenalties",name:"Strafen (Anzahl)",data:function(e){return t.filter((function(t){return t.gameId===e.id})).length.toString()},orderable:!0,sort:function(e,a){return t.filter((function(t){return t.gameId===e.id})).length-t.filter((function(e){return e.gameId===a.id})).length}},{id:"col_sumpenalties",name:"Strafen (Summe)",data:function(e){return B(t.filter((function(t){return t.gameId===e.id})).reduce((function(e,t){return e+t.value}),0))},orderable:!0,sort:function(e,a){return t.filter((function(t){return t.gameId===e.id})).reduce((function(e,t){return e+t.value}),0)-t.filter((function(e){return e.gameId===a.id})).reduce((function(e,t){return e+t.value}),0)}},{id:"col_date",name:"Gespielt am",data:function(e){return new Date(e.createdOn).toLocaleDateString("de-DE")},orderable:!0,sort:function(e,t){return e.createdOn-t.createdOn}}],rows:e,entriesPerPage:10}))))},Vt=function(){return r.a.createElement("div",null,r.a.createElement(Lt,null),r.a.createElement(Rt,null))},Ht=a(169),Ut=a(313),Kt=a(199),qt=Object(s.g)((function(e){var t,a,n,l,i=Object(c.d)((function(t){return D.getSelectors((function(e){return e.users})).selectById(t,e.match.params.userId)})),o=Object(c.d)((function(e){return e.roles})),d=Object(c.d)((function(e){return e.transactions.ids.map((function(t){return e.transactions.entities[t]})).filter((function(e){return null!=i&&(null===e||void 0===e?void 0:e.userId)===i.id}))})),m=Object(c.d)((function(e){return null!=i&&Te.getSelectors().selectAll(e.penalties).filter((function(e){return e.userId===i.id}))})),p=Object(c.c)(),f=Object(s.f)(),v=ve.b({fullName:ve.c().required("Der Nutzername ist erforderlich"),color:ve.c().matches(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,"Bitte die Farbe als g\xfcltigen Hexcode eingeben")}),g=Object(me.a)({initialValues:{fullName:null!==(t=null===i||void 0===i?void 0:i.fullName)&&void 0!==t?t:"",color:null!==(a=null===i||void 0===i?void 0:i.color)&&void 0!==a?a:"",roles:null!==(n=null===i||void 0===i?void 0:i.roles)&&void 0!==n?n:[]},validationSchema:v,onSubmit:function(t){if("new"===e.match.params.userId){var a=Object(y.a)(),n=t.color||x[Math.floor(Math.random()*x.length)];t.color||g.setFieldValue("color",n),p(P.actions.create({fullName:t.fullName,color:n,abbreviation:null==t.fullName||""===t.fullName?"":t.fullName.split(" ").filter((function(e){return e.length>0})).map((function(e){return e[0]})).join(""),id:a,createdOn:Date.now(),roles:t.roles})),f.push({pathname:"/zsku-mgmt/users/"+a})}else{var l;p(P.actions.update({id:e.match.params.userId,changes:{fullName:t.fullName,color:t.color,abbreviation:null==t.fullName||""===t.fullName?"":t.fullName.split(" ").filter((function(e){return e.length>0})).map((function(e){return e[0]})).join(""),roles:null!==(l=t.roles)&&void 0!==l?l:[]}}))}}}),O=function(e){return e.split(" ").filter((function(e){return e.length>0})).map((function(e){return e[0]})).join("")};return r.a.createElement("div",null,r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,null!==(l=null===i||void 0===i?void 0:i.fullName)&&void 0!==l?l:"Neues Mitglied"),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.d,{size:"4em",style:{backgroundColor:A}}))),r.a.createElement("form",{onSubmit:g.handleSubmit},r.a.createElement("div",{className:"zsku-keyValueGrid"},r.a.createElement("h4",null,"Name"),r.a.createElement(oe.a,null,r.a.createElement(de.a,{error:g.touched.fullName&&Boolean(g.errors.fullName),helperText:g.touched.fullName&&g.errors.fullName,variant:"outlined",size:"small",name:"fullName",id:"fullName",value:g.values.fullName,onChange:g.handleChange})),null!=i?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Abk\xfcrzung"),r.a.createElement(de.a,{variant:"outlined",size:"small",name:"abbreviation",id:"abbreviation",fullWidth:!0,disabled:!0,value:null==g.values.fullName||""===g.values.fullName?"":O(g.values.fullName)})):null,r.a.createElement("h4",null,"Farbe"),r.a.createElement(oe.a,null,r.a.createElement(Ht.a,{error:g.touched.color&&Boolean(g.errors.color),endAdornment:r.a.createElement(E.a,{style:{backgroundColor:g.values.color}},O(g.values.fullName)),name:"color",id:"color",value:g.values.color,onChange:g.handleChange})),null!=i?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Erstellt am"),r.a.createElement(de.a,{variant:"outlined",size:"small",name:"createdOn",id:"createdOn",fullWidth:!0,disabled:!0,value:new Date(i.createdOn).toLocaleDateString("de-DE")})):null,r.a.createElement("h4",null,"Posten"),r.a.createElement(oe.a,null,r.a.createElement(ue.a,{variant:"outlined",multiple:!0,value:g.values.roles,onChange:function(e){return g.setFieldValue("roles",e.target.value)},renderValue:function(e){return r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},e.map((function(e){var t;return r.a.createElement(Ut.a,{onMouseDown:function(e){e.stopPropagation()},key:e,label:null===(t=o.entities[e])||void 0===t?void 0:t.name,style:{margin:"5px 10px 0 0"},onDelete:function(t){g.setFieldValue("roles",g.values.roles.filter((function(t){return t!==e})))}})})))},MenuProps:{PaperProps:{style:{maxHeight:"30vh"}}}},o.ids.map((function(e){var t,a;return r.a.createElement(se.a,{key:e,value:e},null!==(t=null===(a=o.entities[e])||void 0===a?void 0:a.name)&&void 0!==t?t:"Unknown")})))),r.a.createElement("div",{className:"gridSpacer"}),r.a.createElement("div",null,r.a.createElement(oe.a,{style:{float:"right"}},r.a.createElement(h.a,{variant:"contained",type:"submit",id:"formSubmit",color:"primary",startIcon:r.a.createElement(fe.a,{size:".75em"})},"Speichern"))))))),"new"===e.match.params.userId?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Strafen"),r.a.createElement("div",{className:"logo"},r.a.createElement(Kt.a,{size:"4em",style:{backgroundColor:"#FF751F"}}))),r.a.createElement("div",{className:"zsku-keyValueGrid"},r.a.createElement("h4",null,"Gesamt"),r.a.createElement(_,{val:(null!==m&&void 0!==m?m:[]).reduce((function(e,t){var a;return e+(null!==(a=t.value)&&void 0!==a?a:0)}),0)})),r.a.createElement(Gt,{penalties:null!==m&&void 0!==m?m:[]}))),r.a.createElement("div",{className:"zsku-panel"},r.a.createElement(b.a,{elevation:3,className:"zsku-panel"},r.a.createElement("div",{className:"zsku-panelHeading"},r.a.createElement("h1",null,"Transaktionen"),r.a.createElement(u.b,{to:"/zsku-mgmt/transactions/new/"+e.match.params.userId},r.a.createElement(h.a,{variant:"text",color:"primary"},"Hinzuf\xfcgen")),r.a.createElement("div",{className:"logo"},r.a.createElement(pe.c,{size:"4em",style:{backgroundColor:"#F9C846"}}))),r.a.createElement("div",{className:"zsku-keyValueGrid"},r.a.createElement("h4",null,"Kassenbestand"),r.a.createElement(W,{val:d.reduce((function(e,t){var a;return e+(null!==(a=t.value)&&void 0!==a?a:0)}),0)})),r.a.createElement(re,{transactions:d})))))})),Zt=a(150);function Jt(){return r.a.createElement("div",null,r.a.createElement("ul",null,r.a.createElement(u.b,{to:"/zsku-mgmt/games"},r.a.createElement("li",null,r.a.createElement(Zt.a,{size:"1.75em"}),r.a.createElement("h4",null,"Spiele"))),r.a.createElement(u.b,{to:"/zsku-mgmt/ledgers"},r.a.createElement("li",null,r.a.createElement(Zt.c,{size:"1.75em"}),r.a.createElement("h4",null,"Kasse"))),r.a.createElement(u.b,{to:"/zsku-mgmt/settings"},r.a.createElement("li",null,r.a.createElement(Zt.b,{size:"1.75em"}),r.a.createElement("h4",null,"Einstellungen")))))}function $t(e){var t=e.abbreviation,a=e.color;return r.a.createElement(E.a,{style:{backgroundColor:a}},t)}var Qt=Object(c.b)()((function(e){var t,a=e.user,n=null!==(t=Object(c.d)((function(e){return null===a||void 0===a?void 0:a.roles.map((function(t){return e.roles.entities[t]}))})))&&void 0!==t?t:[];return null==a?r.a.createElement("div",{className:"sidebarUser"},r.a.createElement("p",null,"Loading ...")):r.a.createElement("div",{className:"sidebarUser"},r.a.createElement($t,{color:null===a||void 0===a?void 0:a.color,abbreviation:null===a||void 0===a?void 0:a.abbreviation}),r.a.createElement("div",{className:"sidebarUserInfo"},r.a.createElement("h1",null,null===a||void 0===a?void 0:a.fullName),r.a.createElement("p",null,n.slice(0,3).map((function(e){return e.name})).join(", "))))})),Xt=function(e){var t=e.user,a=Object(l.useState)(!1),n=Object(M.a)(a,2),i=n[0],o=n[1];return r.a.createElement("aside",{className:"sidebar"+(i?" minimized":"")},r.a.createElement(Qt,{user:t}),r.a.createElement(Jt,null),r.a.createElement(K.a,{className:"minimize",onClick:function(){o(!i)}},i?r.a.createElement(G.b,null):r.a.createElement(G.a,null)))},Yt=a(200),ea=a(292),ta=Object(Yt.a)({palette:{primary:{main:A}}}),aa=function(){var e=Object(c.d)((function(e){return j.a.first(D.getSelectors().selectAll(e.users))}));return r.a.createElement(u.a,null,r.a.createElement(ea.a,{theme:ta},r.a.createElement("div",{className:"mainContainer"},r.a.createElement("div",{className:"sidebarContainer"},r.a.createElement(Xt,{user:e})),r.a.createElement("div",{className:"contentContainer"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/zsku-mgmt/users/:userId",component:qt}),r.a.createElement(s.a,{path:"/zsku-mgmt/transactions/:transactionId/:userId?",component:ze}),r.a.createElement(s.a,{path:"/zsku-mgmt/ledgers",component:ie}),r.a.createElement(s.a,{path:"/zsku-mgmt/settings",component:kt}),r.a.createElement(s.a,{path:"/zsku-mgmt/games/:gameId",exact:!0,component:Mt}),r.a.createElement(s.a,{path:"/zsku-mgmt/games",exact:!0,component:Vt}),r.a.createElement(s.a,{path:"/zsku-mgmt",strict:!0},r.a.createElement(g,{user:e})))))))};var na=Object(c.b)()((function(){var e=Object(c.d)((function(e){return e.loading}));return r.a.createElement("div",{className:"App"},e?r.a.createElement("div",null):r.a.createElement(aa,null))})),la=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ra(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:$e},r.a.createElement(na,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/zsku-mgmt",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/zsku-mgmt","/service-worker.js");la?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ra(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ra(t,e)}))}}()}},[[210,1,2]]]);
//# sourceMappingURL=main.00eb2f61.chunk.js.map