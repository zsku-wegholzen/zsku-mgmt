{"version":3,"sources":["assets/logo.svg","main/landing/landing.tsx","redux/Database.ts","redux/reducers/transactions.ts","main/common/colors.ts","redux/reducers/users.ts","main/common/currency.tsx","entities/entities.ts","main/common/genericTable.tsx","main/ledgers/transactionsTable.tsx","main/ledgers/ledgers.tsx","redux/reducers/feeTypes.ts","main/common/currencyField.tsx","main/ledgers/transactionForm.tsx","redux/reducers/penalties.ts","redux/reducers/roles.ts","redux/reducers/games.ts","main/settings/dataManagement.tsx","main/settings/FeeTypes/feeTypesEditForm.tsx","redux/store.ts","main/settings/FeeTypes/feeTypesCreateForm.tsx","main/common/confirmationDialog.tsx","main/settings/FeeTypes/feeTypesTable.tsx","main/settings/FeeTypes/feeTypes.tsx","main/settings/Roles/rolesCreateForm.tsx","main/settings/Roles/rolesEditForm.tsx","main/settings/Roles/rolesTable.tsx","main/settings/Roles/roles.tsx","main/settings/Users/usersTable.tsx","main/settings/Users/users.tsx","main/settings/settings.tsx","main/games/games.tsx","main/users/userForm.tsx","sidebar/links.tsx","sidebar/user.tsx","sidebar/sidebar.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["_title","_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","title","props","createElement","width","height","viewBox","ref","undefined","transform","style","strokeWidth","d","fill","stroke","ForwardRef","forwardRef","Landing","className","user","fullName","db","feeTypes","penalties","roles","users","transactions","games","version","stores","table","Dexie","transactionsAdapter","createEntityAdapter","transactionsSlice","createSlice","initialState","getInitialState","name","reducers","create","state","action","ids","push","payload","id","entities","put","delete","filter","set","map","ft","clear","then","bulkPut","update","_","merge","changes","blue","colors","usersAdapter","usersSlice","color","ldsh","sample","deleted","formatCurrency","val","toFixed","FeeTypeApplicationStrategy","Currency","Balance","inverted","display","alignItems","gap","float","size","GenericTable","currentPage","order","pageBounds","bind","pageNumber","rowCount","lowerBound","entriesPerPage","upperBound","Math","min","rows","columns","sortedRows","entries","sort","a","b","priority","forEach","column","find","c","Error","direction","valA","data","valB","comparisonResult","cols","selectable","addSelected","removeSelected","row","Checkbox","onChange","evt","checked","orderable","align","headerCells","col","arr","TableCell","v4","sortDirection","TableSortLabel","active","onClick","shiftKey","Date","now","setState","tableRows","sortByOrderObject","slice","TableRow","cells","actions","padding","IconButton","handle","icon","TableContainer","component","Paper","elevation","Table","TableHead","TableBody","TableFooter","TablePagination","count","rowsPerPage","rowsPerPageOptions","page","onPageChange","Component","TransactionTable","useSelector","getSelectors","selectEntities","dispatch","useDispatch","r","to","localeCompare","description","substr","userId","userA","userB","value","createdOn","toLocaleDateString","BsTrashFill","Ledgers","withRouter","history","selectAll","usersArray","u","t","affectsGlobalLedger","reduce","agg","next","Button","balance","cursor","position","Avatar","backgroundColor","top","right","abbreviation","marginLeft","marginRight","bottom","e","stopPropagation","tId","affectsUserLedger","toString","padStart","feeTypesAdapter","feeTypesSlice","NumberFormatCustom","inputRef","other","getInputRef","onValueChange","values","thousandSeparator","decimalSeparator","isNumericString","fixedDecimalScale","decimalScale","allowedDecimalSeparators","allowNegative","allowLeadingZeros","prefix","CurrencyField","variant","InputProps","startAdornment","inputComponent","TransactionForm","router","useHistory","validationSchema","yup","required","notOneOf","transaction","selectById","match","params","transactionId","transactionCount","selectTotal","transactionPenalties","p","countedPenalties","penalty","feeType","feeTypeId","label","formik","useFormik","initialValues","onSubmit","setSubmitting","resetForm","newTransactionId","parseFloat","handleSubmit","FormControl","Switch","setFieldValue","disabled","error","touched","Boolean","errors","helperText","Select","itemType","renderValue","onMouseDown","MenuItem","TextField","multiline","handleChange","fullWidth","type","startIcon","penaltiesAdapter","penaltiesSlice","createMultiple","deleteMultiple","findIndex","del","bulkDelete","rolesAdapter","rolesSlice","gameSelectors","openGame","gameId","usr","playerId","gamesSlice","createGame","newGame","status","finishGame","game","abortGame","g","setGames","addPlayerToOpenGame","removePlayerFromGame","DataManagement","IndexedDBExport","download","toArray","exportDB","JSON","stringify","element","document","file","Blob","href","URL","createObjectURL","toISOString","substring","body","appendChild","click","remove","IndexedDBImport","upload","accept","multiple","addEventListener","files","text","parse","bulkAdd","FeeTypesEditForm","applicationStrategy","Target","parseInt","AllButTarget","AutoAll","editFeeType","connect","ownProps","bindActionCreators","loadingSlice","store","configureStore","reducer","loading","dbFeeTypes","dbRoles","dbUsers","useStoreDispatch","FeeTypesCreateForm","useState","setValue","setLabel","setApplicationStrategy","ConfirmationDialog","message","onConfirm","onAbort","custom","open","setOpen","Dialog","onClose","DialogTitle","DialogContent","flexDirection","idx","DialogActions","FeeTypesTable","deleteFeeType","FeeTypes","textDecoration","path","RolesCreateForm","setName","RolesEditForm","role","editRole","RolesTable","rolesCollection","Roles","UsersTable","usersCollection","join","Users","Settings","NoCurrentGame","GroupedPenalties","editable","groupedPenalties","sum","margin","PlayerCard","player","openAddPenalty","showStats","setShowStats","Card","borderRadius","maxWidth","CardHeader","avatar","subheader","CardContent","borderTop","borderBottom","gridTemplateColumns","marginBottom","marginTop","textAlign","fontWeight","textTransform","letterSpacing","fontSize","borderRight","AddPenaltyDialog","penaltyModalOpen","setPenaltyModalOpen","penaltyModalPlayer","positive","quantity","targets","inputProps","FinishGameDialog","notParticipating","autoPenalties","activeFinishGameStep","setActiveFinishGameStep","defaultPenaltiesEnabled","setDefaultPenaltiesEnabled","averagePenalty","autoFeeTypes","players","Stepper","activeStep","Step","StepLabel","List","ListItem","FormControlLabel","labelPlacement","control","absencePenaltyPercentage","Slider","valueLabelDisplay","v","max","step","marks","withAutoPenalties","userPenalties","pen","autoFee","up","absent","ExistingCurrentGame","showFinishGameDialog","setShowFinishGameDialog","setPenaltyModalPlayer","borderColor","columnGap","CurrentGameForm","activeGame","ClosedGameForm","maxBy","countBy","entry","last","ClosedGamesList","closedGames","flexWrap","Games","UserForm","tid","matches","newUserId","chosenColor","floor","random","split","s","pathname","getAbbreviation","OutlinedInput","endAdornment","selected","Chip","onDelete","sr","MenuProps","PaperProps","maxHeight","rId","SidebarLinks","SidebarUserLogo","userRoles","Sidebar","minimized","setMinimized","theme","createTheme","palette","primary","main","Main","first","ThemeProvider","exact","strict","isLocalhost","window","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","ReactDOM","render","StrictMode","getElementById","process","origin","fetch","headers","response","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.00eb2f61.chunk.js","sourcesContent":["var _title;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 250,\n    height: 250,\n    viewBox: \"0 0 66.146 66.146\",\n    ref: svgRef\n  }, props), title === undefined ? _title || (_title = /*#__PURE__*/React.createElement(\"title\", null, \"ZSKU Logo\")) : title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(0 -230.85)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"matrix(2.5493 0 0 2.5493 -32.372 -379.35)\",\n    style: {\n      strokeWidth: 0.79375\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m17.907 240.94h15.502v15.502h-15.502z\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m17.907 256.44 15.502-15.502\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m33.409 256.44-7.7508-7.7508v-7.7508\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m25.658 248.69v7.7508\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m25.658 248.69c-2.1403 0-3.8754-1.7351-3.8754-3.8754 3e-6 -2.1403 1.7351-3.8754 3.8754-3.8754s3.8754 1.7351 3.8754 3.8754\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m25.632 248.68c2.1403 0 3.8754 1.7351 3.8754 3.8754 2e-6 2.1403-1.7351 3.8754-3.8754 3.8754s-3.8754-1.7351-3.8754-3.8754\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m33.409 256.46c3e-6 4.2807-3.4702 7.7508-7.7508 7.7508s-7.7508-3.4702-7.7508-7.7508\",\n    style: {\n      fill: \"none\",\n      strokeWidth: 0.79375,\n      stroke: \"#000\"\n    }\n  }))));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.f52357e3.svg\";\nexport { ForwardRef as ReactComponent };","import React from \"react\";\r\nimport { ReactComponent as Logo } from \"../../assets/logo.svg\";\r\nimport { User } from \"../../entities/entities\";\r\n\r\nexport const Landing = (props: { user: User }) => {\r\n\treturn (\r\n\t\t<div className=\"landingMain\">\r\n\t\t\t<div>\r\n\t\t\t\t<Logo />\r\n\t\t\t\t<h1>ZSKU Wegholzen</h1>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tWillkommen im ZSKU Management Portal, <br />\r\n\t\t\t\t\t{props.user?.fullName}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n","import Dexie from \"dexie\";\r\nimport { FeeType, Game, Penalty, Role, Transaction, User } from \"../entities/entities\";\r\n\r\nclass Database extends Dexie {\r\n\tfeeTypes: Dexie.Table<FeeType, string>;\r\n\tpenalties: Dexie.Table<Penalty, string>;\r\n\troles: Dexie.Table<Role, string>;\r\n\tusers: Dexie.Table<User, string>;\r\n\ttransactions: Dexie.Table<Transaction, string>;\r\n\tgames: Dexie.Table<Game, string>;\r\n\tconstructor() {\r\n\t\tsuper(\"zsku-db\");\r\n\t\tthis.version(4).stores({\r\n\t\t\tfeeTypes: \"id,createdOn,label,value,applicationStrategy,deleted\",\r\n\t\t\tpenalties: \"id,createdOn,gameId,userId,feeTypeId,value\",\r\n\t\t\troles: \"id,createdOn,name\",\r\n\t\t\tusers: \"id,createdOn,abbreviation,fullName,color,deleted\",\r\n\t\t\ttransactions: \"id,createdOn,name,description,userId,value,affectsGlobalLedger,affectsGlobalUser\",\r\n\t\t\tgames: \"id,createdOn,name,status,users\",\r\n\t\t});\r\n\t\tthis.feeTypes = this.table(\"feeTypes\");\r\n\t\tthis.penalties = this.table(\"penalties\");\r\n\t\tthis.roles = this.table(\"roles\");\r\n\t\tthis.users = this.table(\"users\");\r\n\t\tthis.transactions = this.table(\"transactions\");\r\n\t\tthis.games = this.table(\"games\");\r\n\t}\r\n}\r\nexport const db = new Database();\r\n","import { createEntityAdapter, createSlice, PayloadAction, Update } from \"@reduxjs/toolkit\";\r\nimport _ from \"lodash\";\r\nimport { Transaction } from \"../../entities/entities\";\r\nimport { db } from \"../Database\";\r\nconst transactionsAdapter = createEntityAdapter<Transaction>();\r\nconst transactionsSlice = createSlice({\r\n\tinitialState: transactionsAdapter.getInitialState(),\r\n\tname: \"transactions\",\r\n\treducers: {\r\n\t\tcreate(state, action: PayloadAction<Transaction>) {\r\n\t\t\tstate.ids.push(action.payload.id);\r\n\t\t\tstate.entities[action.payload.id] = action.payload;\r\n\t\t\tdb.transactions.put(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdelete(state, action: PayloadAction<string>) {\r\n\t\t\tstate.ids = state.ids.filter((id) => id !== action.payload);\r\n\t\t\tdelete state.entities[action.payload];\r\n\t\t\tdb.transactions.delete(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tset(state, action: PayloadAction<Transaction[]>) {\r\n\t\t\tstate.ids = action.payload.map((ft) => ft.id);\r\n\t\t\tstate.entities = {};\r\n\t\t\tfor (const ft of action.payload) {\r\n\t\t\t\tstate.entities[ft.id] = ft;\r\n\t\t\t}\r\n\t\t\tdb.transactions.clear().then(() => {\r\n\t\t\t\tdb.transactions.bulkPut(action.payload);\r\n\t\t\t});\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tupdate(state, action: PayloadAction<Update<Transaction>>) {\r\n\t\t\tstate.entities[action.payload.id] = _.merge(state.entities[action.payload.id], action.payload.changes);\r\n\t\t\tdb.transactions.update(action.payload.id as string, action.payload.changes);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport { transactionsAdapter, transactionsSlice };\r\n","export const blue = \"#2978bf\";\r\nexport const orange = \"#FF751F\";\r\nexport const yellow = \"#F9C846\";\r\nexport const purple = \"#5b4e77\";\r\nexport const green = \"#7DCE82\";\r\n\r\nexport const colors = [blue, orange, yellow, purple, green];","import { createEntityAdapter, createSlice, PayloadAction, Update } from \"@reduxjs/toolkit\";\r\nimport ldsh from \"lodash\";\r\nimport { User } from \"../../entities/entities\";\r\nimport { colors } from \"../../main/common/colors\";\r\nimport { db } from \"../Database\";\r\n\r\n\r\nconst usersAdapter = createEntityAdapter<User>();\r\nconst usersSlice = createSlice({\r\n\tinitialState: usersAdapter.getInitialState(),\r\n\tname: \"users\",\r\n\treducers: {\r\n\t\tcreate(state, action: PayloadAction<User>) {\r\n\t\t\tif (action.payload.color == null) {\r\n\t\t\t\taction.payload.color = ldsh.sample(colors) ?? \"#aaa\"\r\n\t\t\t}\r\n\t\t\tstate.ids.push(action.payload.id);\r\n\t\t\tstate.entities[action.payload.id] = action.payload;\r\n\t\t\tdb.users.put(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdelete(state, action: PayloadAction<string>) {\r\n\t\t\tconst user = state.entities[action.payload];\r\n\t\t\tif (user == null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tuser.deleted = true;\r\n\t\t\tdb.users.update(action.payload, { deleted: true });\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tset(state, action: PayloadAction<User[]>) {\r\n\t\t\tstate.ids = action.payload.map((ft) => ft.id);\r\n\t\t\tstate.entities = {};\r\n\t\t\tfor (const ft of action.payload) {\r\n\t\t\t\tstate.entities[ft.id] = ft;\r\n\t\t\t}\r\n\t\t\tdb.users.clear().then(() => {\r\n\t\t\t\tdb.users.bulkPut(action.payload);\r\n\t\t\t});\r\n\t\t},\r\n\t\tupdate(state, action: PayloadAction<Update<User>>) {\r\n\t\t\tstate.entities[action.payload.id] = ldsh.merge(state.entities[action.payload.id], action.payload.changes);\r\n\t\t\tdb.users.update(action.payload.id as string, action.payload.changes);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport { usersAdapter, usersSlice };\r\n","import React, { ComponentProps } from \"react\";\r\nimport { BsTriangleFill } from \"react-icons/bs\";\r\n\r\ninterface CurrencyProps extends ComponentProps<\"p\"> {\r\n\tval: number;\r\n}\r\n\r\nfunction formatCurrency(val: number) {\r\n\treturn `${(val ?? 0).toFixed(2)} `;\r\n}\r\n\r\nconst Currency = (props: CurrencyProps) => {\r\n\treturn <p style={props.style}>{formatCurrency(props.val)}</p>;\r\n};\r\n\r\nconst Balance = (props: { val: number; inverted?: boolean }) => {\r\n\tconst val = (props.inverted ? -1 : 1) * props.val;\r\n\treturn (\r\n\t\t<div className=\"balance\" style={{ display: \"flex\", alignItems: \"center\", gap: \".25em\", float: \"right\" }}>\r\n\t\t\t{(() => {\r\n\t\t\t\tif (val > 0) {\r\n\t\t\t\t\treturn <BsTriangleFill size=\"0.5em\" color=\"green\"></BsTriangleFill>;\r\n\t\t\t\t} else if (val < 0) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<BsTriangleFill\r\n\t\t\t\t\t\t\tsize=\"0.5em\"\r\n\t\t\t\t\t\t\tcolor=\"red\"\r\n\t\t\t\t\t\t\tstyle={{ transform: \"rotate(0.5turn)\" }}></BsTriangleFill>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t})()}\r\n\t\t\t<Currency val={val}></Currency>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n\r\nexport { Balance, Currency, formatCurrency };\r\n\r\n","export interface Entity {\r\n\tid: string;\r\n\tcreatedOn: number;\r\n}\r\n\r\nexport interface SoftDeleteEntity extends Entity {\r\n\tdeleted?: boolean;\r\n}\r\n\r\nexport interface User extends SoftDeleteEntity {\r\n\tabbreviation: string;\r\n\tfullName: string;\r\n\tcolor: string;\r\n    absencePenaltyPercentage?: number;\r\n\troles: string[];\r\n}\r\n\r\nexport interface Role extends Entity {\r\n\tname: string;\r\n}\r\n\r\nexport interface FeeType extends SoftDeleteEntity {\r\n\tvalue?: number;\r\n\tlabel: string;\r\n\tapplicationStrategy: FeeTypeApplicationStrategy;\r\n}\r\n\r\nexport enum FeeTypeApplicationStrategy {\r\n\tTarget,\r\n\tAllButTarget,\r\n\tAutoAll,\r\n}\r\n\r\nexport interface Game extends Entity {\r\n\tstatus: \"open\" | \"closed\";\r\n\tusers: string[];\r\n\tname: string;\r\n}\r\n\r\nexport interface Penalty extends Entity {\r\n\tgameId: string;\r\n\tuserId: string;\r\n\tfeeTypeId: string;\r\n\tvalue: number;\r\n}\r\n\r\nexport interface Transaction extends Entity {\r\n\tname: string;\r\n\tdescription: string;\r\n\tuserId: string;\r\n\tvalue: number;\r\n\taffectsGlobalLedger: boolean;\r\n\taffectsUserLedger: boolean;\r\n\tpenalties: string[];\r\n}","import { Checkbox, IconButton, TableFooter, TableSortLabel } from \"@material-ui/core\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TablePagination from \"@material-ui/core/TablePagination\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport React, { Component } from \"react\";\r\nimport { IconType } from \"react-icons\";\r\nimport { v4 } from \"uuid\";\r\nimport \"../../entities/dataservice\";\r\n\r\nexport type GenericColumn<T> = {\r\n\tid: string;\r\n\tname: string;\r\n\tdata: ((row: T) => string | React.ReactElement) | keyof T;\r\n\talign?: \"left\" | \"right\";\r\n\torderable?: boolean;\r\n\tsort?: (a: T, b: T) => number\r\n};\r\n\r\nexport type GenericTableState = {\r\n\tcurrentPage: number;\r\n\torder: { [colId: string]: { priority: number; direction: \"asc\" | \"desc\" } };\r\n};\r\n\r\nexport interface GenericTableProperties<T> {\r\n\tcolumns: GenericColumn<T>[];\r\n\tentriesPerPage: number;\r\n\trows: T[];\r\n\tactions?: { icon: IconType; handle: (row: T) => any }[];\r\n\tselectable?: boolean;\r\n\taddSelected?: (row: T) => void;\r\n\tremoveSelected?: (row: T) => void;\r\n}\r\n\r\nexport class GenericTable<T> extends Component<GenericTableProperties<T>, GenericTableState> {\r\n\tconstructor(props: GenericTableProperties<T>) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tcurrentPage: 0,\r\n\t\t\torder: {},\r\n\t\t};\r\n\t\tthis.pageBounds = this.pageBounds.bind(this);\r\n\t}\r\n\r\n\tprivate pageBounds(pageNumber: number, rowCount: number): [number, number] {\r\n\t\tconst lowerBound = pageNumber * this.props.entriesPerPage;\r\n\t\tconst upperBound = (pageNumber + 1) * this.props.entriesPerPage;\r\n\t\treturn [lowerBound, Math.min(upperBound, rowCount)];\r\n\t}\r\n\r\n\tprivate sortByOrderObject(\r\n\t\trows: T[],\r\n\t\tcolumns: GenericColumn<T>[],\r\n\t\torder: { [colId: string]: { priority: number; direction: \"asc\" | \"desc\" } }\r\n\t) {\r\n\t\tlet sortedRows = rows;\r\n\t\tObject.entries(order)\r\n\t\t\t.sort((a, b) => b[1].priority - a[1].priority)\r\n\t\t\t.forEach(([key, order]) => {\r\n\t\t\t\tsortedRows.sort((a, b) => {\r\n\t\t\t\t\tconst column = columns.find((c) => c.id === key);\r\n\t\t\t\t\tif (!column) throw Error(\"col not found\");\r\n\t\t\t\t\tif (typeof column.sort === \"function\") return order.direction === \"asc\" ? column.sort(a,b) : column.sort(b,a);\r\n\t\t\t\t\tconst valA = typeof column.data === \"function\" ? column.data(a) : a[column.data];\r\n\t\t\t\t\tconst valB = typeof column.data === \"function\" ? column.data(b) : b[column.data];\r\n\t\t\t\t\tlet comparisonResult = 0;\r\n\t\t\t\t\tif (valA > valB) comparisonResult = 1;\r\n\t\t\t\t\telse if (valB > valA) comparisonResult = -1;\r\n\t\t\t\t\telse return 0;\r\n\t\t\t\t\tif (order.direction === \"asc\") return comparisonResult;\r\n\t\t\t\t\treturn comparisonResult * -1;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\treturn sortedRows;\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst [lowerBound, upperBound] = this.pageBounds(this.state.currentPage, this.props.rows.length);\r\n\t\tconst cols: GenericColumn<T>[] = [];\r\n\t\tif (\r\n\t\t\tthis.props.selectable === true &&\r\n\t\t\ttypeof this.props.addSelected === \"function\" &&\r\n\t\t\ttypeof this.props.removeSelected === \"function\"\r\n\t\t) {\r\n\t\t\tcols.push({\r\n\t\t\t\tdata: (row) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\t\t\t\tif (this.props.addSelected == null || this.props.removeSelected == null) return;\r\n\t\t\t\t\t\t\t\tif (evt.target.checked) this.props.addSelected(row);\r\n\t\t\t\t\t\t\t\telse this.props.removeSelected(row);\r\n\t\t\t\t\t\t\t}}></Checkbox>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tid: \"col_check\",\r\n\t\t\t\tname: \"\",\r\n\t\t\t\torderable: false,\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\tsort: () => 0\r\n\t\t\t});\r\n\t\t}\r\n\t\tcols.push(...this.props.columns);\r\n\t\tconst headerCells = cols.map((col, _, arr) => {\r\n\t\t\treturn !col.orderable ? (\r\n\t\t\t\t<TableCell align={col.align ?? \"left\"} key={v4()}>\r\n\t\t\t\t\t{col.name}\r\n\t\t\t\t</TableCell>\r\n\t\t\t) : (\r\n\t\t\t\t<TableCell\r\n\t\t\t\t\talign={col.align ?? \"left\"}\r\n\t\t\t\t\tkey={v4()}\r\n\t\t\t\t\tsortDirection={\r\n\t\t\t\t\t\tcol.orderable && this.state.order[col.id] != null\r\n\t\t\t\t\t\t\t? this.state.order[col.id].direction\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t<TableSortLabel\r\n\t\t\t\t\t\t\tkey={v4()}\r\n\t\t\t\t\t\t\tactive={col.orderable && col.id in this.state.order}\r\n\t\t\t\t\t\t\tdirection={\r\n\t\t\t\t\t\t\t\tcol.orderable && this.state.order[col.id] != null\r\n\t\t\t\t\t\t\t\t\t? this.state.order[col.id].direction\r\n\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tonClick={(evt) => {\r\n\t\t\t\t\t\t\t\tif (!col.orderable) return;\r\n\t\t\t\t\t\t\t\tconst order = this.state.order;\r\n\t\t\t\t\t\t\t\tif (!evt.shiftKey)\r\n\t\t\t\t\t\t\t\t\tarr.forEach((c) => {\r\n\t\t\t\t\t\t\t\t\t\tif (c.id !== col.id) delete order[c.id];\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif (col.id in order) {\r\n\t\t\t\t\t\t\t\t\tswitch (order[col.id].direction) {\r\n\t\t\t\t\t\t\t\t\t\tcase \"asc\":\r\n\t\t\t\t\t\t\t\t\t\t\torder[col.id].direction = \"desc\";\r\n\t\t\t\t\t\t\t\t\t\t\torder[col.id].priority = Date.now();\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase \"desc\":\r\n\t\t\t\t\t\t\t\t\t\t\tdelete order[col.id];\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\torder[col.id] = { direction: \"asc\", priority: Date.now() };\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.setState({ order: this.state.order });\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{col.name}\r\n\t\t\t\t\t\t</TableSortLabel>\r\n\t\t\t\t\t}\r\n\t\t\t\t</TableCell>\r\n\t\t\t);\r\n\t\t});\r\n\t\tconst tableRows = this.sortByOrderObject(this.props.rows, cols, this.state.order)\r\n\t\t\t.slice(lowerBound, upperBound)\r\n\t\t\t.map((row) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<TableRow key={v4()}>\r\n\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\tconst cells = cols.map((col) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<TableCell key={v4()} align={col.align ?? \"left\"}>\r\n\t\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (typeof col.data === \"function\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn col.data(row);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn row[col.data];\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (this.props.actions != null) {\r\n\t\t\t\t\t\t\t\tcells.push(\r\n\t\t\t\t\t\t\t\t\t<TableCell key={v4()} align=\"right\" style={{ padding: \"4px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t{this.props.actions.map((action) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={v4()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taction.handle(row);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{<action.icon size=\".75em\"></action.icon>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn cells;\r\n\t\t\t\t\t\t})()}\r\n\t\t\t\t\t</TableRow>\r\n\t\t\t\t);\r\n\t\t\t});\r\n\r\n\t\tif (this.props.actions != null) {\r\n\t\t\theaderCells.push(\r\n\t\t\t\t<TableCell key=\"col_actions\" align=\"right\">\r\n\t\t\t\t\tAktionen\r\n\t\t\t\t</TableCell>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<TableContainer\r\n\t\t\t\tcomponent={Paper}\r\n\t\t\t\televation={0}\r\n\t\t\t\tstyle={{ display: this.props.rows.length > 0 ? \"block\" : \"none\" }}>\r\n\t\t\t\t<Table>\r\n\t\t\t\t\t<TableHead>\r\n\t\t\t\t\t\t<TableRow>{headerCells}</TableRow>\r\n\t\t\t\t\t</TableHead>\r\n\t\t\t\t\t<TableBody>{tableRows}</TableBody>\r\n\t\t\t\t\t{this.props.rows.length > this.props.entriesPerPage ? (\r\n\t\t\t\t\t\t<TableFooter>\r\n\t\t\t\t\t\t\t<TableRow>\r\n\t\t\t\t\t\t\t\t<TablePagination\r\n\t\t\t\t\t\t\t\t\tcount={this.props.rows.length}\r\n\t\t\t\t\t\t\t\t\trowsPerPage={this.props.entriesPerPage}\r\n\t\t\t\t\t\t\t\t\trowsPerPageOptions={[]}\r\n\t\t\t\t\t\t\t\t\tpage={this.state.currentPage}\r\n\t\t\t\t\t\t\t\t\tonPageChange={(_, pageNumber) => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({ currentPage: pageNumber });\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t</TableFooter>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</Table>\r\n\t\t\t</TableContainer>\r\n\t\t);\r\n\t}\r\n}\r\n","import { Dictionary } from \"@reduxjs/toolkit\";\r\nimport React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Transaction, User } from \"../../entities/entities\";\r\nimport { usersAdapter } from \"../../redux/reducers/users\";\r\nimport { AppDispatch, AppState } from \"../../redux/store\";\r\nimport { GenericTable } from \"../common/genericTable\";\r\nimport { Balance } from \"../common/currency\";\r\nimport { BsTrashFill } from \"react-icons/bs\";\r\nimport { transactionsSlice } from \"../../redux/reducers/transactions\";\r\nexport type TransactionTableProps = {\r\n\ttransactions: Transaction[];\r\n};\r\nexport const TransactionTable = (props: TransactionTableProps) => {\r\n\tconst users = useSelector<AppState>((state) =>\r\n\t\tusersAdapter.getSelectors<AppState>((state) => state.users).selectEntities(state)\r\n\t) as Dictionary<User>;\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<GenericTable<Transaction>\r\n\t\t\t\tcolumns={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: (r) => <Link to={\"/zsku-mgmt/transactions/\" + r.id}>{r.name}</Link>,\r\n\t\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => a.name.localeCompare(b.name),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: (r) => <div title={r.description}>{r.description.substr(0, 50)}</div>,\r\n\t\t\t\t\t\tid: \"col_description\",\r\n\t\t\t\t\t\tname: \"Beschreibung\",\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: (r) => {\r\n\t\t\t\t\t\t\tconst user = users[r.userId];\r\n\t\t\t\t\t\t\tif (user == null) return <p>N/A</p>;\r\n\t\t\t\t\t\t\treturn <Link to={\"/zsku-mgmt/users/\" + user.id}>{user.fullName}</Link>;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tid: \"col_user\",\r\n\t\t\t\t\t\tname: \"Mitglied\",\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => {\r\n\t\t\t\t\t\t\tconst userA = users[a.userId];\r\n\t\t\t\t\t\t\tconst userB = users[b.userId];\r\n\t\t\t\t\t\t\tif (userA == null || userB == null) return 0;\r\n\t\t\t\t\t\t\treturn userA.fullName.localeCompare(userB.fullName);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: (r) => <Balance val={r.value}></Balance>,\r\n\t\t\t\t\t\tid: \"col_value\",\r\n\t\t\t\t\t\tname: \"Betrag\",\r\n\t\t\t\t\t\talign: \"right\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => a.value - b.value,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdata: (r) => new Date(r.createdOn).toLocaleDateString(\"de-DE\"),\r\n\t\t\t\t\t\tid: \"col_timestamp\",\r\n\t\t\t\t\t\tname: \"Erstellt am\",\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => a.createdOn - b.createdOn,\r\n\t\t\t\t\t},\r\n\t\t\t\t]}\r\n\t\t\t\tentriesPerPage={8}\r\n\t\t\t\trows={props.transactions}\r\n\t\t\t\tactions={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ticon: BsTrashFill,\r\n\t\t\t\t\t\thandle: (row) => {\r\n\t\t\t\t\t\t\tdispatch(transactionsSlice.actions.delete(row.id));\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t]}\r\n\t\t\t></GenericTable>\r\n\t\t</div>\r\n\t);\r\n};\r\n","import { Avatar, Button, Paper } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport { Transaction, User } from \"../../entities/entities\";\r\nimport { transactionsAdapter, transactionsSlice } from \"../../redux/reducers/transactions\";\r\nimport { usersAdapter } from \"../../redux/reducers/users\";\r\nimport { AppDispatch, AppState } from \"../../redux/store\";\r\nimport { Balance } from \"../common/currency\";\r\nimport { TransactionTable } from \"./transactionsTable\";\r\n\r\nconst Ledgers = withRouter((history) => {\r\n\tconst transactions = useSelector<AppState>((state) =>\r\n\t\ttransactionsAdapter.getSelectors().selectAll(state.transactions)\r\n\t) as Transaction[];\r\n\tconst usersArray = useSelector<AppState>((state) =>\r\n\t\tusersAdapter\r\n\t\t\t.getSelectors()\r\n\t\t\t.selectAll(state.users)\r\n\t\t\t.filter((u) => u.deleted !== true)\r\n\t) as User[];\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\treturn (\r\n\t\t<div className=\"ledgerContainer\">\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t<h1>Kassenstand</h1>\r\n\t\t\t\t\t\t<Balance\r\n\t\t\t\t\t\t\tval={transactions\r\n\t\t\t\t\t\t\t\t.filter((t) => t.affectsGlobalLedger)\r\n\t\t\t\t\t\t\t\t.reduce((agg, next) => agg + next.value, 0)}></Balance>\r\n\t\t\t\t\t\t<Link to=\"/zsku-mgmt/transactions/new\">\r\n\t\t\t\t\t\t\t<Button>Auerplanmige Transaktion hinzufgen</Button>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<TransactionTable\r\n\t\t\t\t\t\ttransactions={transactions.filter((t) => t.affectsGlobalLedger)}></TransactionTable>\r\n\t\t\t\t</Paper>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"cardGrid\">\r\n\t\t\t\t{usersArray.map((user) => {\r\n\t\t\t\t\tconst balance = transactions.reduce(\r\n\t\t\t\t\t\t(agg, next) => agg + (next.userId === user.id ? next.value : 0),\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tstyle={{ cursor: \"pointer\" }}\r\n\t\t\t\t\t\t\tkey={\"userLedger_\" + user.id}\r\n\t\t\t\t\t\t\tclassName=\"card zsku-panel\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\thistory.history.push(\"/zsku-mgmt/users/\" + user.id);\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<Paper elevation={3} style={{ padding: \"2em\", position: \"relative\" }}>\r\n\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: user.color,\r\n\t\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\t\ttop: \"1em\",\r\n\t\t\t\t\t\t\t\t\t\tright: \"1em\",\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{user.abbreviation}\r\n\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t\t\t\t<h1 style={{ marginLeft: \"0\" }}>{user.fullName}</h1>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div style={{ display: \"flex\", alignItems: \"center\", width: \"100%\" }}>\r\n\t\t\t\t\t\t\t\t\t<p style={{ marginRight: \"1em\" }}>Kontostand</p>\r\n\t\t\t\t\t\t\t\t\t<Balance val={balance}></Balance>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{balance < 0 && (\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ float: \"right\", bottom: \"1em\" }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\tconst tId = v4();\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\t\t\t\t\t\t\ttransactionsSlice.actions.create({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: tId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taffectsGlobalLedger: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taffectsUserLedger: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"TRANS-\" + transactions.length.toString().padStart(4, \"0\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpenalties: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuserId: user.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: balance * -1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdescription: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\thistory.history.push(\"/zsku-mgmt/transactions/\" + tId);\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\tBegleichen\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n});\r\nexport default Ledgers;\r\n","import { createEntityAdapter, createSlice, PayloadAction, Update } from \"@reduxjs/toolkit\";\r\nimport { FeeType } from \"../../entities/entities\";\r\nimport { db } from \"../Database\";\r\nimport _ from \"lodash\";\r\n// const defaultState: FeeType[] = [\r\n// \t\t{ label: \"Brechen auf der Bahn\", value: 25, createdOn: new Date().valueOf(), id: \"1\" },\r\n// \t\t{ label: \"Diskutieren\", value: 0.01, createdOn: new Date().valueOf(), id: \"2\" },\r\n// \t\t{ label: \"Fluchen\", value: 0.01, createdOn: new Date().valueOf(), id: \"3\" },\r\n// \t\t{ label: \"Alle Neune\", value: 0.2, createdOn: new Date().valueOf(), id: \"4\" },\r\n// \t\t{ label: \"Gosse\", value: 0.3, createdOn: new Date().valueOf(), id: \"5\" },\r\n// \t];\r\n\r\nconst feeTypesAdapter = createEntityAdapter<FeeType>();\r\nconst feeTypesSlice = createSlice({\r\n\tinitialState: feeTypesAdapter.getInitialState(),\r\n\tname: \"feeTypes\",\r\n\treducers: {\r\n\t\t// create: feeTypesAdapter.addOne,\r\n\t\tcreate(state, action: PayloadAction<FeeType>) {\r\n\t\t\tstate.ids.push(action.payload.id);\r\n\t\t\tstate.entities[action.payload.id] = action.payload;\r\n\t\t\tdb.feeTypes.put(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdelete(state, action: PayloadAction<string>) {\r\n\t\t\tconst ft = state.entities[action.payload];\r\n\t\t\tif (ft == null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tft.deleted = true;\r\n\t\t\tdb.feeTypes.update(action.payload, { deleted: true });\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tset(state, action: PayloadAction<FeeType[]>) {\r\n\t\t\tstate.ids = action.payload.map((ft) => ft.id);\r\n\t\t\tstate.entities = {};\r\n\t\t\tfor (const ft of action.payload) {\r\n\t\t\t\tstate.entities[ft.id] = ft;\r\n\t\t\t}\r\n\t\t\tdb.feeTypes.clear().then(() => {\r\n\t\t\t\tdb.feeTypes.bulkPut(action.payload);\r\n\t\t\t});\r\n\t\t},\r\n\t\tupdate(state, action: PayloadAction<Update<FeeType>>) {\r\n\t\t\tstate.entities[action.payload.id] = _.merge(state.entities[action.payload.id], action.payload.changes);\r\n\t\t\tdb.feeTypes.update(action.payload.id as string, action.payload.changes);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport { feeTypesSlice, feeTypesAdapter };\r\n","import TextField from \"@material-ui/core/TextField/TextField\";\r\nimport { TextFieldProps } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport NumberFormat from \"react-number-format\";\r\ninterface NumberFormatCustomProps {\r\n\tinputRef: (instance: NumberFormat | null) => void;\r\n\tonChange: (event: { target: { name: string; value: string } }) => void;\r\n\tname: string;\r\n}\r\n\r\nconst NumberFormatCustom = (props: NumberFormatCustomProps) => {\r\n\tconst { inputRef, onChange, ...other } = props;\r\n\r\n\treturn (\r\n\t\t<NumberFormat\r\n\t\t\t{...other}\r\n\t\t\tgetInputRef={inputRef}\r\n\t\t\tonValueChange={(values) => {\r\n\t\t\t\tonChange({\r\n\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\tname: props.name,\r\n\t\t\t\t\t\tvalue: values.value,\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t\tthousandSeparator=\".\"\r\n\t\t\tdecimalSeparator=\",\"\r\n\t\t\tisNumericString\r\n\t\t\tfixedDecimalScale\r\n\t\t\tdecimalScale={2}\r\n\t\t\tallowedDecimalSeparators={[\",\", \".\"]}\r\n\t\t\tallowNegative\r\n\t\t\tallowLeadingZeros\r\n\t\t\tprefix=\"\"\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport const CurrencyField = ({ value, onChange, ...other }: Partial<TextFieldProps>) => {\r\n\treturn (\r\n\t\t<TextField\r\n            variant=\"outlined\"\r\n            InputProps={{\r\n\t\t\t\tstartAdornment: \"\",\r\n                inputComponent: NumberFormatCustom as any,\r\n\t\t\t}}\r\n\t\t\tvalue={value}\r\n            onChange={onChange}\r\n            {...other}\r\n\t\t/>\r\n\t);\r\n};\r\n","import { Button, FormControl, MenuItem, Paper, Select, Switch, TextField } from \"@material-ui/core\";\r\nimport { Dictionary, EntityState } from \"@reduxjs/toolkit\";\r\nimport { useFormik } from \"formik\";\r\nimport React from \"react\";\r\nimport { FaExchangeAlt } from \"react-icons/fa\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, RouteComponentProps, useHistory, withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport * as yup from \"yup\";\r\nimport { FeeType, Penalty, Transaction, User } from \"../../entities/entities\";\r\nimport { feeTypesAdapter } from \"../../redux/reducers/feeTypes\";\r\nimport { transactionsAdapter, transactionsSlice } from \"../../redux/reducers/transactions\";\r\nimport { AppDispatch, AppState } from \"../../redux/store\";\r\nimport * as colors from \"../common/colors\";\r\nimport { Currency } from \"../common/currency\";\r\nimport { CurrencyField } from \"../common/currencyField\";\r\nimport { GenericTable } from \"../common/genericTable\";\r\ninterface RouterParams {\r\n\ttransactionId: string;\r\n\tuserId?: string;\r\n}\r\n\r\ntype FeeTypeAggregate = { id: string; feeType: string; value: number; count: number };\r\n\r\ntype TransactionFormValues = {\r\n\tvalue: number;\r\n\tuser: string;\r\n\tdescription: string;\r\n\taffectsGlobalLedger: boolean;\r\n};\r\nconst TransactionForm = withRouter((router: RouteComponentProps<RouterParams>) => {\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\tconst history = useHistory();\r\n\tconst validationSchema = yup.object({\r\n\t\tvalue: yup.number().required().notOneOf([0]),\r\n\t});\r\n\r\n\tconst users = useSelector<AppState>((state) => state.users) as EntityState<User>;\r\n\tconst feeTypes = useSelector<AppState>((state) =>\r\n\t\tfeeTypesAdapter.getSelectors<AppState>((state) => state.feeTypes).selectEntities(state)\r\n\t) as Dictionary<FeeType>;\r\n\r\n\tconst transaction = useSelector<AppState>((state) =>\r\n\t\ttransactionsAdapter\r\n\t\t\t.getSelectors<AppState>((state) => state.transactions)\r\n\t\t\t.selectById(state, router.match.params.transactionId)\r\n\t) as Transaction;\r\n\tconst transactionCount = useSelector<AppState>((state) =>\r\n\t\ttransactionsAdapter.getSelectors().selectTotal(state.transactions)\r\n\t) as number;\r\n\tconst transactionPenalties = useSelector<AppState>((state) =>\r\n\t\t(transaction?.penalties ?? []).map((p) => state.penalties.entities[p])\r\n\t) as Penalty[];\r\n\tlet countedPenalties = Object.values(\r\n\t\ttransactionPenalties.reduce<{ [id: string]: FeeTypeAggregate }>((agg, penalty) => {\r\n\t\t\tconst feeType = penalty && feeTypes[penalty.feeTypeId];\r\n\t\t\tif (agg[penalty.id] == null) {\r\n\t\t\t\tagg[penalty.id] = {\r\n\t\t\t\t\tcount: 0,\r\n\t\t\t\t\tfeeType: feeType?.label ?? \"Custom\",\r\n\t\t\t\t\tid: feeType?.id ?? penalty.id,\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tagg[penalty.id].count++;\r\n\t\t\tagg[penalty.id].value += penalty?.value ?? 0;\r\n\t\t\treturn agg;\r\n\t\t}, {})\r\n\t);\r\n\r\n\tconst formik = useFormik<TransactionFormValues>({\r\n\t\tinitialValues: {\r\n\t\t\tdescription: transaction?.description ?? \"\",\r\n\t\t\tuser: transaction?.userId ?? router.match.params.userId,\r\n\t\t\tvalue: transaction?.value ?? 0,\r\n\t\t\taffectsGlobalLedger: true,\r\n\t\t},\r\n\t\tvalidationSchema,\r\n\r\n\t\tonSubmit: (values, { setSubmitting, resetForm }) => {\r\n\t\t\tconst isNewTransaction = router.match.params.transactionId === \"new\";\r\n\t\t\tif (isNewTransaction) {\r\n\t\t\t\tconst newTransactionId = v4();\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\ttransactionsSlice.actions.create({\r\n\t\t\t\t\t\taffectsGlobalLedger: values.affectsGlobalLedger,\r\n\t\t\t\t\t\taffectsUserLedger: !!router.match.params.userId,\r\n\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\tdescription: values.description,\r\n\t\t\t\t\t\tid: newTransactionId,\r\n\t\t\t\t\t\tname: \"TRANS-\" + (transactionCount + 1).toString().padStart(4, \"0\"),\r\n\t\t\t\t\t\tuserId: values.user,\r\n\t\t\t\t\t\tvalue: parseFloat(values.value.toString()),\r\n\t\t\t\t\t\tpenalties: [],\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\tsetSubmitting(false);\r\n\t\t\t\thistory.push(\"/zsku-mgmt/transactions/\" + newTransactionId);\r\n\t\t\t} else {\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\ttransactionsSlice.actions.update({\r\n\t\t\t\t\t\tid: transaction.id,\r\n\t\t\t\t\t\tchanges: {\r\n\t\t\t\t\t\t\tdescription: values.description,\r\n\t\t\t\t\t\t\tvalue: parseFloat(values.value.toString()),\r\n\t\t\t\t\t\t\tuserId: values.user,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\tsetSubmitting(false);\r\n\t\t\t\tresetForm({\r\n\t\t\t\t\tvalues: values,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n\treturn (\r\n\t\t<div className=\"zsku-panel\">\r\n\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>{transaction?.name ?? \"Neue Transaktion\"}</h1>\r\n\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t<FaExchangeAlt size=\"4em\" style={{ backgroundColor: colors.yellow }} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form onSubmit={formik.handleSubmit}>\r\n\t\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t\t{(router.match.params.userId != null ||\r\n\t\t\t\t\t\t\t(transaction?.userId != null && transactionPenalties.length === 0)) && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<h4>Betrifft Kasse</h4>\r\n\t\t\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t\t\t<Switch\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\tchecked={formik.values.affectsGlobalLedger}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\tformik.setFieldValue(\"affectsGlobalLedger\", e.target.checked)\r\n\t\t\t\t\t\t\t\t\t\t}></Switch>\r\n\t\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<h4>Betrag</h4>\r\n\t\t\t\t\t\t<CurrencyField\r\n\t\t\t\t\t\t\tdisabled={transaction?.penalties.length > 0}\r\n\t\t\t\t\t\t\terror={formik.touched.value && Boolean(formik.errors.value)}\r\n\t\t\t\t\t\t\thelperText={formik.touched.value && formik.errors.value}\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tvalue={formik.values.value}\r\n\t\t\t\t\t\t\tname=\"Value\"\r\n\t\t\t\t\t\t\tid=\"value\"\r\n\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\tonChange={(e) => formik.setFieldValue(\"value\", (e.target as any).value)}></CurrencyField>\r\n\r\n\t\t\t\t\t\t{(router.match.params.userId != null || transaction?.affectsUserLedger === true) && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<h4>Mitglied</h4>\r\n\t\t\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\terror={formik.touched.user && Boolean(formik.errors.user)}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\t\t\ttransaction?.affectsGlobalLedger === false ||\r\n\t\t\t\t\t\t\t\t\t\t\trouter.match.params.transactionId !== \"new\" ||\r\n\t\t\t\t\t\t\t\t\t\t\trouter.match.params.userId != null\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={formik.values.user}\r\n\t\t\t\t\t\t\t\t\t\titemType=\"string\"\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tformik.setFieldValue(\"user\", (e.target.value as number).toString());\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\trenderValue={(userId) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn userId == null ? null : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tto={\"/zsku-mgmt/users/\" + userId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonMouseDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{users.entities[userId as string]?.fullName}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t{users.ids.map((userId) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<MenuItem key={\"user_\" + userId} value={userId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{users.entities[userId]?.fullName}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<h4>Beschreibung</h4>\r\n\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\terror={formik.touched.description && Boolean(formik.errors.description)}\r\n\t\t\t\t\t\t\t\thelperText={formik.touched.description && formik.errors.description}\r\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\t\t\tid=\"description\"\r\n\t\t\t\t\t\t\t\tmultiline\r\n\t\t\t\t\t\t\t\tvalue={formik.values.description}\r\n\t\t\t\t\t\t\t\tonChange={formik.handleChange}></TextField>\r\n\t\t\t\t\t\t</FormControl>\r\n\r\n\t\t\t\t\t\t{transaction != null && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<h4>Erstellt am</h4>\r\n\t\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tname=\"createdOn\"\r\n\t\t\t\t\t\t\t\t\tid=\"createdOn\"\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tvalue={new Date(transaction.createdOn).toLocaleDateString(\"de-DE\")}></TextField>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div className=\"gridSpacer\"></div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<FormControl style={{ float: \"right\" }}>\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\tid=\"formSubmit\"\r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}>\r\n\t\t\t\t\t\t\t\t\tSpeichern\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\r\n\t\t\t\t{countedPenalties.length > 0 ? (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<GenericTable<FeeTypeAggregate>\r\n\t\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_feeType\",\r\n\t\t\t\t\t\t\t\t\tname: \"Strafe\",\r\n\t\t\t\t\t\t\t\t\tdata: (r) => r.feeType,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_value\",\r\n\t\t\t\t\t\t\t\t\tname: \"Gesamtbetrag\",\r\n\t\t\t\t\t\t\t\t\tdata: (r) => <Currency val={r.value}></Currency>,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_count\",\r\n\t\t\t\t\t\t\t\t\tname: \"Anzahl\",\r\n\t\t\t\t\t\t\t\t\tdata: \"count\",\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\tentriesPerPage={10}\r\n\t\t\t\t\t\t\trows={countedPenalties}></GenericTable>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : null}\r\n\t\t\t</Paper>\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport default TransactionForm;\r\n","import { createEntityAdapter, createSlice, PayloadAction, Update } from \"@reduxjs/toolkit\";\r\nimport _ from \"lodash\";\r\nimport { Penalty } from \"../../entities/entities\";\r\nimport { db } from \"../Database\";\r\n\r\nconst penaltiesAdapter = createEntityAdapter<Penalty>();\r\nconst penaltiesSlice = createSlice({\r\n\tinitialState: penaltiesAdapter.getInitialState(),\r\n\tname: \"penalties\",\r\n\treducers: {\r\n\t\tcreate(state, action: PayloadAction<Penalty>) {\r\n\t\t\tstate.ids.push(action.payload.id);\r\n\t\t\tstate.entities[action.payload.id] = action.payload;\r\n\t\t\tdb.penalties.put(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tcreateMultiple(state, action: PayloadAction<Penalty[]>) {\r\n\t\t\tstate.ids.push(...action.payload.map((p) => p.id));\r\n\t\t\tfor (const penalty of action.payload) {\r\n\t\t\t\tstate.entities[penalty.id] = penalty;\r\n\t\t\t}\r\n\t\t\tdb.penalties.bulkPut(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdelete(state, action: PayloadAction<string>) {\r\n\t\t\tstate.ids = state.ids.filter((id) => id !== action.payload);\r\n\t\t\tdelete state.entities[action.payload];\r\n\t\t\tdb.penalties.delete(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdeleteMultiple(state, action: PayloadAction<string[]>) {\r\n\t\t\tstate.ids = state.ids.filter((id) => action.payload.findIndex((del) => id !== del));\r\n\t\t\tfor (const del of action.payload) {\r\n\t\t\t\tdelete state.entities[del];\r\n\t\t\t}\r\n\t\t\tdb.penalties.bulkDelete(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tset(state, action: PayloadAction<Penalty[]>) {\r\n\t\t\tstate.ids = action.payload.map((ft) => ft.id);\r\n\t\t\tstate.entities = {};\r\n\t\t\tfor (const ft of action.payload) {\r\n\t\t\t\tstate.entities[ft.id] = ft;\r\n\t\t\t}\r\n\t\t\tdb.penalties.clear().then(() => {\r\n\t\t\t\tdb.penalties.bulkPut(action.payload);\r\n\t\t\t});\r\n\t\t},\r\n\t\tupdate(state, action: PayloadAction<Update<Penalty>>) {\r\n\t\t\tstate.entities[action.payload.id] = _.merge(state.entities[action.payload.id], action.payload.changes);\r\n\t\t\tdb.penalties.update(action.payload.id as string, action.payload.changes);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\nexport { penaltiesAdapter, penaltiesSlice };\r\n","import { createEntityAdapter, createSlice, PayloadAction, Update } from \"@reduxjs/toolkit\";\r\nimport _ from \"lodash\";\r\nimport { Role } from \"../../entities/entities\";\r\nimport { db } from \"../Database\";\r\n\r\nconst rolesAdapter = createEntityAdapter<Role>();\r\nconst rolesSlice = createSlice({\r\n\tinitialState: rolesAdapter.getInitialState(),\r\n\tname: \"roles\",\r\n\treducers: {\r\n\t\tcreate(state, action: PayloadAction<Role>) {\r\n\t\t\tstate.ids.push(action.payload.id);\r\n\t\t\tstate.entities[action.payload.id] = action.payload;\r\n\t\t\tdb.roles.put(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tdelete(state, action: PayloadAction<string>) {\r\n\t\t\tstate.ids = state.ids.filter((id) => id !== action.payload);\r\n\t\t\tdelete state.entities[action.payload];\r\n\t\t\tdb.roles.delete(action.payload);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tset(state, action: PayloadAction<Role[]>) {\r\n\t\t\tstate.ids = action.payload.map((ft) => ft.id);\r\n\t\t\tstate.entities = {};\r\n\t\t\tfor (const ft of action.payload) {\r\n\t\t\t\tstate.entities[ft.id] = ft;\r\n\t\t\t}\r\n\t\t\tdb.roles.clear().then(() => db.roles.bulkPut(action.payload));\r\n\t\t},\r\n\t\tupdate(state, action: PayloadAction<Update<Role>>) {\r\n\t\t\tstate.entities[action.payload.id] = _.merge(state.entities[action.payload.id], action.payload.changes);\r\n\t\t\tdb.roles.update(action.payload.id as string, action.payload.changes);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport { rolesSlice, rolesAdapter };\r\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { v4 } from \"uuid\";\r\nimport { Game, User } from \"../../entities/entities\";\r\nimport { db } from \"../Database\";\r\nimport { AppState } from \"../store\";\r\nimport { penaltiesAdapter } from \"./penalties\";\r\nconst gameSelectors = {\r\n\topenGame: (state: AppState) => state.games.entities[state.games.openGame],\r\n\tgameById: (state: AppState, id: string) => state.games.entities[id],\r\n\tclosedGames: (state: AppState) =>\r\n\t\tstate.games.ids.filter((id) => id !== state.games.openGame).map((id) => state.games.entities[id]),\r\n\tallGames: (state: AppState) => state.games.ids.map((id) => state.games.entities[id]),\r\n\tplayers: (gameId: string) => (state: AppState) =>\r\n\t\tstate.games.entities[gameId]?.users\r\n\t\t\t.map((usr) => state.users.entities[usr])\r\n\t\t\t.sort((a, b) => (a as User).fullName.localeCompare((b as User).fullName)),\r\n\tplayerPenalties: (gameId: string, playerId: string) => (state: AppState) =>\r\n\t\tpenaltiesAdapter\r\n\t\t\t.getSelectors()\r\n\t\t\t.selectAll(state.penalties)\r\n\t\t\t.filter((p) => p.userId === playerId && p.gameId === gameId),\r\n\tpenalties: (gameId: string) => (state: AppState) =>\r\n\t\tpenaltiesAdapter\r\n\t\t\t.getSelectors()\r\n\t\t\t.selectAll(state.penalties)\r\n\t\t\t.filter((p) => p.gameId === gameId),\r\n};\r\nconst gamesSlice = createSlice({\r\n\tinitialState: { ids: [], entities: {}, openGame: \"\" } as {\r\n\t\tids: string[];\r\n\t\tentities: { [id: string]: Game };\r\n\t\topenGame: string;\r\n\t},\r\n\tname: \"games\",\r\n\treducers: {\r\n\t\tcreateGame(state) {\r\n\t\t\tconst newGame: Game = {\r\n\t\t\t\tid: v4(),\r\n\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\tstatus: \"open\",\r\n\t\t\t\tname: `SPIEL-${(state.ids.length + 1).toString().padStart(4, \"0\")}`,\r\n\t\t\t\tusers: [],\r\n\t\t\t};\r\n\t\t\tstate.ids.push(newGame.id);\r\n\t\t\tstate.entities[newGame.id] = newGame;\r\n\t\t\tstate.openGame = newGame.id;\r\n\t\t\tdb.games.put(newGame);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tfinishGame(state) {\r\n\t\t\tconst openGame = state.openGame;\r\n\t\t\tif (!openGame) return state;\r\n\t\t\tconst game = state.entities[state.openGame];\r\n\t\t\tif (game.users.length === 0) return state;\r\n\t\t\tgame.status = \"closed\";\r\n\t\t\tstate.openGame = \"\";\r\n\t\t\tdb.games.update(openGame, { status: \"closed\" });\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tabortGame(state) {\r\n\t\t\tconst openGame = state.openGame;\r\n\t\t\tif (!openGame) return state;\r\n\t\t\tstate.ids = state.ids.filter((g) => g !== openGame);\r\n\t\t\tdelete state.entities[openGame];\r\n\t\t\tdb.games.delete(openGame);\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tsetGames(state, action: PayloadAction<Game[]>) {\r\n\t\t\tstate.ids = action.payload.map((g) => g.id);\r\n\t\t\tstate.entities = action.payload.reduce((agg, next) => {\r\n\t\t\t\tagg[next.id] = next;\r\n\t\t\t\tif (next.status === \"open\") state.openGame = next.id;\r\n\t\t\t\treturn agg;\r\n\t\t\t}, {} as { [id: string]: Game });\r\n\t\t\tdb.games.clear().then(() => {\r\n\t\t\t\tdb.games.bulkPut(action.payload);\r\n\t\t\t});\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\taddPlayerToOpenGame(state, action: PayloadAction<{ userId: string }>) {\r\n\t\t\tconst openGame = state.entities[state.openGame];\r\n\t\t\tif (openGame == null) return;\r\n\t\t\topenGame.users.push(action.payload.userId);\r\n\t\t\tdb.games.update(state.openGame, { \"users\": [...openGame.users] });\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tremovePlayerFromGame(state, action: PayloadAction<{ userId: string }>) {\r\n\t\t\tconst openGame = state.entities[state.openGame];\r\n\t\t\tif (openGame == null) return;\r\n\t\t\topenGame.users = openGame.users.filter((u) => u !== action.payload.userId);\r\n\t\t\tdb.games.update(state.openGame, { users: [...openGame.users] });\r\n\t\t\treturn state;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport { gamesSlice, gameSelectors };\r\n\r\n","import { Button, Paper } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport * as colors from \"../common/colors\";\r\nimport { MdImportExport } from \"react-icons/md\";\r\nimport { db } from \"../../redux/Database\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { AppDispatch } from \"../../redux/store\";\r\nimport { usersSlice } from \"../../redux/reducers/users\";\r\nimport { penaltiesSlice } from \"../../redux/reducers/penalties\";\r\nimport { transactionsSlice } from \"../../redux/reducers/transactions\";\r\nimport { rolesSlice } from \"../../redux/reducers/roles\";\r\nimport { feeTypesSlice } from \"../../redux/reducers/feeTypes\";\r\nimport { gamesSlice } from \"../../redux/reducers/games\";\r\nexport const DataManagement = () => {\r\n\treturn (\r\n\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t<div className=\"usersMain settingszsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>Datenmanagement</h1>\r\n\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t<MdImportExport size=\"4em\" style={{ backgroundColor: colors.green }} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<IndexedDBExport></IndexedDBExport>\r\n\t\t\t\t\t<IndexedDBImport></IndexedDBImport>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Paper>\r\n\t);\r\n};\r\n\r\nconst IndexedDBExport = () => {\r\n\tconst download = async () => {\r\n\t\tconst users = await db.users.toArray();\r\n\t\tconst roles = await db.roles.toArray();\r\n\t\tconst penalties = await db.penalties.toArray();\r\n\t\tconst transactions = await db.transactions.toArray();\r\n\t\tconst feeTypes = await db.feeTypes.toArray();\r\n\t\tconst games = await db.games.toArray();\r\n\t\tconst exportDB = {\r\n\t\t\tusers,\r\n\t\t\troles,\r\n\t\t\tpenalties,\r\n\t\t\ttransactions,\r\n\t\t\tfeeTypes,\r\n\t\t\tgames,\r\n\t\t};\r\n\t\tconst data = JSON.stringify(exportDB);\r\n\t\tconst element = document.createElement(\"a\");\r\n\t\tconst file = new Blob([data], { type: \"application/json;charset=utf-8\" });\r\n\t\telement.href = URL.createObjectURL(file);\r\n\t\telement.download = \"export_zsku_\" + new Date().toISOString().substring(0, 10) + \".json\";\r\n\t\tdocument.body.appendChild(element);\r\n\t\telement.click();\r\n\t\telement.remove();\r\n\t};\r\n\treturn (\r\n\t\t<div style={{ display: \"flex\", alignItems: \"center\", gap: \"1em\" }}>\r\n\t\t\t<Button variant=\"contained\" onClick={download}>\r\n\t\t\t\tExportieren\r\n\t\t\t</Button>\r\n\t\t\t<p style={{width: \"80%\"}}>\r\n\t\t\t\tHier klicken um alle Daten zu exportieren. Die erzeugte Datei kann wieder reimportiert werden um den\r\n\t\t\t\tjetztigen Zustand der Datenbank wiederherzustellen.\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst IndexedDBImport = () => {\r\n    const dispatch = useDispatch<AppDispatch>();\r\n\tconst upload = async () => {\r\n\t\tconst element = document.createElement(\"input\");\r\n\t\telement.type = \"file\";\r\n\t\telement.accept = \"application/json\";\r\n\t\telement.multiple = false;\r\n\t\telement.click();\r\n\t\telement.addEventListener(\"change\", async () => {\r\n\t\t\tif (element.files?.length !== 1) return;\r\n\t\t\tconst { users, roles, penalties, transactions, feeTypes, games } = JSON.parse(await element.files[0].text());\r\n\t\t\tawait db.users.clear();\r\n\t\t\tawait db.users.bulkAdd(users);\r\n\t\t\tawait db.roles.clear();\r\n\t\t\tawait db.roles.bulkAdd(roles);\r\n\t\t\tawait db.penalties.clear();\r\n\t\t\tawait db.penalties.bulkAdd(penalties);\r\n\t\t\tawait db.transactions.clear();\r\n\t\t\tawait db.transactions.bulkAdd(transactions);\r\n\t\t\tawait db.feeTypes.clear();\r\n\t\t\tawait db.feeTypes.bulkAdd(feeTypes);\r\n\t\t\tawait db.games.clear();\r\n\t\t\tawait db.games.bulkAdd(games);\r\n\r\n            dispatch(usersSlice.actions.set(users));\r\n            dispatch(rolesSlice.actions.set(roles));\r\n            dispatch(penaltiesSlice.actions.set(penalties));\r\n            dispatch(transactionsSlice.actions.set(transactions));\r\n            dispatch(feeTypesSlice.actions.set(feeTypes));\r\n            dispatch(gamesSlice.actions.setGames(games));\r\n\t\t});\r\n\t};\r\n\treturn (\r\n\t\t<div style={{ display: \"flex\", alignItems: \"center\", gap: \"1em\" }}>\r\n\t\t\t<Button type=\"button\" variant=\"contained\" onClick={upload}>\r\n\t\t\t\tImportieren\r\n\t\t\t</Button>\r\n\t\t\t<p style={{width: \"80%\"}}>\r\n\t\t\t\tHier klicken um einen alten Stand wiederherzustellen. <b>Alle neuen Eintrge werden dabei gelscht!</b>\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t);\r\n};\r\n","import { Button, MenuItem, Select, TextField } from \"@material-ui/core\";\r\nimport { bindActionCreators } from \"@reduxjs/toolkit\";\r\nimport React, { Component } from \"react\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { connect } from \"react-redux\";\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\";\r\nimport { FeeType, FeeTypeApplicationStrategy } from \"../../../entities/entities\";\r\nimport { feeTypesAdapter, feeTypesSlice } from \"../../../redux/reducers/feeTypes\";\r\nimport { AppDispatch, AppState } from \"../../../redux/store\";\r\nimport { CurrencyField } from \"../../common/currencyField\";\r\n\r\ntype FeeTypesFormState = {\r\n\tvalue: string;\r\n\tapplicationStrategy: FeeTypeApplicationStrategy;\r\n\tname: string;\r\n\tid: string;\r\n};\r\n\r\nconst update = feeTypesSlice.actions.update;\r\ntype LinkDispatchProps = {\r\n\teditFeeType: typeof update;\r\n};\r\n\r\ntype LinkStateProps = {\r\n\tfeeType?: FeeType;\r\n};\r\n\r\ntype RouteInfo = {\r\n\tid: string;\r\n};\r\n\r\ninterface FeeTypesFormProps extends RouteComponentProps<RouteInfo> {}\r\n\r\nclass FeeTypesEditForm extends Component<LinkDispatchProps & LinkStateProps & FeeTypesFormProps, FeeTypesFormState> {\r\n\tconstructor(props: LinkDispatchProps & LinkStateProps & FeeTypesFormProps) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tvalue: this.props.feeType?.value?.toString() ?? \"\",\r\n\t\t\tname: this.props.feeType?.label ?? \"\",\r\n\t\t\tid: this.props.feeType?.id ?? \"ERR\",\r\n\t\t\tapplicationStrategy: this.props.feeType?.applicationStrategy ?? FeeTypeApplicationStrategy.Target,\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate() {\r\n\t\tif (this.state.id !== this.props.match.params.id) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tid: this.props.feeType?.id ?? \"ERR\",\r\n\t\t\t\tname: this.props.feeType?.label ?? \"ERR\",\r\n\t\t\t\tvalue: this.props.feeType?.value?.toString() ?? \"\",\r\n\t\t\t\tapplicationStrategy: this.props.feeType?.applicationStrategy ?? FeeTypeApplicationStrategy.Target,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\" }}>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tvalue={this.state.name}\r\n\t\t\t\t\tlabel=\"Name\"\r\n\t\t\t\t\tname=\"Name\"\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\t\tthis.setState({ name: evt.target.value });\r\n\t\t\t\t\t}}></TextField>\r\n\t\t\t\t<CurrencyField\r\n\t\t\t\t\tvalue={this.state.value}\r\n\t\t\t\t\tlabel=\"Value\"\r\n\t\t\t\t\tname=\"Wert\"\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\tthis.setState({value: e.target.value});\r\n\t\t\t\t\t}}></CurrencyField>\r\n\t\t\t\t<Select\r\n\t\t\t\t\tlabel=\"Betrifft\"\r\n\t\t\t\t\tname=\"ApplicationStrategy\"\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\tvalue={this.state.applicationStrategy}\r\n\t\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\tapplicationStrategy: parseInt(evt.target.value as string) as FeeTypeApplicationStrategy,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.Target}>Ziel</MenuItem>\r\n\t\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.AllButTarget}>Alle auer Ziel</MenuItem>\r\n\t\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.AutoAll}>Alle</MenuItem>\r\n\t\t\t\t</Select>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tthis.props.editFeeType({\r\n\t\t\t\t\t\t\tchanges: {\r\n\t\t\t\t\t\t\t\tlabel: this.state.name,\r\n\t\t\t\t\t\t\t\tvalue: parseFloat(this.state.value),\r\n\t\t\t\t\t\t\t\tapplicationStrategy: this.state.applicationStrategy,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tid: this.state.id,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.props.history.push(\"/zsku-mgmt/settings\");\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\tSpeichern\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state: AppState, ownProps: FeeTypesFormProps): LinkStateProps => ({\r\n\tfeeType: feeTypesAdapter.getSelectors().selectById(state.feeTypes, ownProps.match.params.id),\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch): LinkDispatchProps => ({\r\n\teditFeeType: bindActionCreators(feeTypesSlice.actions.update, dispatch),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(FeeTypesEditForm));\r\n","import { configureStore, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport _ from \"lodash\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { FeeType, FeeTypeApplicationStrategy, Role, User } from \"../entities/entities\";\r\nimport { colors } from \"../main/common/colors\";\r\nimport { db } from \"./Database\";\r\nimport { feeTypesSlice } from \"./reducers/feeTypes\";\r\nimport { gamesSlice } from \"./reducers/games\";\r\nimport { penaltiesSlice } from \"./reducers/penalties\";\r\nimport { rolesSlice } from \"./reducers/roles\";\r\nimport { transactionsSlice } from \"./reducers/transactions\";\r\nimport { usersSlice } from \"./reducers/users\";\r\nconst feeTypes: FeeType[] = [\r\n\t{\r\n\t\tlabel: \"Diskutieren\",\r\n\t\tvalue: 0.01,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"2\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Fluchen\",\r\n\t\tvalue: 0.01,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"3\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Alle Neune\",\r\n\t\tvalue: 0.2,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.AllButTarget,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"4\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Gosse\",\r\n\t\tvalue: 0.3,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"5\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Kugel abfangen misslingt\",\r\n\t\tvalue: 0.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"6\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Kugel abgefangen\",\r\n\t\tvalue: 0.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"7\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Wurf verpennt\",\r\n\t\tvalue: 0.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"8\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Nicht aufgeschrieben\",\r\n\t\tvalue: 0.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"9\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"2. Verlierer\",\r\n\t\tvalue: 0.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"10\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Kugel fallen lassen\",\r\n\t\tvalue: 1,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"11\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Nicht aufgegessen\",\r\n\t\tvalue: 1,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"12\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Nichts gegessen\",\r\n\t\tvalue: 1,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"13\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Versptung (5m)\",\r\n\t\tvalue: 1,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"14\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Klingel\",\r\n\t\tvalue: 2,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"15\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Kugel auerhalb\",\r\n\t\tvalue: 2,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"16\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Verlierer\",\r\n\t\tvalue: 1.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"17\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Versptung (15m)\",\r\n\t\tvalue: 2.5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"18\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Interieur beschdigt\",\r\n\t\tvalue: 3,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"19\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Beitrag\",\r\n\t\tvalue: 5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.AutoAll,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"20\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Kegelshirt nicht an\",\r\n\t\tvalue: 5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"21\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Versptung (30m)\",\r\n\t\tvalue: 5,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"22\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Eingeschlafen\",\r\n\t\tvalue: 10,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"23\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Brechen auf der Bahn\",\r\n\t\tvalue: 25,\r\n\t\tapplicationStrategy: FeeTypeApplicationStrategy.Target,\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"24\",\r\n\t},\r\n];\r\n\r\nconst roles: Role[] = [\r\n\t{\r\n\t\tname: \"Kassenwart\",\r\n\t\tcreatedOn: Date.now(),\r\n\t\tid: \"1\",\r\n\t},\r\n];\r\n\r\nconst users: User[] = [\r\n\t{\r\n\t\tabbreviation: \"DW\",\r\n\t\tcolor: _.sample(colors) ?? \"#0088cc\",\r\n\t\tcreatedOn: Date.now(),\r\n\t\tfullName: \"David Weischer\",\r\n\t\tid: \"2\",\r\n\t\troles: [\"1\"],\r\n\t},\r\n];\r\n\r\nexport const loadingSlice = createSlice({\r\n\tinitialState: true,\r\n\tname: \"loading\",\r\n\treducers: {\r\n\t\tset(state, action: PayloadAction<boolean>) {\r\n\t\t\tstate = action.payload;\r\n\t\t\treturn false;\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport const store = configureStore({\r\n\treducer: {\r\n\t\tfeeTypes: feeTypesSlice.reducer,\r\n\t\troles: rolesSlice.reducer,\r\n\t\tusers: usersSlice.reducer,\r\n\t\ttransactions: transactionsSlice.reducer,\r\n\t\tpenalties: penaltiesSlice.reducer,\r\n\t\tgames: gamesSlice.reducer,\r\n\t\tloading: loadingSlice.reducer,\r\n\t},\r\n});\r\n\r\n(async () => {\r\n\tlet dbFeeTypes = await db.feeTypes.toArray();\r\n\tif (dbFeeTypes?.length === 0) dbFeeTypes = feeTypes;\r\n\tlet dbRoles = await db.roles.toArray();\r\n\tif (dbRoles?.length === 0) dbRoles = roles;\r\n\tlet dbUsers = await db.users.toArray();\r\n\tif (dbUsers?.length === 0) dbUsers = users;\r\n\r\n\tstore.dispatch(feeTypesSlice.actions.set(dbFeeTypes));\r\n\tstore.dispatch(penaltiesSlice.actions.set(await db.penalties.toArray()));\r\n\tstore.dispatch(rolesSlice.actions.set(dbRoles));\r\n\tstore.dispatch(usersSlice.actions.set(dbUsers));\r\n\tstore.dispatch(transactionsSlice.actions.set(await db.transactions.toArray()));\r\n\tstore.dispatch(loadingSlice.actions.set(false));\r\n\tstore.dispatch(gamesSlice.actions.setGames(await db.games.toArray()));\r\n})();\r\n\r\nexport type AppDispatch = typeof store.dispatch;\r\nexport const useStoreDispatch = () => useDispatch<typeof store.dispatch>();\r\nexport type AppState = ReturnType<typeof store.getState>;\r\n","import { Button, MenuItem, Select, TextField } from \"@material-ui/core\";\r\nimport React, { useState } from \"react\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport { FeeTypeApplicationStrategy } from \"../../../entities/entities\";\r\nimport { feeTypesSlice } from \"../../../redux/reducers/feeTypes\";\r\nimport { useStoreDispatch } from \"../../../redux/store\";\r\nimport { CurrencyField } from \"../../common/currencyField\";\r\n\r\nconst FeeTypesCreateForm = withRouter(({ history }) => {\r\n\tconst [val, setValue] = useState(\"\");\r\n\tconst [label, setLabel] = useState(\"\");\r\n\tconst [applicationStrategy, setApplicationStrategy] = useState(FeeTypeApplicationStrategy.Target);\r\n\tconst dispatch = useStoreDispatch();\r\n\treturn (\r\n\t\t<div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\" }}>\r\n\t\t\t<TextField\r\n\t\t\t\tvalue={label}\r\n\t\t\t\tlabel=\"Name\"\r\n\t\t\t\tname=\"Name\"\r\n\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\tsetLabel(evt.target.value);\r\n\t\t\t\t}}></TextField>\r\n\t\t\t<CurrencyField\r\n\t\t\t\tvalue={val}\r\n\t\t\t\tlabel=\"Wert\"\r\n\t\t\t\tname=\"Value\"\r\n\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t}}></CurrencyField>\r\n\t\t\t<Select\r\n\t\t\t\tlabel=\"Betrifft\"\r\n\t\t\t\tname=\"ApplicationStrategy\"\r\n\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\tvalue={applicationStrategy}\r\n\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\tsetApplicationStrategy(parseInt(evt.target.value as string) as FeeTypeApplicationStrategy);\r\n\t\t\t\t}}>\r\n\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.Target}>Ziel</MenuItem>\r\n\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.AllButTarget}>Alle auer Ziel</MenuItem>\r\n\t\t\t\t<MenuItem value={FeeTypeApplicationStrategy.AutoAll}>Alle</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t<Button\r\n\t\t\t\tcolor=\"primary\"\r\n\t\t\t\tvariant=\"contained\"\r\n\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\tfeeTypesSlice.actions.create({\r\n\t\t\t\t\t\t\tvalue: parseFloat(val),\r\n\t\t\t\t\t\t\tlabel,\r\n\t\t\t\t\t\t\tapplicationStrategy,\r\n\t\t\t\t\t\t\tid: v4(),\r\n\t\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t\thistory.push(\"/zsku-mgmt/settings\");\r\n\t\t\t\t}}>\r\n\t\t\t\tSpeichern\r\n\t\t\t</Button>\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport default connect()(FeeTypesCreateForm);\r\n","import { Button, Dialog, DialogActions, DialogContent, DialogTitle } from \"@material-ui/core\";\r\nimport React, { ReactElement, useState } from \"react\";\r\n\r\ninterface ConfirmationDialogAction {\r\n\tlabel: string;\r\n\thandle?: () => any;\r\n}\r\ninterface ConfirmationDialogProps {\r\n\ttitle: string;\r\n\tmessage: string;\r\n\r\n\tonConfirm?: () => any;\r\n\tonAbort?: () => any;\r\n\tcustom?: ConfirmationDialogAction[];\r\n\tcomponent: ReactElement;\r\n}\r\nconst ConfirmationDialog = ({ title, message, onConfirm, onAbort, custom, component }: ConfirmationDialogProps) => {\r\n\tconst [open, setOpen] = useState(false);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div\r\n\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tsetOpen(true);\r\n\t\t\t\t}}>\r\n\t\t\t\t{component}\r\n\t\t\t</div>\r\n\t\t\t<Dialog\r\n\t\t\t\topen={open}\r\n\t\t\t\tonClose={() => {\r\n\t\t\t\t\tsetOpen(false);\r\n\t\t\t\t\tif (typeof onAbort === \"function\") onAbort();\r\n\t\t\t\t}}>\r\n\t\t\t\t<DialogTitle>{title}</DialogTitle>\r\n\t\t\t\t<DialogContent>{message}</DialogContent>\r\n\r\n\t\t\t\t{custom != null && custom.length > 0 ? (\r\n\t\t\t\t\t<div style={{display: \"flex\", flexDirection: \"column\"}}>\r\n\t\t\t\t\t\t{custom.map((action, idx) => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tkey={`conf_act_${idx}`}\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetOpen(false);\r\n\t\t\t\t\t\t\t\t\t\ttypeof action.handle === \"function\" && action.handle();\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{action.label}\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetOpen(false);\r\n\t\t\t\t\t\t\t\tif (typeof onAbort === \"function\") onAbort();\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tAbbrechen\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetOpen(false);\r\n\t\t\t\t\t\t\t\tif (typeof onConfirm === \"function\") onConfirm();\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\tBesttigen\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t)}\r\n\t\t\t</Dialog>\r\n\t\t</>\r\n\t);\r\n};\r\nexport { ConfirmationDialog };\r\n","import { bindActionCreators } from \"@reduxjs/toolkit\";\r\nimport React, { Component } from \"react\";\r\nimport { BsPencilSquare, BsTrash } from \"react-icons/bs\";\r\nimport { connect } from \"react-redux\";\r\nimport \"../../../css/settings.scss\";\r\nimport \"../../../entities/dataservice\";\r\nimport { FeeType, FeeTypeApplicationStrategy } from \"../../../entities/entities\";\r\nimport { AppDispatch, AppState } from \"../../../redux/store\";\r\nimport { GenericTable } from \"../../common/genericTable\";\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\";\r\nimport { feeTypesAdapter, feeTypesSlice } from \"../../../redux/reducers/feeTypes\";\r\nimport { IconButton } from \"@material-ui/core\";\r\nimport { ConfirmationDialog } from \"../../common/confirmationDialog\";\r\n\r\ntype FeeTableState = {};\r\ninterface FeeTableProps extends RouteComponentProps {}\r\ntype LinkStateProps = { feeTypes: FeeType[] };\r\ntype LinkDispatchProps = { deleteFeeType: (id: string) => void };\r\n\r\nexport class FeeTypesTable extends Component<FeeTableProps & LinkStateProps & LinkDispatchProps, FeeTableState> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<GenericTable<FeeType>\r\n\t\t\t\tcolumns={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\t\tdata: \"label\",\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_value\",\r\n\t\t\t\t\t\tname: \"Wert\",\r\n\t\t\t\t\t\tdata: (r) => (r.value != null ? r.value.toFixed(2) + \" \" : \"CUSTOM\"),\r\n\t\t\t\t\t\talign: \"right\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a,b) => {return (a.value ?? 0) - (b.value ?? 0)}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_strategy\",\r\n\t\t\t\t\t\tname: \"Betrifft\",\r\n\t\t\t\t\t\tdata: (r) => {\r\n\t\t\t\t\t\t\tswitch (r.applicationStrategy) {\r\n\t\t\t\t\t\t\t\tcase FeeTypeApplicationStrategy.Target:\r\n\t\t\t\t\t\t\t\t\treturn \"Ziel\";\r\n\t\t\t\t\t\t\t\tcase FeeTypeApplicationStrategy.AllButTarget:\r\n\t\t\t\t\t\t\t\t\treturn \"Alle auer Ziel\";\r\n\t\t\t\t\t\t\t\tcase FeeTypeApplicationStrategy.AutoAll:\r\n\t\t\t\t\t\t\t\t\treturn \"Alle\";\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\treturn \"Niemanden\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_timestamp\",\r\n\t\t\t\t\t\tname: \"Erstellt am\",\r\n\t\t\t\t\t\tdata: (r) => new Date(r.createdOn ?? Date.now()).toLocaleDateString(\"de-DE\"),\r\n\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a,b) => a.createdOn - b.createdOn\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_actions\",\r\n\t\t\t\t\t\tname: \"Aktionen\",\r\n\t\t\t\t\t\talign: \"right\",\r\n\t\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t\t<div style={{ float: \"right\", display: \"flex\" }}>\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.props.history.push(\"/zsku-mgmt/settings/feeTypes/edit/\" + r.id);\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<BsPencilSquare size=\".75em\"></BsPencilSquare>\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t<ConfirmationDialog\r\n\t\t\t\t\t\t\t\t\ttitle=\"Strafe lschen\"\r\n\t\t\t\t\t\t\t\t\tmessage={`Soll die Strafe ${r.label} wirklich gelscht werden?`}\r\n\t\t\t\t\t\t\t\t\tonConfirm={() => {\r\n\t\t\t\t\t\t\t\t\t\tif (r.id != null) this.props.deleteFeeType(r.id);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t\t<IconButton color=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\t\t<BsTrash size=\".75em\"></BsTrash>\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t}></ConfirmationDialog>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t},\r\n\t\t\t\t]}\r\n\t\t\t\trows={this.props.feeTypes.filter((ft) => ft.deleted !== true)}\r\n\t\t\t\tentriesPerPage={5}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): LinkStateProps => ({\r\n\tfeeTypes: feeTypesAdapter.getSelectors().selectAll(state.feeTypes),\r\n});\r\nconst mapDispatchToProps = (dispatch: AppDispatch): LinkDispatchProps => ({\r\n\tdeleteFeeType: bindActionCreators(feeTypesSlice.actions.delete, dispatch),\r\n});\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(FeeTypesTable));\r\n","import { Button, Paper } from \"@material-ui/core\";\r\nimport React, { Component } from \"react\";\r\nimport { FaMoneyBillWave } from \"react-icons/fa\";\r\nimport { Link, Route } from \"react-router-dom\";\r\nimport \"../../../css/settings.scss\";\r\nimport \"../../../entities/dataservice\";\r\nimport FeeTypesEditForm from \"./feeTypesEditForm\";\r\nimport FeeTypesCreateForm from \"./feeTypesCreateForm\";\r\nimport FeeTypesTable from \"./feeTypesTable\";\r\nimport * as colors from \"../../common/colors\";\r\n\r\ntype FeeTypesState = {};\r\n\r\nexport class FeeTypes extends Component<{}, FeeTypesState> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t<div className=\"feeTypesMain settingszsku-panel\">\r\n\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t<h1>Strafen</h1>\r\n\t\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t\t<FaMoneyBillWave size=\"4em\" style={{ backgroundColor: colors.yellow }} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Link to=\"/zsku-mgmt/settings/feeTypes/addNew\" style={{ textDecoration: \"none\" }}>\r\n\t\t\t\t\t\t\t<Button variant=\"text\" color=\"primary\">\r\n\t\t\t\t\t\t\t\tHinzufgen\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"settingsContainer\">\r\n\t\t\t\t\t\t<Route path=\"/zsku-mgmt/settings/feeTypes/addNew\" component={FeeTypesCreateForm}></Route>\r\n\t\t\t\t\t\t<Route path=\"/zsku-mgmt/settings/feeTypes/edit/:id\" component={FeeTypesEditForm}></Route>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Route path=\"/zsku-mgmt/settings\" component={FeeTypesTable}></Route>\r\n\t\t\t\t</div>\r\n\t\t\t</Paper>\r\n\t\t);\r\n\t}\r\n}\r\n","import { Button, TextField } from \"@material-ui/core\";\r\nimport React, { useState } from \"react\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport { rolesSlice } from \"../../../redux/reducers/roles\";\r\nimport { useStoreDispatch } from \"../../../redux/store\";\r\n\r\nconst RolesCreateForm = withRouter(({ history }) => {\r\n\tconst [name, setName] = useState(\"\");\r\n\tconst dispatch = useStoreDispatch();\r\n\treturn (\r\n\t\t<div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\" }}>\r\n\t\t\t<TextField\r\n\t\t\t\tvalue={name}\r\n\t\t\t\tlabel=\"Name\"\r\n\t\t\t\tname=\"Name\"\r\n\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\tsetName(evt.target.value);\r\n\t\t\t\t}}></TextField>\r\n\t\t\t<Button\r\n\t\t\t\tcolor=\"primary\"\r\n\t\t\t\tvariant=\"contained\"\r\n\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch(rolesSlice.actions.create({ name, id: v4(), createdOn: Date.now() }));\r\n\t\t\t\t\thistory.push(\"/zsku-mgmt/settings\");\r\n\t\t\t\t}}>\r\n\t\t\t\tSpeichern\r\n\t\t\t</Button>\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport default connect()(RolesCreateForm);\r\n","import { Button, TextField } from \"@material-ui/core\";\r\nimport { bindActionCreators } from \"@reduxjs/toolkit\";\r\nimport React, { Component } from \"react\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { connect } from \"react-redux\";\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\";\r\nimport { Role } from \"../../../entities/entities\";\r\nimport { rolesAdapter, rolesSlice } from \"../../../redux/reducers/roles\";\r\nimport { AppDispatch, AppState } from \"../../../redux/store\";\r\n\r\ntype RolesFormState = {\r\n\tname: string;\r\n\tid: string;\r\n};\r\n\r\nconst update = rolesSlice.actions.update;\r\ntype LinkDispatchProps = {\r\n\teditRole: typeof update;\r\n};\r\n\r\ntype LinkStateProps = {\r\n\trole?: Role;\r\n};\r\n\r\ntype RouteInfo = {\r\n\tid: string;\r\n};\r\n\r\ninterface RolesFormProps extends RouteComponentProps<RouteInfo> {}\r\n\r\nclass RolesEditForm extends Component<LinkDispatchProps & LinkStateProps & RolesFormProps, RolesFormState> {\r\n\tconstructor(props: LinkDispatchProps & LinkStateProps & RolesFormProps) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tname: this.props.role?.name ?? \"\",\r\n\t\t\tid: this.props.role?.id ?? \"ERR\",\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate() {\r\n\t\tif (this.state.id !== this.props.match.params.id) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tid: this.props.role?.id ?? \"ERR\",\r\n\t\t\t\tname: this.props.role?.name ?? \"ERR\",\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\" }}>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tvalue={this.state.name}\r\n\t\t\t\t\tlabel=\"Name\"\r\n\t\t\t\t\tname=\"Name\"\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\tonChange={(evt) => {\r\n\t\t\t\t\t\tthis.setState({ name: evt.target.value });\r\n\t\t\t\t\t}}></TextField>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tthis.props.editRole({\r\n\t\t\t\t\t\t\tchanges: { name: this.state.name },\r\n\t\t\t\t\t\t\tid: this.state.id,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.props.history.push(\"/zsku-mgmt/settings\");\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\tSpeichern\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state: AppState, ownProps: RolesFormProps): LinkStateProps => ({\r\n\trole: rolesAdapter.getSelectors().selectById(state.roles, ownProps.match.params.id),\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch): LinkDispatchProps => ({\r\n\teditRole: bindActionCreators(rolesSlice.actions.update, dispatch),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(RolesEditForm));\r\n","import React from \"react\";\r\nimport { BsPencilSquare, BsTrash } from \"react-icons/bs\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { Role } from \"../../../entities/entities\";\r\nimport { AppState, useStoreDispatch } from \"../../../redux/store\";\r\nimport { GenericTable } from \"../../common/genericTable\";\r\nimport { rolesAdapter, rolesSlice } from \"../../../redux/reducers/roles\";\r\nimport { connect, useSelector } from \"react-redux\";\r\nimport { EntityState } from \"@reduxjs/toolkit\";\r\nimport { IconButton } from \"@material-ui/core\";\r\nimport { ConfirmationDialog } from \"../../common/confirmationDialog\";\r\n\r\nconst RolesTable = withRouter(({ history }) => {\r\n\tconst dispatch = useStoreDispatch();\r\n\tconst rolesCollection = useSelector<AppState>((state) => state.roles) as EntityState<Role>;\r\n\tconst roles = rolesAdapter.getSelectors().selectAll(rolesCollection);\r\n\treturn (\r\n\t\t<GenericTable<Role>\r\n\t\t\tcolumns={[\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\tdata: \"name\",\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\torderable: true,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_timestamp\",\r\n\t\t\t\t\tname: \"Erstellt am\",\r\n\t\t\t\t\tdata: (r) => new Date(r.createdOn ?? Date.now()).toLocaleDateString(\"de-DE\"),\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\torderable: true,\r\n\t\t\t\t\tsort: (a, b) => a.createdOn - b.createdOn,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_actions\",\r\n\t\t\t\t\tname: \"Aktionen\",\r\n\t\t\t\t\talign: \"right\",\r\n\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t<div style={{ float: \"right\", display: \"flex\" }}>\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\thistory.push(\"/zsku-mgmt/settings/roles/edit/\" + r.id);\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<BsPencilSquare size=\".75em\"></BsPencilSquare>\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<ConfirmationDialog\r\n\t\t\t\t\t\t\t\ttitle=\"Posten lschen\"\r\n\t\t\t\t\t\t\t\tmessage={`Soll der Posten ${r.name} wirklich gelscht werden?`}\r\n\t\t\t\t\t\t\t\tonConfirm={() => {\r\n\t\t\t\t\t\t\t\t\tif (r.id != null) dispatch(rolesSlice.actions.delete(r.id));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t<IconButton color=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\t<BsTrash size=\".75em\"></BsTrash>\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t}></ConfirmationDialog>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t),\r\n\t\t\t\t},\r\n\t\t\t]}\r\n\t\t\trows={roles}\r\n\t\t\tentriesPerPage={5}></GenericTable>\r\n\t);\r\n});\r\n\r\nexport default connect()(RolesTable);\r\n","import Button from \"@material-ui/core/Button/Button\";\r\nimport Paper from \"@material-ui/core/Paper/Paper\";\r\nimport React from \"react\";\r\nimport { FaUserTag } from \"react-icons/fa\";\r\nimport { Link, Route } from \"react-router-dom\";\r\nimport RolesCreateForm from \"./rolesCreateForm\";\r\nimport RolesEditForm from \"./rolesEditForm\";\r\nimport RolesTable from \"./rolesTable\";\r\nimport * as colors from \"../../common/colors\";\r\nconst Roles = () => {\r\n\treturn (\r\n\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t<div className=\"rolesMain settingszsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>Posten</h1>\r\n\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t<FaUserTag size=\"4em\" style={{ backgroundColor: colors.purple }} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Link to=\"/zsku-mgmt/settings/roles/addNew\" style={{ textDecoration: \"none\" }}>\r\n\t\t\t\t\t\t<Button variant=\"text\" color=\"primary\">\r\n\t\t\t\t\t\t\tHinzufgen\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"settingsContainer\">\r\n\t\t\t\t\t<Route path=\"/zsku-mgmt/settings/roles/addNew\" component={RolesCreateForm}></Route>\r\n\t\t\t\t\t<Route path=\"/zsku-mgmt/settings/roles/edit/:id\" component={RolesEditForm}></Route>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Route path=\"/zsku-mgmt/settings\" component={RolesTable}></Route>\r\n\t\t\t</div>\r\n\t\t</Paper>\r\n\t);\r\n};\r\n\r\nexport default Roles;\r\n","import { IconButton } from \"@material-ui/core\";\r\nimport { EntityState } from \"@reduxjs/toolkit\";\r\nimport React from \"react\";\r\nimport { BsPencilSquare, BsTrash } from \"react-icons/bs\";\r\nimport { connect, useSelector } from \"react-redux\";\r\nimport { Link, withRouter } from \"react-router-dom\";\r\nimport { Role, User } from \"../../../entities/entities\";\r\nimport { rolesAdapter } from \"../../../redux/reducers/roles\";\r\nimport { usersAdapter, usersSlice } from \"../../../redux/reducers/users\";\r\nimport { AppState, useStoreDispatch } from \"../../../redux/store\";\r\nimport { ConfirmationDialog } from \"../../common/confirmationDialog\";\r\nimport { GenericTable } from \"../../common/genericTable\";\r\n\r\nconst UsersTable = withRouter(({ history }) => {\r\n\tconst dispatch = useStoreDispatch();\r\n\tconst usersCollection = useSelector<AppState>((state) => state.users) as EntityState<User>;\r\n\tconst rolesCollection = useSelector<AppState>((state) => state.roles) as EntityState<Role>;\r\n\tconst users = usersAdapter\r\n\t\t.getSelectors()\r\n\t\t.selectAll(usersCollection)\r\n\t\t.filter((u) => u.deleted !== true);\r\n\tconst roles = rolesAdapter.getSelectors().selectEntities(rolesCollection);\r\n\r\n\treturn (\r\n\t\t<GenericTable<User>\r\n\t\t\tcolumns={[\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\tdata: (row) => <Link to={\"/zsku-mgmt/users/\" + row.id}>{row.fullName}</Link>,\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\torderable: true,\r\n\t\t\t\t\tsort: (a, b) => a.fullName.localeCompare(b.fullName),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_abbreviation\",\r\n\t\t\t\t\tname: \"Abkrzung\",\r\n\t\t\t\t\tdata: \"abbreviation\",\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\torderable: true,\r\n\t\t\t\t\tsort: (a, b) => a.fullName.localeCompare(b.fullName),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_roles\",\r\n\t\t\t\t\tname: \"Posten\",\r\n\t\t\t\t\tdata: (row) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\trow.roles\r\n\t\t\t\t\t\t\t\t.slice(0, 3)\r\n\t\t\t\t\t\t\t\t.map((r) => roles[r]?.name)\r\n\t\t\t\t\t\t\t\t.join(\", \") + (row.roles.length > 3 ? \", ...\" : \"\")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_timestamp\",\r\n\t\t\t\t\tname: \"Erstellt am\",\r\n\t\t\t\t\tdata: (r) => new Date(r.createdOn ?? Date.now()).toLocaleDateString(\"de-DE\"),\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\torderable: true,\r\n\t\t\t\t\tsort: (a, b) => a.createdOn - b.createdOn,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"col_actions\",\r\n\t\t\t\t\tname: \"Aktionen\",\r\n\t\t\t\t\talign: \"right\",\r\n\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t<div style={{ float: \"right\", display: \"flex\" }}>\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\thistory.push(\"/zsku-mgmt/users/\" + r.id);\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t<BsPencilSquare size=\".75em\"></BsPencilSquare>\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<ConfirmationDialog\r\n\t\t\t\t\t\t\t\ttitle=\"Mitglied lschen\"\r\n\t\t\t\t\t\t\t\tmessage={`Soll das Mitglied ${r.fullName} wirklich gelscht werden?`}\r\n\t\t\t\t\t\t\t\tonConfirm={() => {\r\n\t\t\t\t\t\t\t\t\tif (r.id != null) dispatch(usersSlice.actions.delete(r.id));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t<IconButton color=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\t<BsTrash size=\".75em\"></BsTrash>\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t}></ConfirmationDialog>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t),\r\n\t\t\t\t},\r\n\t\t\t]}\r\n\t\t\trows={users}\r\n\t\t\tentriesPerPage={5}></GenericTable>\r\n\t);\r\n});\r\n\r\nexport default connect()(UsersTable);\r\n","import Button from \"@material-ui/core/Button/Button\";\r\nimport Paper from \"@material-ui/core/Paper/Paper\";\r\nimport React from \"react\";\r\nimport { FaUserFriends } from \"react-icons/fa\";\r\nimport { Link, Route } from \"react-router-dom\";\r\nimport UsersTable from \"./usersTable\";\r\nimport * as colors from \"../../common/colors\"\r\nconst Users = () => {\r\n\treturn (\r\n\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t<div className=\"usersMain settingszsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>Mitglieder</h1>\r\n\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t<FaUserFriends size=\"4em\" style={{ backgroundColor:  colors.blue}} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Link to=\"/zsku-mgmt/users/new\" style={{ textDecoration: \"none\" }}>\r\n\t\t\t\t\t\t<Button variant=\"text\" color=\"primary\">\r\n\t\t\t\t\t\t\tHinzufgen\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Route path=\"/zsku-mgmt/settings\" component={UsersTable}></Route>\r\n\t\t\t</div>\r\n\t\t</Paper>\r\n\t);\r\n};\r\n\r\nexport default Users;\r\n","import React from \"react\";\r\nimport { DataManagement } from \"./dataManagement\";\r\nimport { FeeTypes } from \"./FeeTypes/feeTypes\";\r\nimport Roles from \"./Roles/roles\";\r\nimport Users from \"./Users/users\";\r\n\r\nconst Settings = () => {\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<Users />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<Roles />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<FeeTypes />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<DataManagement />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n\r\n\r\nexport default Settings;\r\n","import {\r\n\tAvatar,\r\n\tButton,\r\n\tCard,\r\n\tCardContent,\r\n\tCardHeader,\r\n\tDialog,\r\n\tDialogActions,\r\n\tDialogContent,\r\n\tDialogTitle,\r\n\tFormControl,\r\n\tIconButton,\r\n\tMenuItem,\r\n\tPaper,\r\n\tSelect,\r\n\tTextField,\r\n\tStepper,\r\n\tStep,\r\n\tStepLabel,\r\n\tSlider,\r\n\tList,\r\n\tListItem,\r\n\tSwitch,\r\n\tFormControlLabel,\r\n} from \"@material-ui/core\";\r\nimport { Dictionary } from \"@reduxjs/toolkit\";\r\nimport { useFormik } from \"formik\";\r\nimport { countBy, entries, last, maxBy } from \"lodash\";\r\nimport React, { ComponentProps, useState } from \"react\";\r\nimport { BsFillCaretLeftFill, BsFillCaretRightFill, BsFillTrashFill } from \"react-icons/bs\";\r\nimport { FaChartPie } from \"react-icons/fa\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, RouteComponentProps, withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport * as yup from \"yup\";\r\nimport { FeeType, FeeTypeApplicationStrategy, Game, Penalty, Role, User } from \"../../entities/entities\";\r\nimport { feeTypesAdapter } from \"../../redux/reducers/feeTypes\";\r\nimport { gameSelectors, gamesSlice } from \"../../redux/reducers/games\";\r\nimport { penaltiesAdapter, penaltiesSlice } from \"../../redux/reducers/penalties\";\r\nimport { transactionsAdapter, transactionsSlice } from \"../../redux/reducers/transactions\";\r\nimport { usersAdapter, usersSlice } from \"../../redux/reducers/users\";\r\nimport { AppDispatch, AppState } from \"../../redux/store\";\r\nimport { ConfirmationDialog } from \"../common/confirmationDialog\";\r\nimport { Currency, formatCurrency } from \"../common/currency\";\r\nimport { CurrencyField } from \"../common/currencyField\";\r\nimport { GenericTable } from \"../common/genericTable\";\r\nconst NoCurrentGame = () => {\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\treturn (\r\n\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t<h1>Kein aktuelles Spiel</h1>\r\n\t\t\t<Button\r\n\t\t\t\tvariant=\"contained\"\r\n\t\t\t\tcolor=\"primary\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch(gamesSlice.actions.createGame());\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tNeues Spiel\r\n\t\t\t</Button>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ninterface GroupedPenaltyProps extends ComponentProps<\"div\"> {\r\n\tpenalties: Penalty[];\r\n\teditable?: boolean;\r\n\tuser?: string;\r\n}\r\nconst GroupedPenalties = ({ penalties, editable, user, ...other }: GroupedPenaltyProps) => {\r\n\ttype GroupedPenalty = [string, { count: number; sum: number; penalties: Penalty[] }];\r\n\tconst dispatch = useDispatch();\r\n\tconst feeTypes = useSelector<AppState>((state) =>\r\n\t\tfeeTypesAdapter.getSelectors().selectEntities(state.feeTypes)\r\n\t) as Dictionary<FeeType>;\r\n\tconst openGame = useSelector<AppState>(gameSelectors.openGame) as Game;\r\n\tconst groupedPenalties: GroupedPenalty[] = entries(\r\n\t\tpenalties.reduce<{\r\n\t\t\t[feeTypeId: string]: { count: number; sum: number; penalties: Penalty[] };\r\n\t\t}>((agg, next) => {\r\n\t\t\tif (agg[next.feeTypeId] == null) {\r\n\t\t\t\tagg[next.feeTypeId] = { count: 0, sum: 0, penalties: [] };\r\n\t\t\t}\r\n\t\t\tagg[next.feeTypeId].count++;\r\n\t\t\tagg[next.feeTypeId].sum += next.value;\r\n\t\t\tagg[next.feeTypeId].penalties.push(next);\r\n\t\t\treturn agg;\r\n\t\t}, {})\r\n\t);\r\n\treturn (\r\n\t\t<div {...other}>\r\n\t\t\t<GenericTable<GroupedPenalty>\r\n\t\t\t\tcolumns={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_feetypename\",\r\n\t\t\t\t\t\tdata: (r) => feeTypes[r[0]]?.label ?? \"N/A\",\r\n\t\t\t\t\t\tname: \"Strafe\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_count\",\r\n\t\t\t\t\t\tdata: (r) =>\r\n\t\t\t\t\t\t\teditable && user ? (\r\n\t\t\t\t\t\t\t\t<div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n\t\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst penalty = penalties.find((p) => p.feeTypeId === r[0]);\r\n\t\t\t\t\t\t\t\t\t\t\tif (penalty == null) return;\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch(penaltiesSlice.actions.delete(penalty.id));\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<BsFillCaretLeftFill />\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t<span>{r[1].count.toString()}</span>\r\n\t\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\t\t\t\t\t\t\tpenaltiesSlice.actions.create({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfeeTypeId: r[0],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgameId: openGame.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: v4(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuserId: user,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: feeTypes[r[0]]?.value ?? 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<BsFillCaretRightFill />\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\tr[1].count.toString()\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\tname: \"Anzahl\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => a[1].count - b[1].count,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: \"col_sum\",\r\n\t\t\t\t\t\tdata: (r) => <Currency val={r[1].sum} style={{ margin: 0 }}></Currency>,\r\n\t\t\t\t\t\tname: \"Summe\",\r\n\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\tsort: (a, b) => a[1].sum - b[1].sum,\r\n\t\t\t\t\t},\r\n\t\t\t\t]}\r\n\t\t\t\trows={groupedPenalties}\r\n\t\t\t\tentriesPerPage={10}\r\n\t\t\t></GenericTable>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst PlayerCard = ({\r\n\tplayer,\r\n\tgame,\r\n\topenAddPenalty,\r\n}: {\r\n\tplayer: User;\r\n\tgame: Game;\r\n\topenAddPenalty: (player: User) => any;\r\n}) => {\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\tconst penalties = useSelector<AppState>(gameSelectors.playerPenalties(game.id, player.id)) as Penalty[];\r\n\tconst [showStats, setShowStats] = useState(false);\r\n\tconst role = useSelector<AppState>((state) => state.roles.entities[player.roles.find(Boolean) ?? \"\"]) as Role;\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Card\r\n\t\t\t\tonClick={() => openAddPenalty(player)}\r\n\t\t\t\televation={2}\r\n\t\t\t\tstyle={{ borderRadius: \"1em\", maxWidth: \"750px\", cursor: \"pointer\" }}\r\n\t\t\t>\r\n\t\t\t\t<CardHeader\r\n\t\t\t\t\tavatar={<Avatar style={{ backgroundColor: player.color }}>{player.abbreviation}</Avatar>}\r\n\t\t\t\t\taction={\r\n\t\t\t\t\t\t<div onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t\t\t\t{penalties.length > 0 ? (\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\ttitle=\"Details anzeigen\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetShowStats(!showStats);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<FaChartPie size=\".85em\" />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t) : null}\r\n\r\n\t\t\t\t\t\t\t<ConfirmationDialog\r\n\t\t\t\t\t\t\t\ttitle=\"Spieler entfernen\"\r\n\t\t\t\t\t\t\t\tmessage={`Soll ${player.fullName} aus dem Spiel entfernt werden? Alle Strafen fr diesen Spieler werden zurckgesetzt.`}\r\n\t\t\t\t\t\t\t\tonConfirm={() => {\r\n\t\t\t\t\t\t\t\t\tdispatch(penaltiesSlice.actions.deleteMultiple(penalties.map((p) => p.id)));\r\n\t\t\t\t\t\t\t\t\tdispatch(gamesSlice.actions.removePlayerFromGame({ userId: player.id }));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t<IconButton title=\"Spieler entfernen\">\r\n\t\t\t\t\t\t\t\t\t\t<BsFillTrashFill color=\"red\" size=\".85em\" />\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubheader={role?.name ?? \"Kein Posten\"}\r\n\t\t\t\t\ttitle={player.fullName}\r\n\t\t\t\t>\r\n\t\t\t\t\t<h4>{player.fullName}</h4>\r\n\t\t\t\t</CardHeader>\r\n\t\t\t\t{showStats && penalties.length > 0 ? (\r\n\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t<GroupedPenalties\r\n\t\t\t\t\t\t\tpenalties={penalties}\r\n\t\t\t\t\t\t\tuser={player.id}\r\n\t\t\t\t\t\t\teditable={true}\r\n\t\t\t\t\t\t\tonClick={(e) => e.stopPropagation()}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t) : null}\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<hr style={{ borderTop: \"1px solid #ddd\", borderBottom: \"0\" }}></hr>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tdisplay: \"grid\",\r\n\t\t\t\t\t\t\tgridTemplateColumns: \"auto 1px auto\",\r\n\t\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\t\tmarginBottom: 0,\r\n\t\t\t\t\t\t\tmarginTop: \".75em\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div style={{ width: \"100%\", textAlign: \"center\" }}>\r\n\t\t\t\t\t\t\t<p\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tmargin: \".5em\",\r\n\t\t\t\t\t\t\t\t\tfontWeight: \"bold\",\r\n\t\t\t\t\t\t\t\t\tcolor: \"#888\",\r\n\t\t\t\t\t\t\t\t\ttextTransform: \"uppercase\",\r\n\t\t\t\t\t\t\t\t\tletterSpacing: \".1em\",\r\n\t\t\t\t\t\t\t\t\tfontSize: \"small\",\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tStrafen\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<p style={{ margin: \".25em\", fontWeight: \"bold\", fontSize: \"large\" }}>{penalties.length}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div style={{ borderRight: \"1px solid #ddd\", height: \"3em\", margin: \"0\" }}></div>\r\n\t\t\t\t\t\t<div style={{ width: \"100%\", textAlign: \"center\" }}>\r\n\t\t\t\t\t\t\t<p\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tmargin: \".25em\",\r\n\t\t\t\t\t\t\t\t\tfontWeight: \"bold\",\r\n\t\t\t\t\t\t\t\t\tcolor: \"#888\",\r\n\t\t\t\t\t\t\t\t\ttextTransform: \"uppercase\",\r\n\t\t\t\t\t\t\t\t\tletterSpacing: \".1em\",\r\n\t\t\t\t\t\t\t\t\tfontSize: \"small\",\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBetrag\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<Currency\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tmargin: \".25em\",\r\n\t\t\t\t\t\t\t\t\tfontWeight: \"bold\",\r\n\t\t\t\t\t\t\t\t\tfontSize: \"large\",\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tval={penalties.reduce((agg, next) => agg + next.value, 0)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</CardContent>\r\n\t\t\t</Card>\r\n\t\t</div>\r\n\t);\r\n};\r\ntype PenaltyDialogType = {\r\n\tpenaltyModalOpen: boolean;\r\n\tsetPenaltyModalOpen: (open: boolean) => any;\r\n\tpenaltyModalPlayer: User;\r\n\tgame: Game;\r\n};\r\ntype AddPenaltyDialogFormValues = {\r\n\tfeeType: string;\r\n\tvalue: number | undefined;\r\n\tquantity: number;\r\n};\r\n\r\nconst AddPenaltyDialog = ({ penaltyModalOpen, setPenaltyModalOpen, penaltyModalPlayer, game }: PenaltyDialogType) => {\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\tconst validationSchema = yup.object({\r\n\t\tfeeType: yup.string().required(),\r\n\t\tvalue: yup.number().positive().required(),\r\n\t\tquantity: yup.number().min(0).required(),\r\n\t});\r\n\tconst formik = useFormik<AddPenaltyDialogFormValues>({\r\n\t\tinitialValues: {\r\n\t\t\tfeeType: \"\",\r\n\t\t\tvalue: undefined,\r\n\t\t\tquantity: 1,\r\n\t\t},\r\n\t\tvalidationSchema,\r\n\t\tonSubmit: (values) => {\r\n\t\t\tconst feeType = feeTypes.find((ft) => ft.id === values.feeType);\r\n\t\t\tif (feeType == null) return;\r\n\t\t\tconst penalties: Penalty[] = [];\r\n\t\t\tfor (let i = 0; i < values.quantity; i++) {\r\n\t\t\t\tconst targets: string[] = [];\r\n\t\t\t\tif (feeType.applicationStrategy === FeeTypeApplicationStrategy.AutoAll) targets.push(...game.users);\r\n\t\t\t\telse if (feeType.applicationStrategy === FeeTypeApplicationStrategy.AllButTarget)\r\n\t\t\t\t\ttargets.push(...game.users.filter((u) => u !== penaltyModalPlayer.id));\r\n\t\t\t\telse if (feeType.applicationStrategy === FeeTypeApplicationStrategy.Target)\r\n\t\t\t\t\ttargets.push(penaltyModalPlayer.id);\r\n\t\t\t\tpenalties.push(\r\n\t\t\t\t\t...targets.map((target) => ({\r\n\t\t\t\t\t\tid: v4(),\r\n\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\tfeeTypeId: feeType.id,\r\n\t\t\t\t\t\tgameId: game.id,\r\n\t\t\t\t\t\tuserId: target,\r\n\t\t\t\t\t\tvalue: parseFloat(values.value?.toString() ?? \"0\"),\r\n\t\t\t\t\t}))\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tdispatch(penaltiesSlice.actions.createMultiple(penalties));\r\n\t\t\tformik.resetForm({\r\n\t\t\t\tvalues: { feeType: \"\", quantity: 1, value: undefined },\r\n\t\t\t\ttouched: { feeType: false, quantity: false, value: false },\r\n\t\t\t\terrors: { feeType: undefined, quantity: undefined, value: undefined },\r\n\t\t\t});\r\n\t\t\tsetPenaltyModalOpen(false);\r\n\t\t},\r\n\t});\r\n\tconst feeTypes = useSelector<AppState>((state) =>\r\n\t\tfeeTypesAdapter.getSelectors().selectAll(state.feeTypes)\r\n\t) as FeeType[];\r\n\treturn (\r\n\t\t<Dialog open={penaltyModalOpen} onClose={() => setPenaltyModalOpen(false)} maxWidth=\"sm\" fullWidth={true}>\r\n\t\t\t<DialogTitle>Strafe fr {penaltyModalPlayer?.fullName ?? \"?\"}</DialogTitle>\r\n\t\t\t<DialogContent>\r\n\t\t\t\t<form onSubmit={formik.handleSubmit}>\r\n\t\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t\t<h4>Strafe</h4>\r\n\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\tid=\"feeType\"\r\n\t\t\t\t\t\t\t\tname=\"feeType\"\r\n\t\t\t\t\t\t\t\terror={formik.touched.feeType && Boolean(formik.errors.feeType)}\r\n\t\t\t\t\t\t\t\tvalue={formik.values.feeType}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tformik.setFieldValue(\"feeType\", e.target.value);\r\n\t\t\t\t\t\t\t\t\tconst feeType = feeTypes.find((ft) => ft.id === e.target.value);\r\n\t\t\t\t\t\t\t\t\tformik.setFieldValue(\"value\", feeType?.value ?? 0);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\trenderValue={() => {\r\n\t\t\t\t\t\t\t\t\treturn <p>{feeTypes.find((ft) => ft.id === formik.values.feeType)?.label}</p>;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{feeTypes\r\n\t\t\t\t\t\t\t\t\t.filter(\r\n\t\t\t\t\t\t\t\t\t\t(ft) =>\r\n\t\t\t\t\t\t\t\t\t\t\tft.applicationStrategy !== FeeTypeApplicationStrategy.AutoAll &&\r\n\t\t\t\t\t\t\t\t\t\t\tft.deleted !== true\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t.sort((a, b) => a.label.localeCompare(b.label))\r\n\t\t\t\t\t\t\t\t\t.map((ft) => (\r\n\t\t\t\t\t\t\t\t\t\t<MenuItem key={ft.id} value={ft.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t{ft.label}\r\n\t\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t<h4>Betrag</h4>\r\n\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t<CurrencyField\r\n\t\t\t\t\t\t\t\tdisabled={(() => {\r\n\t\t\t\t\t\t\t\t\tconst feeType = feeTypes.find((ft) => ft.id === formik.values.feeType);\r\n\t\t\t\t\t\t\t\t\treturn feeType == null || feeType.value != null;\r\n\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\terror={formik.touched.value && Boolean(formik.errors.value)}\r\n\t\t\t\t\t\t\t\thelperText={formik.touched.value && formik.errors.value}\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tvalue={formik.values.value}\r\n\t\t\t\t\t\t\t\tname=\"Value\"\r\n\t\t\t\t\t\t\t\tid=\"value\"\r\n\t\t\t\t\t\t\t\tonChange={(e) => formik.setFieldValue(\"value\", (e.target as any).value)}\r\n\t\t\t\t\t\t\t></CurrencyField>\r\n\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t<h4>Anzahl</h4>\r\n\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tid=\"quantity\"\r\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tdisabled={feeTypes.find((ft) => ft.id === formik.values.feeType)?.value == null}\r\n\t\t\t\t\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\t\t\t\t\tvalue={formik.values.quantity}\r\n\t\t\t\t\t\t\t\tInputProps={{ inputProps: { min: 1 } }}\r\n\t\t\t\t\t\t\t></TextField>\r\n\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t<Button onClick={() => setPenaltyModalOpen(false)}>Abort</Button>\r\n\t\t\t\t\t\t<Button color=\"primary\" type=\"submit\">\r\n\t\t\t\t\t\t\tBesttigen\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t</form>\r\n\t\t\t</DialogContent>\r\n\t\t</Dialog>\r\n\t);\r\n};\r\n\r\nconst FinishGameDialog = ({ game, open, setOpen }: { game: Game; open: boolean; setOpen: (open: boolean) => void }) => {\r\n\tconst notParticipating = useSelector<AppState>((state) =>\r\n\t\tstate.users.ids\r\n\t\t\t.filter((u) => game.users.findIndex((p) => p === u) < 0)\r\n\t\t\t.map((u) => state.users.entities[u])\r\n\t\t\t.filter((u) => u != null && u.deleted !== true)\r\n\t) as User[];\r\n\tconst autoPenalties = useSelector<AppState>((state) =>\r\n\t\tstate.feeTypes.ids\r\n\t\t\t.map((ft) => state.feeTypes.entities[ft])\r\n\t\t\t.filter((ft) => ft?.applicationStrategy === FeeTypeApplicationStrategy.AutoAll)\r\n\t) as FeeType[];\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\tconst [activeFinishGameStep, setActiveFinishGameStep] = useState(0);\r\n\tconst [defaultPenaltiesEnabled, setDefaultPenaltiesEnabled] = useState(true);\r\n\tconst averagePenalty = useSelector<AppState>((state) => {\r\n\t\tconst gamePenalties = state.penalties.ids\r\n\t\t\t.map((p) => state.penalties.entities[p])\r\n\t\t\t.filter((p) => p?.gameId === game.id);\r\n\t\treturn (\r\n\t\t\tgamePenalties.reduce((agg, p) => agg + (p?.value ?? 0), 0) / game.users.length +\r\n\t\t\t(defaultPenaltiesEnabled ? autoPenalties.reduce((agg, p) => agg + (p.value ?? 0), 0) : 0)\r\n\t\t);\r\n\t}) as number;\r\n\tconst autoFeeTypes = useSelector<AppState>((state) =>\r\n\t\tfeeTypesAdapter\r\n\t\t\t.getSelectors()\r\n\t\t\t.selectAll(state.feeTypes)\r\n\t\t\t.filter((ft) => ft.applicationStrategy === FeeTypeApplicationStrategy.AutoAll)\r\n\t) as FeeType[];\r\n\tconst transactionCount = useSelector<AppState>((state) =>\r\n\t\ttransactionsAdapter.getSelectors().selectTotal(state.transactions)\r\n\t) as number;\r\n\tconst players = useSelector<AppState>(gameSelectors.players(game.id)) as User[];\r\n\tconst penalties = useSelector<AppState>(gameSelectors.penalties(game.id)) as Penalty[];\r\n\tconst finishGame = (withAutoPenalties: boolean) => {\r\n\t\tif (penalties.length === 0 && autoFeeTypes.length === 0) {\r\n\t\t\tdispatch(gamesSlice.actions.abortGame());\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdispatch(gamesSlice.actions.finishGame());\r\n\t\tfor (const player of players) {\r\n\t\t\tconst userPenalties = [...penalties.filter((pen) => pen.userId === player.id)];\r\n\t\t\tif (withAutoPenalties) {\r\n\t\t\t\tconst autoPenalties = autoFeeTypes.map((autoFee) => ({\r\n\t\t\t\t\tid: v4(),\r\n\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\tfeeTypeId: autoFee.id,\r\n\t\t\t\t\tgameId: game.id,\r\n\t\t\t\t\tuserId: player.id,\r\n\t\t\t\t\tvalue: autoFee.value ?? 0,\r\n\t\t\t\t}));\r\n\t\t\t\tdispatch(penaltiesSlice.actions.createMultiple(autoPenalties));\r\n\t\t\t\tuserPenalties.push(...autoPenalties);\r\n\t\t\t}\r\n\t\t\tconst value = userPenalties.reduce((agg, next) => agg + next.value, 0);\r\n\t\t\tif (userPenalties.length === 0 || value === 0) continue;\r\n\t\t\tconst transactionId = v4();\r\n\t\t\tdispatch(\r\n\t\t\t\ttransactionsSlice.actions.create({\r\n\t\t\t\t\taffectsGlobalLedger: false,\r\n\t\t\t\t\taffectsUserLedger: true,\r\n\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\tdescription: \"Strafen aus \" + game.name,\r\n\t\t\t\t\tid: transactionId,\r\n\t\t\t\t\tname: \"TRANS-\" + (transactionCount + 1).toString().padStart(4, \"0\"),\r\n\t\t\t\t\tuserId: player.id,\r\n\t\t\t\t\tvalue: -value,\r\n\t\t\t\t\tpenalties: userPenalties.map((up) => up.id),\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (averagePenalty > 0) {\r\n\t\t\tfor (const absent of notParticipating) {\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\ttransactionsSlice.actions.create({\r\n\t\t\t\t\t\taffectsGlobalLedger: false,\r\n\t\t\t\t\t\taffectsUserLedger: true,\r\n\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\tdescription: \"Strafe fr Abwesenheit bei \" + game.name,\r\n\t\t\t\t\t\tid: v4(),\r\n\t\t\t\t\t\tname: \"TRANS-\" + (transactionCount + 1).toString().padStart(4, \"0\"),\r\n\t\t\t\t\t\tuserId: absent.id,\r\n\t\t\t\t\t\tvalue: (-averagePenalty * (absent.absencePenaltyPercentage ?? 50)) / 100,\r\n\t\t\t\t\t\tpenalties: [],\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn (\r\n\t\t<Dialog open={open} onClose={() => setOpen(false)} maxWidth=\"sm\" fullWidth>\r\n\t\t\t<DialogTitle>Spiel Abschlieen</DialogTitle>\r\n\t\t\t<Stepper activeStep={notParticipating.length > 0 ? activeFinishGameStep : 1}>\r\n\t\t\t\t<Step>\r\n\t\t\t\t\t<StepLabel>Gebhren</StepLabel>\r\n\t\t\t\t</Step>\r\n\t\t\t\t<Step>\r\n\t\t\t\t\t<StepLabel>Strafen fr Abwesende</StepLabel>\r\n\t\t\t\t</Step>\r\n\t\t\t</Stepper>\r\n\t\t\t<DialogContent>\r\n\t\t\t\t{activeFinishGameStep === 0 ? (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tBestimme ob folgende Gebhren (automatische Strafen) fr dieses Spiel angerechnet werden\r\n\t\t\t\t\t\t\tsollen.\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t{autoPenalties.map((p) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<ListItem>\r\n\t\t\t\t\t\t\t\t\t\t{p.label} ({formatCurrency(p.value ?? 0)})\r\n\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t<FormControlLabel\r\n\t\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t\tdefaultPenaltiesEnabled\r\n\t\t\t\t\t\t\t\t\t? \"Gebhren werden angerechnet\"\r\n\t\t\t\t\t\t\t\t\t: \"Gebhren werden nicht angerechnet\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlabelPlacement=\"end\"\r\n\t\t\t\t\t\t\tcontrol={\r\n\t\t\t\t\t\t\t\t<Switch\r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\tchecked={defaultPenaltiesEnabled}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setDefaultPenaltiesEnabled(e.target.checked)}\r\n\t\t\t\t\t\t\t\t></Switch>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t></FormControlLabel>\r\n\r\n\t\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t\t<Button variant=\"text\" onClick={() => setOpen(false)}>\r\n\t\t\t\t\t\t\t\tAbbrechen\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tvariant=\"text\"\r\n\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsetActiveFinishGameStep(1);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tWeiter\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</DialogActions>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tVerteile Strafen fr abwesende Personen. Die Hhe wird dabei prozentual respektive der\r\n\t\t\t\t\t\t\tdurchschnittlichen Strafe in diesem Spiel angerechnet. Der Prozentsatz wird hierbei durch\r\n\t\t\t\t\t\t\tdie Qualitt der Ausrede bestimmt. <br />\r\n\t\t\t\t\t\t\tDie durchschnittliche Strafe betrgt <b>{formatCurrency(averagePenalty ?? 0)}</b>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t{notParticipating.map((p) => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\t\t\t\tstyle={{ display: \"flex\", gap: \"1em\", alignItems: \"center\", width: \"100%\" }}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Avatar title={p.fullName} style={{ backgroundColor: p.color }}>\r\n\t\t\t\t\t\t\t\t\t\t{p.abbreviation}\r\n\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t<p>{p.fullName}</p>\r\n\t\t\t\t\t\t\t\t\t<p style={{ marginLeft: \"auto\" }}>{p.absencePenaltyPercentage ?? 50}%</p>\r\n\t\t\t\t\t\t\t\t\t<Slider\r\n\t\t\t\t\t\t\t\t\t\tvalueLabelDisplay=\"auto\"\r\n\t\t\t\t\t\t\t\t\t\tonChange={(_, v) =>\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\t\t\t\t\t\t\tusersSlice.actions.update({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: p.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchanges: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tabsencePenaltyPercentage: typeof v === \"number\" ? v : v[0],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tvalue={p.absencePenaltyPercentage ?? 50}\r\n\t\t\t\t\t\t\t\t\t\tmin={0}\r\n\t\t\t\t\t\t\t\t\t\tmax={100}\r\n\t\t\t\t\t\t\t\t\t\tstep={50}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ width: \"5em\" }}\r\n\t\t\t\t\t\t\t\t\t\tmarks\r\n\t\t\t\t\t\t\t\t\t></Slider>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t{notParticipating.length === 0 && <p>Keine abwesenden Spieler</p>}\r\n\t\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t\t<Button variant=\"text\" onClick={() => setActiveFinishGameStep(0)}>\r\n\t\t\t\t\t\t\t\tZurck\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tvariant=\"text\"\r\n\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tfinishGame(defaultPenaltiesEnabled);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tBesttigen\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</DialogActions>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</DialogContent>\r\n\t\t</Dialog>\r\n\t);\r\n};\r\n\r\nconst ExistingCurrentGame = ({ game }: { game: Game }) => {\r\n\tconst notParticipating = useSelector<AppState>((state) =>\r\n\t\tstate.users.ids\r\n\t\t\t.filter((u) => game.users.findIndex((p) => p === u) < 0)\r\n\t\t\t.map((u) => state.users.entities[u])\r\n\t\t\t.filter((u) => u != null && u.deleted !== true)\r\n\t) as User[];\r\n\tconst [showFinishGameDialog, setShowFinishGameDialog] = useState(false);\r\n\tconst players = useSelector<AppState>(gameSelectors.players(game.id)) as User[];\r\n\tconst penalties = useSelector<AppState>(gameSelectors.penalties(game.id)) as Penalty[];\r\n\r\n\tconst [penaltyModalOpen, setPenaltyModalOpen] = useState(false);\r\n\tconst [penaltyModalPlayer, setPenaltyModalPlayer] = useState(null as unknown as User);\r\n\r\n\tconst openAddPenalty = (player: User) => {\r\n\t\tsetPenaltyModalPlayer(player);\r\n\t\tsetPenaltyModalOpen(true);\r\n\t};\r\n\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t<h1>{game.name}</h1>\r\n\t\t\t\t<ConfirmationDialog\r\n\t\t\t\t\ttitle=\"Spiel abbrechen\"\r\n\t\t\t\t\tmessage=\"Spiel wirklich abbrechen? Alle bisher verteilten Strafen werden gelscht.\"\r\n\t\t\t\t\tonConfirm={() => {\r\n\t\t\t\t\t\tdispatch(gamesSlice.actions.abortGame());\r\n\t\t\t\t\t\tdispatch(penaltiesSlice.actions.deleteMultiple(penalties.map((p) => p.id)));\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcomponent={<Button variant=\"text\">Abbrechen</Button>}\r\n\t\t\t\t></ConfirmationDialog>\r\n\t\t\t\t{players.length > 0 && (\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\tstyle={{ color: \"red\", borderColor: \"red\" }}\r\n\t\t\t\t\t\tonClick={() => setShowFinishGameDialog(true)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tSpiel Abschlieen\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t\t<FinishGameDialog\r\n\t\t\t\t\topen={showFinishGameDialog}\r\n\t\t\t\t\tsetOpen={setShowFinishGameDialog}\r\n\t\t\t\t\tgame={game}\r\n\t\t\t\t></FinishGameDialog>\r\n\t\t\t</div>\r\n\t\t\t<div style={{ margin: \"0em 1em 1em\", alignItems: \"center\" }}>\r\n\t\t\t\t{notParticipating.length > 0 ? (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h4 style={{ marginBottom: \".5em\" }}>Spieler hinzufgen</h4>\r\n\t\t\t\t\t\t<div style={{ display: \"flex\", columnGap: \"1em\" }}>\r\n\t\t\t\t\t\t\t{notParticipating.map((u) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\tkey={u.id}\r\n\t\t\t\t\t\t\t\t\t\ttitle={u.fullName}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ backgroundColor: u.color }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tdispatch(gamesSlice.actions.addPlayerToOpenGame({ userId: u.id }));\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{u.abbreviation}\r\n\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t) : null}\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tdisplay: \"grid\",\r\n\t\t\t\t\t\tgridTemplateColumns: \"repeat(auto-fit, minmax(300px, 1fr))\",\r\n\t\t\t\t\t\tgap: \"2em\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{players.map((p) => (\r\n\t\t\t\t\t\t<PlayerCard game={game} player={p} key={p.id} openAddPenalty={openAddPenalty} />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<AddPenaltyDialog\r\n\t\t\t\tpenaltyModalOpen={penaltyModalOpen}\r\n\t\t\t\tpenaltyModalPlayer={penaltyModalPlayer}\r\n\t\t\t\tsetPenaltyModalOpen={setPenaltyModalOpen}\r\n\t\t\t\tgame={game}\r\n\t\t\t></AddPenaltyDialog>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst CurrentGameForm = () => {\r\n\tconst activeGame = useSelector<AppState>(gameSelectors.openGame) as Game;\r\n\treturn (\r\n\t\t<div className=\"zsku-panel\">\r\n\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t{activeGame == null ? <NoCurrentGame /> : <ExistingCurrentGame game={activeGame} />}\r\n\t\t\t</Paper>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ntype ClosedGameRouterParams = {\r\n\tgameId: string;\r\n};\r\nconst ClosedGameForm = withRouter((router: RouteComponentProps<ClosedGameRouterParams>) => {\r\n\tconst game = useSelector<AppState>((state) => gameSelectors.gameById(state, router.match.params.gameId)) as Game;\r\n\tconst penalties = useSelector<AppState>(gameSelectors.penalties(game?.id)) as Penalty[];\r\n\tconst feeTypes = useSelector<AppState>((state) =>\r\n\t\tfeeTypesAdapter.getSelectors().selectEntities(state.feeTypes)\r\n\t) as Dictionary<FeeType>;\r\n\tconst players = useSelector<AppState>((state) => game?.users.map((id) => state.users.entities[id])) as User[];\r\n\treturn (\r\n\t\t<div className=\"zsku-panel\">\r\n\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>{game?.name ?? \"Spiel nicht gefunden\"}</h1>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t<h4>Gespielt am</h4>\r\n\t\t\t\t\t<p>{new Date(game?.createdOn).toLocaleDateString(\"de-DE\")}</p>\r\n\r\n\t\t\t\t\t<h4>Strafen</h4>\r\n\t\t\t\t\t<p>{penalties.length}</p>\r\n\r\n\t\t\t\t\t<h4>Gesamtbetrag</h4>\r\n\t\t\t\t\t<Currency\r\n\t\t\t\t\t\tval={penalties.reduce((agg, next) => agg + next.value, 0)}\r\n\t\t\t\t\t\tstyle={{ margin: 0 }}\r\n\t\t\t\t\t></Currency>\r\n\t\t\t\t\t<h4>Durchschnitt</h4>\r\n\t\t\t\t\t<Currency\r\n\t\t\t\t\t\tval={penalties.reduce((agg, next) => agg + next.value, 0) / (players?.length ?? 1)}\r\n\t\t\t\t\t\tstyle={{ margin: 0 }}\r\n\t\t\t\t\t></Currency>\r\n\t\t\t\t</div>\r\n\t\t\t\t{players?.length > 0 ? (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h3>Mitspieler</h3>\r\n\t\t\t\t\t\t<GenericTable<User>\r\n\t\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\t\t\t\t\tdata: (row) => <Link to={\"/zsku-mgmt/users/\" + row.id}>{row.fullName}</Link>,\r\n\t\t\t\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\t\tsort: (a, b) => a.fullName.localeCompare(b.fullName),\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_penaltycount\",\r\n\t\t\t\t\t\t\t\t\tname: \"Strafen\",\r\n\t\t\t\t\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t\t\t\t\t<p style={{ margin: 0 }}>{penalties.filter((p) => p.userId === r.id).length}</p>\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\t\tsort: (a, b) => {\r\n\t\t\t\t\t\t\t\t\t\tconst aCount = penalties.filter((p) => p.userId === a.id).length;\r\n\t\t\t\t\t\t\t\t\t\tconst bCount = penalties.filter((p) => p.userId === b.id).length;\r\n\t\t\t\t\t\t\t\t\t\treturn aCount - bCount;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_penaltysum\",\r\n\t\t\t\t\t\t\t\t\tname: \"Gesamtbetrag\",\r\n\t\t\t\t\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t\t\t\t\t<Currency\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ margin: 0 }}\r\n\t\t\t\t\t\t\t\t\t\t\tval={penalties\r\n\t\t\t\t\t\t\t\t\t\t\t\t.filter((p) => p.userId === r.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.reduce((agg, next) => agg + next.value, 0)}\r\n\t\t\t\t\t\t\t\t\t\t></Currency>\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\t\tsort: (a, b) => {\r\n\t\t\t\t\t\t\t\t\t\tconst aSum = penalties\r\n\t\t\t\t\t\t\t\t\t\t\t.filter((p) => p.userId === a.id)\r\n\t\t\t\t\t\t\t\t\t\t\t.reduce((agg, next) => agg + next.value, 0);\r\n\t\t\t\t\t\t\t\t\t\tconst bSum = penalties\r\n\t\t\t\t\t\t\t\t\t\t\t.filter((p) => p.userId === b.id)\r\n\t\t\t\t\t\t\t\t\t\t\t.reduce((agg, next) => agg + next.value, 0);\r\n\t\t\t\t\t\t\t\t\t\treturn aSum - bSum;\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: \"col_penaltyfav\",\r\n\t\t\t\t\t\t\t\t\tname: \"Am hufigsten\",\r\n\t\t\t\t\t\t\t\t\tdata: (r) => (\r\n\t\t\t\t\t\t\t\t\t\t<p style={{ margin: 0 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst userPenalties = penalties.filter((p) => p.userId === r.id);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (userPenalties.length === 0) return \"Keine Strafe\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst [feeTypeId] =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxBy(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tentries(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcountBy(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpenalties.filter((p) => p.userId === r.id),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(p) => p.feeTypeId\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(entry) => last(entry)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) ?? [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (feeTypeId == null) return \"N/A\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst feeType = feeTypes[feeTypeId];\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (feeType == null) return \"N/A\";\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfeeType.label +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t` (${formatCurrency(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserPenalties\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter((p) => p.feeTypeId === feeType.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.reduce((agg, next) => agg + next.value, 0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)})`\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\t\t\t\t\torderable: false,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\trows={players ?? []}\r\n\t\t\t\t\t\t\tentriesPerPage={players?.length ?? 0}\r\n\t\t\t\t\t\t></GenericTable>\r\n\t\t\t\t\t</>\r\n\t\t\t\t) : null}\r\n\t\t\t</Paper>\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nconst ClosedGamesList = () => {\r\n\tconst closedGames = (useSelector<AppState>(gameSelectors.closedGames) as Game[]).sort(\r\n\t\t(a, b) => b.createdOn - a.createdOn\r\n\t);\r\n\tconst penalties = useSelector<AppState>((state) =>\r\n\t\tpenaltiesAdapter.getSelectors().selectAll(state.penalties)\r\n\t) as Penalty[];\r\n\tconst users = useSelector<AppState>((state) =>\r\n\t\tusersAdapter.getSelectors().selectEntities(state.users)\r\n\t) as Dictionary<User>;\r\n\treturn (\r\n\t\t<div className=\"zsku-panel\">\r\n\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t<h1>Beendete Spiele</h1>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<GenericTable<Game>\r\n\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: \"col_name\",\r\n\t\t\t\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\t\t\t\tdata: (r) => <Link to={\"/zsku-mgmt/games/\" + r.id}>{r.name}</Link>,\r\n\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\tsort: (a, b) => a.name.localeCompare(b.name),\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: \"col_users\",\r\n\t\t\t\t\t\t\t\tname: \"Mitspieler\",\r\n\t\t\t\t\t\t\t\tdata: (r) => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div style={{ display: \"flex\", flexWrap: \"wrap\", gap: \"10px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{(r.users.map((u) => users[u]).filter(Boolean) as User[])\r\n\t\t\t\t\t\t\t\t\t\t\t\t.sort((a, b) => a.abbreviation.localeCompare(b.abbreviation, \"de-DE\"))\r\n\t\t\t\t\t\t\t\t\t\t\t\t.map((u) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={\"users/\" + (u?.id ?? \"0\")} key={v4()}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={v4()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: \"normal\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: u.color,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{u.abbreviation}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: \"col_totalpenalties\",\r\n\t\t\t\t\t\t\t\tname: \"Strafen (Anzahl)\",\r\n\t\t\t\t\t\t\t\tdata: (r) => penalties.filter((p) => p.gameId === r.id).length.toString(),\r\n\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\tsort: (a, b) => {\r\n\t\t\t\t\t\t\t\t\tconst aCount = penalties.filter((p) => p.gameId === a.id).length;\r\n\t\t\t\t\t\t\t\t\tconst bCount = penalties.filter((p) => p.gameId === b.id).length;\r\n\t\t\t\t\t\t\t\t\treturn aCount - bCount;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: \"col_sumpenalties\",\r\n\t\t\t\t\t\t\t\tname: \"Strafen (Summe)\",\r\n\t\t\t\t\t\t\t\tdata: (r) =>\r\n\t\t\t\t\t\t\t\t\tformatCurrency(\r\n\t\t\t\t\t\t\t\t\t\tpenalties.filter((p) => p.gameId === r.id).reduce((agg, p) => agg + p.value, 0)\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\tsort: (a, b) => {\r\n\t\t\t\t\t\t\t\t\tconst aSum = penalties\r\n\t\t\t\t\t\t\t\t\t\t.filter((p) => p.gameId === a.id)\r\n\t\t\t\t\t\t\t\t\t\t.reduce((agg, p) => agg + p.value, 0);\r\n\t\t\t\t\t\t\t\t\tconst bSum = penalties\r\n\t\t\t\t\t\t\t\t\t\t.filter((p) => p.gameId === b.id)\r\n\t\t\t\t\t\t\t\t\t\t.reduce((agg, p) => agg + p.value, 0);\r\n\t\t\t\t\t\t\t\t\treturn aSum - bSum;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: \"col_date\",\r\n\t\t\t\t\t\t\t\tname: \"Gespielt am\",\r\n\t\t\t\t\t\t\t\tdata: (r) => new Date(r.createdOn).toLocaleDateString(\"de-DE\"),\r\n\t\t\t\t\t\t\t\torderable: true,\r\n\t\t\t\t\t\t\t\tsort: (a, b) => a.createdOn - b.createdOn,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\trows={closedGames}\r\n\t\t\t\t\t\tentriesPerPage={10}\r\n\t\t\t\t\t></GenericTable>\r\n\t\t\t\t</div>\r\n\t\t\t</Paper>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst Games = () => {\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<CurrentGameForm />\r\n\t\t\t<ClosedGamesList />\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport { ClosedGameForm, GroupedPenalties };\r\nexport default Games;\r\n","import {\r\n\tAvatar,\r\n\tButton,\r\n\tChip,\r\n\tFormControl,\r\n\tMenuItem,\r\n\tOutlinedInput,\r\n\tPaper,\r\n\tSelect,\r\n\tTextField,\r\n} from \"@material-ui/core\";\r\nimport { EntityState } from \"@reduxjs/toolkit\";\r\nimport { useFormik } from \"formik\";\r\nimport React from \"react\";\r\nimport { FaMoneyBillWave, FaUser } from \"react-icons/fa\";\r\nimport { GoLaw } from \"react-icons/go\";\r\nimport { ImFloppyDisk } from \"react-icons/im\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, RouteComponentProps, useHistory, withRouter } from \"react-router-dom\";\r\nimport { v4 } from \"uuid\";\r\nimport * as yup from \"yup\";\r\nimport { Penalty, Role, Transaction, User } from \"../../entities/entities\";\r\nimport { penaltiesAdapter } from \"../../redux/reducers/penalties\";\r\nimport { usersAdapter, usersSlice } from \"../../redux/reducers/users\";\r\nimport { AppDispatch, AppState } from \"../../redux/store\";\r\nimport * as colors from \"../common/colors\";\r\nimport { Balance, Currency } from \"../common/currency\";\r\nimport { GroupedPenalties } from \"../games/games\";\r\nimport { TransactionTable } from \"../ledgers/transactionsTable\";\r\ninterface RouterProps {\r\n\tuserId: string;\r\n}\r\n\r\ninterface UserFormValues {\r\n\tfullName: string;\r\n\tcolor: string;\r\n\troles: string[];\r\n}\r\n\r\nconst UserForm = withRouter((router: RouteComponentProps<RouterProps>) => {\r\n\tconst user = useSelector<AppState>((state) =>\r\n\t\tusersAdapter.getSelectors<AppState>((state) => state.users).selectById(state, router.match.params.userId)\r\n\t) as User;\r\n\tconst roles = useSelector<AppState>((state) => state.roles) as EntityState<Role>;\r\n\tconst transactions = useSelector<AppState>((state) =>\r\n\t\tstate.transactions.ids\r\n\t\t\t.map((tid) => state.transactions.entities[tid])\r\n\t\t\t.filter((t) => user != null && t?.userId === user.id)\r\n\t) as Transaction[];\r\n\tconst userPenalties = useSelector<AppState>(\r\n\t\t(state) =>\r\n\t\t\tuser != null &&\r\n\t\t\tpenaltiesAdapter\r\n\t\t\t\t.getSelectors()\r\n\t\t\t\t.selectAll(state.penalties)\r\n\t\t\t\t.filter((p) => p.userId === user.id)\r\n\t) as Penalty[];\r\n\tconst dispatch = useDispatch<AppDispatch>();\r\n\tconst history = useHistory();\r\n\tconst validationSchema = yup.object({\r\n\t\tfullName: yup.string().required(\"Der Nutzername ist erforderlich\"),\r\n\t\tcolor: yup\r\n\t\t\t.string()\r\n\t\t\t.matches(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/, \"Bitte die Farbe als gltigen Hexcode eingeben\"),\r\n\t});\r\n\tconst formik = useFormik<UserFormValues>({\r\n\t\tinitialValues: {\r\n\t\t\tfullName: user?.fullName ?? \"\",\r\n\t\t\tcolor: user?.color ?? \"\",\r\n\t\t\troles: user?.roles ?? [],\r\n\t\t},\r\n\t\tvalidationSchema,\r\n\t\tonSubmit: (values) => {\r\n\t\t\tconst isCreate = router.match.params.userId === \"new\";\r\n\t\t\tif (isCreate) {\r\n\t\t\t\tconst newUserId = v4();\r\n\t\t\t\tconst chosenColor = values.color || colors.colors[Math.floor(Math.random() * colors.colors.length)];\r\n\t\t\t\tif (!values.color) formik.setFieldValue(\"color\", chosenColor);\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\tusersSlice.actions.create({\r\n\t\t\t\t\t\tfullName: values.fullName,\r\n\t\t\t\t\t\tcolor: chosenColor,\r\n\t\t\t\t\t\tabbreviation:\r\n\t\t\t\t\t\t\tvalues.fullName == null || values.fullName === \"\"\r\n\t\t\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t\t\t: values.fullName\r\n\t\t\t\t\t\t\t\t\t\t.split(\" \")\r\n\t\t\t\t\t\t\t\t\t\t.filter((s) => s.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t.map((s) => s[0])\r\n\t\t\t\t\t\t\t\t\t\t.join(\"\"),\r\n\t\t\t\t\t\tid: newUserId,\r\n\t\t\t\t\t\tcreatedOn: Date.now(),\r\n\t\t\t\t\t\troles: values.roles,\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\thistory.push({ pathname: \"/zsku-mgmt/users/\" + newUserId });\r\n\t\t\t} else {\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\tusersSlice.actions.update({\r\n\t\t\t\t\t\tid: router.match.params.userId,\r\n\t\t\t\t\t\tchanges: {\r\n\t\t\t\t\t\t\tfullName: values.fullName,\r\n\t\t\t\t\t\t\tcolor: values.color,\r\n\t\t\t\t\t\t\tabbreviation:\r\n\t\t\t\t\t\t\t\tvalues.fullName == null || values.fullName === \"\"\r\n\t\t\t\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t\t\t\t: values.fullName\r\n\t\t\t\t\t\t\t\t\t\t\t.split(\" \")\r\n\t\t\t\t\t\t\t\t\t\t\t.filter((s) => s.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t\t.map((s) => s[0])\r\n\t\t\t\t\t\t\t\t\t\t\t.join(\"\"),\r\n\t\t\t\t\t\t\troles: values.roles ?? [],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n\tconst getAbbreviation = (name: string) => {\r\n\t\treturn name\r\n\t\t\t.split(\" \")\r\n\t\t\t.filter((s) => s.length > 0)\r\n\t\t\t.map((s) => s[0])\r\n\t\t\t.join(\"\");\r\n\t};\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t<h1>{user?.fullName ?? \"Neues Mitglied\"}</h1>\r\n\t\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t\t<FaUser size=\"4em\" style={{ backgroundColor: colors.blue }} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<form onSubmit={formik.handleSubmit}>\r\n\t\t\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t\t\t<h4>Name</h4>\r\n\t\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\t\terror={formik.touched.fullName && Boolean(formik.errors.fullName)}\r\n\t\t\t\t\t\t\t\t\thelperText={formik.touched.fullName && formik.errors.fullName}\r\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tname=\"fullName\"\r\n\t\t\t\t\t\t\t\t\tid=\"fullName\"\r\n\t\t\t\t\t\t\t\t\tvalue={formik.values.fullName}\r\n\t\t\t\t\t\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\t\t\t\t\t></TextField>\r\n\t\t\t\t\t\t\t</FormControl>\r\n\r\n\t\t\t\t\t\t\t{user != null ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<h4>Abkrzung</h4>\r\n\t\t\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"abbreviation\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"abbreviation\"\r\n\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\tformik.values.fullName == null || formik.values.fullName === \"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: getAbbreviation(formik.values.fullName)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t></TextField>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t\t<h4>Farbe</h4>\r\n\t\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t\t<OutlinedInput\r\n\t\t\t\t\t\t\t\t\terror={formik.touched.color && Boolean(formik.errors.color)}\r\n\t\t\t\t\t\t\t\t\tendAdornment={\r\n\t\t\t\t\t\t\t\t\t\t<Avatar style={{ backgroundColor: formik.values.color }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{getAbbreviation(formik.values.fullName)}\r\n\t\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// helperText={formik.touched.color && formik.errors.color}\r\n\t\t\t\t\t\t\t\t\tname=\"color\"\r\n\t\t\t\t\t\t\t\t\tid=\"color\"\r\n\t\t\t\t\t\t\t\t\tvalue={formik.values.color}\r\n\t\t\t\t\t\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\t\t\t\t\t></OutlinedInput>\r\n\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t{user != null ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<h4>Erstellt am</h4>\r\n\t\t\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\tname=\"createdOn\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"createdOn\"\r\n\t\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\t\t\tvalue={new Date(user.createdOn).toLocaleDateString(\"de-DE\")}\r\n\t\t\t\t\t\t\t\t\t></TextField>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : null}\r\n\r\n\t\t\t\t\t\t\t<h4>Posten</h4>\r\n\t\t\t\t\t\t\t<FormControl>\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t\t\tvalue={formik.values.roles}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => formik.setFieldValue(\"roles\", e.target.value)}\r\n\t\t\t\t\t\t\t\t\t// input={<Input id=\"select-multiple-chip\" />}\r\n\t\t\t\t\t\t\t\t\trenderValue={(selected) => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(selected as string[]).map((value) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonMouseDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={value}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={roles.entities[value]?.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ margin: \"5px 10px 0 0\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDelete={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformik.setFieldValue(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"roles\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformik.values.roles.filter((sr) => sr !== value)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tMenuProps={{\r\n\t\t\t\t\t\t\t\t\t\tPaperProps: {\r\n\t\t\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tmaxHeight: \"30vh\",\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{roles.ids.map((rId) => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<MenuItem key={rId} value={rId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{roles.entities[rId]?.name ?? \"Unknown\"}\r\n\t\t\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t<div className=\"gridSpacer\"></div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<FormControl style={{ float: \"right\" }}>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"formSubmit\"\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\tstartIcon={<ImFloppyDisk size=\".75em\" />}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tSpeichern\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</Paper>\r\n\t\t\t</div>\r\n\t\t\t{router.match.params.userId === \"new\" ? null : (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t\t\t<h1>Strafen</h1>\r\n\t\t\t\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t\t\t\t<GoLaw size=\"4em\" style={{ backgroundColor: colors.orange }} />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t\t\t\t<h4>Gesamt</h4>\r\n\t\t\t\t\t\t\t\t<Currency\r\n\t\t\t\t\t\t\t\t\tval={(userPenalties ?? []).reduce((agg, next) => {\r\n\t\t\t\t\t\t\t\t\t\treturn agg + (next.value ?? 0);\r\n\t\t\t\t\t\t\t\t\t}, 0)}\r\n\t\t\t\t\t\t\t\t></Currency>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<GroupedPenalties penalties={userPenalties ?? []}></GroupedPenalties>\r\n\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"zsku-panel\">\r\n\t\t\t\t\t\t<Paper elevation={3} className=\"zsku-panel\">\r\n\t\t\t\t\t\t\t<div className=\"zsku-panelHeading\">\r\n\t\t\t\t\t\t\t\t<h1>Transaktionen</h1>\r\n\t\t\t\t\t\t\t\t<Link to={\"/zsku-mgmt/transactions/new/\" + router.match.params.userId}>\r\n\t\t\t\t\t\t\t\t\t<Button variant=\"text\" color=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\tHinzufgen\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t\t\t\t\t<FaMoneyBillWave size=\"4em\" style={{ backgroundColor: colors.yellow }} />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"zsku-keyValueGrid\">\r\n\t\t\t\t\t\t\t\t<h4>Kassenbestand</h4>\r\n\t\t\t\t\t\t\t\t<Balance\r\n\t\t\t\t\t\t\t\t\tval={transactions.reduce((agg, next) => {\r\n\t\t\t\t\t\t\t\t\t\treturn agg + (next.value ?? 0);\r\n\t\t\t\t\t\t\t\t\t}, 0)}\r\n\t\t\t\t\t\t\t\t></Balance>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<TransactionTable transactions={transactions}></TransactionTable>\r\n\t\t\t\t\t\t</Paper>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport default UserForm;\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { GiBowlingStrike, GiMoneyStack, GiCog } from \"react-icons/gi\";\r\nexport type SidebarLinkParameters = {\r\n\troute: string;\r\n\tlabel: string;\r\n};\r\nexport function SidebarLinks() {\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<ul>\r\n\t\t\t\t<Link to={\"/zsku-mgmt/games\"}>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<GiBowlingStrike size=\"1.75em\" />\r\n\t\t\t\t\t\t<h4>Spiele</h4>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</Link>\r\n\t\t\t\t<Link to={\"/zsku-mgmt/ledgers\"}>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<GiMoneyStack size=\"1.75em\" />\r\n\t\t\t\t\t\t<h4>Kasse</h4>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</Link>\r\n\t\t\t\t<Link to={\"/zsku-mgmt/settings\"}>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<GiCog size=\"1.75em\" />\r\n\t\t\t\t\t\t<h4>Einstellungen</h4>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</Link>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { Avatar } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { connect, useSelector } from \"react-redux\";\r\nimport { Role, User } from \"../entities/entities\";\r\nimport { AppState } from \"../redux/store\";\r\nfunction SidebarUserLogo({ abbreviation, color }: { abbreviation: string; color: string }) {\r\n\treturn (\r\n\t\t<Avatar style={{ backgroundColor: color }}>{abbreviation}</Avatar>\r\n\t);\r\n}\r\n\r\nconst SidebarUser = ({ user }: { user: User }) => {\r\n\tconst userRoles = useSelector<AppState>((state) =>\r\n\t\tuser?.roles.map(r => state.roles.entities[r])\r\n\t) as Role[] ?? [];\r\n\tif (user == null)\r\n\t\treturn (\r\n\t\t\t<div className=\"sidebarUser\">\r\n\t\t\t\t<p>Loading ...</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\treturn (\r\n\t\t<div className=\"sidebarUser\">\r\n\t\t\t<SidebarUserLogo color={user?.color} abbreviation={user?.abbreviation} />\r\n\t\t\t<div className=\"sidebarUserInfo\">\r\n\t\t\t\t<h1>{user?.fullName}</h1>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{userRoles\r\n\t\t\t\t\t\t.slice(0, 3)\r\n\t\t\t\t\t\t.map((r) => r.name)\r\n\t\t\t\t\t\t.join(\", \")}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default connect()(SidebarUser);\r\n","import { IconButton } from \"@material-ui/core\";\r\nimport React, { useState } from \"react\";\r\nimport { BsChevronDoubleLeft, BsChevronDoubleRight } from \"react-icons/bs\";\r\nimport { User } from \"../entities/entities\";\r\nimport { SidebarLinks } from \"./links\";\r\nimport SidebarUser from \"./user\";\r\n\r\nexport const Sidebar = ({ user }: { user: User }) => {\r\n\tconst [minimized, setMinimized] = useState(false);\r\n\treturn (\r\n\t\t<aside className={\"sidebar\" + (minimized ? \" minimized\" : \"\")}>\r\n\t\t\t<SidebarUser user={user}></SidebarUser>\r\n\t\t\t<SidebarLinks />\r\n\t\t\t<IconButton\r\n\t\t\t\tclassName=\"minimize\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetMinimized(!minimized);\r\n\t\t\t\t}}>\r\n\t\t\t\t{minimized ? (\r\n\t\t\t\t\t<BsChevronDoubleRight></BsChevronDoubleRight>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<BsChevronDoubleLeft></BsChevronDoubleLeft>\r\n\t\t\t\t)}\r\n\t\t\t</IconButton>\r\n\t\t</aside>\r\n\t);\r\n};\r\n","import React from \"react\";\r\nimport { connect, useSelector } from \"react-redux\";\r\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport \"./css/App.scss\";\r\nimport { User } from \"./entities/entities\";\r\nimport { Landing } from \"./main/landing/landing\";\r\nimport Ledgers from \"./main/ledgers/ledgers\";\r\nimport TransactionForm from \"./main/ledgers/transactionForm\";\r\nimport Settings from \"./main/settings/settings\";\r\nimport Games, { ClosedGameForm } from \"./main/games/games\";\r\nimport UserForm from \"./main/users/userForm\";\r\nimport { usersAdapter } from \"./redux/reducers/users\";\r\nimport { AppState } from \"./redux/store\";\r\nimport { Sidebar } from \"./sidebar/sidebar\";\r\nimport _ from \"lodash\";\r\nimport { createTheme, ThemeProvider } from \"@material-ui/core\";\r\nimport * as colors from \"./main/common/colors\"\r\n\r\nconst theme = createTheme({\r\n    palette: {\r\n        primary: {\r\n            main: colors.blue\r\n        }\r\n    }\r\n});\r\nconst Main = () => {\r\n\tconst user = useSelector<AppState>((state) => _.first(usersAdapter.getSelectors().selectAll(state.users))) as User;\r\n\treturn (\r\n\t\t<Router>\r\n\t\t\t<ThemeProvider theme={theme}>\r\n\t\t\t\t<div className=\"mainContainer\">\r\n\t\t\t\t\t<div className=\"sidebarContainer\">\r\n\t\t\t\t\t\t<Sidebar user={user} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"contentContainer\">\r\n\t\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt/users/:userId\" component={UserForm}></Route>\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath=\"/zsku-mgmt/transactions/:transactionId/:userId?\"\r\n\t\t\t\t\t\t\t\tcomponent={TransactionForm}\r\n\t\t\t\t\t\t\t></Route>\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt/ledgers\" component={Ledgers}></Route>\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt/settings\" component={Settings} />\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt/games/:gameId\" exact={true} component={ClosedGameForm} />\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt/games\" exact={true} component={Games} />\r\n\t\t\t\t\t\t\t<Route path=\"/zsku-mgmt\" strict={true}>\r\n\t\t\t\t\t\t\t\t<Landing user={user} />\r\n\t\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</ThemeProvider>\r\n\t\t</Router>\r\n\t);\r\n};\r\n\r\nfunction App() {\r\n\tconst loading = useSelector<AppState>((state) => state.loading) as boolean;\r\n\treturn <div className=\"App\">{loading ? <div></div> : <Main></Main>}</div>;\r\n}\r\n\r\nexport default connect()(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      process.env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./css/index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { Provider } from \"react-redux\";\r\nimport { store } from \"./redux/store\";\r\n\r\nReactDOM.render(\r\n\t<React.StrictMode>\r\n\t\t<Provider store={store}>\r\n\t\t\t<App />\r\n\t\t</Provider>\r\n\t</React.StrictMode>,\r\n\tdocument.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.register();\r\n"],"sourceRoot":""}